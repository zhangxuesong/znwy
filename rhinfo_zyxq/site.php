<?php
 goto QyX33; BRfDt: require_once IA_ROOT . '/addons/rhinfo_zyxq/model.php'; goto TS0QF; vVQmV: UkLlF: goto KP7NM; zKnyV: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/carapi.php'; goto jX84M; QyX33: if (defined('IN_IA')) { goto UkLlF; } goto lhLOK; AYwtC: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/thirdapi.php'; goto ejt0h; fKvuF: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/devapi.php'; goto AYwtC; lhLOK: exit('Access Denied'); goto vVQmV; TS0QF: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/rhinfo.php'; goto HvTtL; KP7NM: require_once IA_ROOT . '/addons/rhinfo_zyxq/define.php'; goto BRfDt; ejt0h: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/function.php'; goto ptxqi; HvTtL: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/model.php'; goto Ad3cG; Ad3cG: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/payapi.php'; goto zKnyV; jX84M: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/rhinfo/doorapi.php'; goto fKvuF; ptxqi: class Rhinfo_zyxqModuleSite extends WeModuleSite { public $syscfg = array(); public $syspub = array(); public $mywe = array(); public $rhinfo_wap = false; public $rhinfo_isweixin = true; public $rhinfo_isalipay = false; public $calmethod = array(array("id" => 1, "title" => "按建筑面积"), array("id" => 2, "title" => "按使用面积"), array("id" => 3, "title" => "按附加面积"), array("id" => 4, "title" => "按住户"), array("id" => 5, "title" => "按车位"), array("id" => 6, "title" => "按使用数量"), array("id" => 7, "title" => "按承租人"), array("id" => 8, "title" => "按承租面积")); public $paytype = array("9" => "现金", "8" => "冲预收", "7" => "其他", "1" => "微信支付", "2" => "支付宝", "3" => "银联刷卡", "4" => "生活缴费", "5" => "银行托收", "6" => "减免"); public function __construct() { } public function my_check_web() { goto pKkuN; CQVmf: if (!empty($mywe['uid'])) { goto REO2_; } goto oHF_l; Z2WqQ: xFDNQ: goto IhiRR; XRtYu: if (in_array($_GPC['do'], array("property", "check_login", "auth"))) { goto wxIuf; } goto LA9UF; qOX10: z0L02: goto YXOLo; MDX5z: header('Location:' . mywurl('property/login', array("direct" => 1), 1)); goto eaYQW; ixp6w: $this->syspub = pdo_fetch($sql); goto UX8cM; eaYQW: vedIt: goto QU60n; VrE3X: $this->syscfg['workermanurlpost'] = base64_decode('aHR0cDovL3dlLnp5MTc4LmNu'); goto g0p1N; hKTXk: $this->syscfg['workermanurlpost'] = str_replace('https', 'http', $this->syscfg['workermanurl']); goto SvDks; YXOLo: wxIuf: goto JOpWj; aq4S7: $sql = 'select * from ' . tablename('rhinfo_zyxq_syspub'); goto ixp6w; JOpWj: $this->syscfg['siteurl'] = empty($this->syscfg['siteurl']) ? $_W['siteroot'] : $this->syscfg['siteurl']; goto xdJRS; m0oDa: $_W['uniacid'] = empty($_W['uniacid']) ? $mywe['weid'] : $_W['uniacid']; goto JS03M; iNH1S: if (empty($this->syscfg['workermanurl'])) { goto xFDNQ; } goto hKTXk; MGIXo: mU3ID: goto CQVmf; iyCXo: if (!empty($mywe['uid'])) { goto hKcT8; } goto JeeA7; JS03M: $session_key = '__property_' . $_W['uniacid'] . '_session'; goto ScejV; rTSf6: $this->mywe = $mywe; goto m0oDa; LA9UF: if ($_W['isajax']) { goto mU3ID; } goto iyCXo; dn_jt: hKcT8: goto RXVAS; aTKOz: xLqiT: goto MDX5z; gkV6K: header('Location:' . mywurl('auth/login', array("direct" => 1), 1)); goto SaVqY; F0zG7: $_W['ishaina'] = !empty($_W['ishaina']) ? $_W['ishaina'] : $cookie['__property_haina']; goto XRtYu; xdJRS: $sql = 'SELECT * FROM ' . tablename('modules') . ' WHERE `name`=:name'; goto scbd6; pKkuN: global $_W, $_GPC; goto aq4S7; JeeA7: if ($this->syscfg['isproperty'] == 1) { goto xLqiT; } goto gkV6K; ScejV: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto F0zG7; Xpg19: REO2_: goto qOX10; SaVqY: goto vedIt; goto aTKOz; UX8cM: $mywe = $this->getmywe(); goto rTSf6; oHF_l: exit('Access Denied'); goto Xpg19; scbd6: $module = pdo_fetch($sql, array(":name" => "rhinfo_zyxq")); goto P2XVp; QU60n: exit; goto dn_jt; g0p1N: CHky0: goto VOQML; RXVAS: goto z0L02; goto MGIXo; IhiRR: $this->syscfg['workermanurl'] = base64_decode('aHR0cHM6Ly93ZS56eTE3OC5jbg=='); goto VrE3X; P2XVp: $this->syscfg['version'] = $module['version']; goto iNH1S; SvDks: goto CHky0; goto Z2WqQ; VOQML: } public function my_check_mobile() { goto pv2zQ; yXhoG: $current_url = base64_encode($this->syscfg['siteurl'] . $request_uri); goto Tq5v7; s8a4q: if (strpos($_SERVER['HTTP_USER_AGENT'], 'AlipayClient') !== false) { goto fFng8; } goto kuEMT; pgs0m: uQKF5: goto C41tc; XKlHW: if ($_GPC['rr'] == '*') { goto S4VI3; } goto yMbNe; cKs4b: $_W['uniacid'] = !empty($_W['uniacid']) ? $_W['uniacid'] : $_GPC['__uniacid']; goto rNCtT; E2SSG: $this->syscfg['wxtitle'] = empty($this->syscfg['wxtitle']) ? $this->syspub['wxtitle'] : $this->syscfg['wxtitle']; goto EQdeF; pHRMh: $this->syspub = pdo_fetch($sql); goto dSXSR; yvSWx: Ue2ZL: goto MVpzV; xRWQa: $this->rhinfo_wap = false; goto yGykW; BJyDc: $_W['minirid'] = 0; goto qQmX5; yMbNe: $_W['minirid'] = $_GPC['rr']; goto DAMt7; kNhDa: GZRiP: goto AtZm3; T_UHC: $this->syscfg['statistics'] = empty($this->syscfg['statistics']) ? $this->syspub['statistics'] : $this->syscfg['statistics']; goto ZiUoi; hLhoT: WsrX3: goto eN9Pv; PMU3i: $_W['openid_alipay'] = $cookie['__rhinfo_alipay_openid']; goto sIlnR; Rr2E5: oCE31: goto YvTRI; e9LAc: $session_key = '__rhinfo_' . $_W['uniacid'] . '_session'; goto hR3cs; bwBL7: $_W['minirid'] = $_GPC['__regionid']; goto C02lm; cg86b: RAs7k: goto CwxRM; WxNwK: $this->rhinfo_wap = true; goto R0RcO; lPn_c: jCZbS: goto gJ1C1; Qx6IX: $this->syscfg['siteurl'] .= '/'; goto MTkMw; pv2zQ: global $_W, $_GPC; goto cKs4b; PdaxR: $this->syscfg = pdo_fetch($sql, array(":weid" => $_W['uniacid'])); goto ynbMG; vCnWy: zE_oA: goto XKD7C; AtZm3: $this->syscfg['siteurl'] = empty($this->syscfg['siteurl']) ? $_W['siteroot'] : $this->syscfg['siteurl']; goto KYf2_; MofKh: if (empty($this->syscfg['workermanurl'])) { goto ExphO; } goto Ixqsx; BzRlp: if (!empty($_W['openid'])) { goto Ue2ZL; } goto e9LAc; kuEMT: $this->rhinfo_isalipay = false; goto qLxtL; dSXSR: if (!($this->syspub['isclose'] == 1)) { goto YdPVu; } goto ppddi; sIlnR: $_W['openid_aliapp'] = $cookie['__rhinfo_aliapp_openid']; goto zKJB9; NCcds: if (!$_GPC['__regionid']) { goto kfLe4; } goto bwBL7; NO5c8: $auth_url = 'https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=' . $this->syscfg['alipay_life_appid'] . '&scope=auth_base&redirect_uri=' . $redirect_uri; goto RxWqG; CwxRM: $this->rhinfo_wap = true; goto xj3kg; z2HPU: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto lPO3X; R0RcO: UzL8W: goto SqPyW; Z3FBx: _my_login($uid); goto gaiPT; UH1z0: if (!(!empty($_GPC['regionid']) && $_GPC['regionid'] != '*')) { goto aOWha; } goto AdR9S; ZHPzW: $uid = my_uid2openid($_W['openid_alipay']); goto Z3FBx; W2YdY: if (!empty($_W['openid_alipay'])) { goto uQKF5; } goto Os1Dv; SmRhy: $_W['openid'] = $cookie['__rhinfo_haina_openid']; goto r9Eh5; MTkMw: xPZ_8: goto YWATf; yCG6k: goto u5_GI; goto giKdk; nAXqh: YdPVu: goto BEC2H; uIvKm: $this->syscfg['wxminiappid'] = $region['wxminiappid']; goto KPo4S; YWATf: $sql = 'SELECT `key`,`secret` FROM ' . tablename('account_wechats') . ' WHERE `acid`=:acid'; goto TFOo8; DAMt7: isetcookie('__regionid', $_GPC['rr'], 0, true); goto yCG6k; EQdeF: $this->syscfg['wxcopyright'] = empty($this->syscfg['wxcopyright']) ? $this->syspub['wxcopyright'] : $this->syscfg['wxcopyright']; goto T_UHC; r_uHQ: if (strpos($_SERVER['HTTP_USER_AGENT'], 'MicroMessenger') !== false) { goto oCE31; } goto iGSVq; qE8Os: if ($this->syscfg['iswap'] == '1') { goto RAs7k; } goto xRWQa; a1YJK: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $_GPC['regionid'])); goto adDeC; BEC2H: $sql = 'select * from ' . tablename('rhinfo_zyxq_sysset') . ' where weid = :weid'; goto PdaxR; Tq5v7: $redirect_uri = $this->my_mobileurl(mymurl('aliauth/openid', array("curr_url" => $current_url))); goto NO5c8; OSM0l: $this->syscfg['secret'] = $row['secret']; goto qE8Os; adDeC: if (empty($region)) { goto jCZbS; } goto uIvKm; NMMPz: goto zE_oA; goto KIpyh; czaiA: j78RI: goto BzRlp; gK48p: G4JC6: goto g04pd; Gg2Ia: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto PMU3i; Os1Dv: $session_key = '__rhinfo_' . $_W['uniacid'] . '_session'; goto Gg2Ia; MVpzV: if (!empty($_W['openid_wxapp'])) { goto amzJp; } goto Ef5Fh; s7peq: LlLAl: goto gK48p; R0NYr: myload()->model('member'); goto ZHPzW; gaiPT: goto G4JC6; goto hLhoT; KYf2_: if (!(substr($this->syscfg['siteurl'], -1) != '/')) { goto xPZ_8; } goto Qx6IX; lPO3X: $_W['openid_wxapp'] = $cookie['__rhinfo_wxapp_openid']; goto b34A5; yGykW: goto exJ5w; goto cg86b; uF_bC: $this->syscfg['appid'] = $row['key']; goto OSM0l; rNCtT: $_W['uniacid'] = !empty($_GPC['i']) ? $_GPC['i'] : $_W['uniacid']; goto OuzPr; F5wMT: fFng8: goto Cm7PF; eN9Pv: if (!($_GPC['appfrom'] != 'aliapp')) { goto LlLAl; } goto Z2VsZ; gJ1C1: aOWha: goto rJC4W; AdR9S: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and id=:rid'; goto a1YJK; RxWqG: header('location: ' . $auth_url); goto Crfkm; epIyf: goto j78RI; goto mjJR8; giKdk: S4VI3: goto A6MWi; skumW: lDmtG: goto s8a4q; qQmX5: u5_GI: goto czaiA; OuzPr: $sql = 'select * from ' . tablename('rhinfo_zyxq_syspub'); goto pHRMh; b34A5: amzJp: goto E2SSG; Ef5Fh: $session_key = '__rhinfo_' . $_W['uniacid'] . '_session'; goto z2HPU; KPo4S: $this->syscfg['wxminiappsecret'] = $region['wxminiappsecret']; goto lPn_c; zKJB9: $_W['openid_alipay'] = empty($_W['openid_alipay']) ? $_W['openid_aliapp'] : $_W['openid_alipay']; goto pgs0m; S6CGr: goto lDmtG; goto Rr2E5; XKD7C: $_W['minirid'] = 0; goto czRXQ; iGSVq: $this->rhinfo_isweixin = false; goto S6CGr; C02lm: kfLe4: goto epIyf; TFOo8: $row = pdo_fetch($sql, array(":acid" => $_W['uniacid'])); goto uF_bC; czRXQ: if (!empty($_GPC['rr'])) { goto RN46C; } goto NCcds; UTqYm: $this->syscfg['workermanurlpost'] = base64_decode('aHR0cDovL3dlLnp5MTc4LmNu'); goto vCnWy; qLxtL: goto UzL8W; goto F5wMT; A6MWi: isetcookie('__regionid', '', -10000); goto BJyDc; xj3kg: exJ5w: goto r_uHQ; hR3cs: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto SmRhy; ynbMG: if (!($this->syscfg['isclose'] == 1)) { goto GZRiP; } goto z5xev; g04pd: AaMP8: goto MofKh; Z2VsZ: $request_uri = ltrim($_SERVER['REQUEST_URI'], '/'); goto yXhoG; SqPyW: if (!$this->rhinfo_isalipay) { goto AaMP8; } goto W2YdY; C41tc: if (empty($_W['openid_alipay'])) { goto WsrX3; } goto R0NYr; ZYRDc: $this->syscfg['workermanurl'] = base64_decode('aHR0cHM6Ly93ZS56eTE3OC5jbg=='); goto UTqYm; Ixqsx: $this->syscfg['workermanurlpost'] = str_replace('https', 'http', $this->syscfg['workermanurl']); goto NMMPz; Crfkm: exit; goto s7peq; r9Eh5: $_W['openid_haina'] = $_W['openid']; goto yvSWx; ZiUoi: $this->syscfg['wxminibgimage'] = !empty($this->syscfg['wxminibgimage']) ? tomedia($this->syscfg['wxminibgimage']) : RHINFO_ZYXQ_URL . 'static/mobile/images/wxminibgimage.jpg'; goto UH1z0; KIpyh: ExphO: goto ZYRDc; z5xev: message($this->syscfg['closereason'] ? $this->syscfg['closereason'] : '抱歉，平台暂时关闭.', $this->syscfg['closeurl'] ? $this->syscfg['closeurl'] : '', 'error'); goto kNhDa; Cm7PF: $this->rhinfo_isalipay = true; goto WxNwK; ppddi: message($this->syspub['closereason'] ? $this->syspub['closereason'] : '抱歉，平台暂时关闭.', $this->syspub['closeurl'] ? $this->syspub['closeurl'] : '', 'error'); goto nAXqh; YvTRI: $this->rhinfo_wap = false; goto skumW; mjJR8: RN46C: goto XKlHW; rJC4W: } public function my_checkauth() { goto bK8x6; Comh8: f8S2Z: goto Bfq0K; Napfh: OWNEU: goto RGLEC; uMt3W: Qle6x: goto gdx9r; nW9lA: goto vNi1W; goto YiFI1; gIU90: sRGjW: goto n7TIm; ZdakZ: $result['url'] = $this->my_mobileurl($url); goto HvVME; YJrZe: myload()->model('member'); goto j6QxX; D5DIM: return true; goto VoL4b; vJD7R: $url = $this->createMobileUrl('myauth'); goto gw1ja; TPluM: $fan = mc_fansinfo($fan['openid']); goto uMt3W; zg0XY: $uid = mc_openid2uid($_W['openid']); goto PCxHn; KFw7D: fHtEW: goto Khczm; bK8x6: global $_W, $_GPC, $engine; goto CsUat; UZFcn: $url = $this->createMobileUrl('myauth', array("forward" => $forward)); goto q1JjI; Bfq0K: header('location: ' . $this->my_mobileurl($url)); goto WTy88; M2u83: return true; goto Kg58E; UUGwy: load()->model('mc'); goto YJrZe; NnwnV: if (empty($fan['openid'])) { goto Qle6x; } goto TPluM; RGLEC: dFBbW: goto nW9lA; gdx9r: EnXuV: goto ILdX4; rmBUf: if (!_my_login($uid)) { goto OWNEU; } goto KmEIV; CsUat: if (!defined('IN_API')) { goto lWLBv; } goto vJD7R; j6QxX: if (empty($_W['member'])) { goto Dmu6_; } goto abRLR; jW23L: H0M3B: goto DOuxH; YiFI1: PRyhd: goto zg0XY; aGVFy: $uid = intval($cookie['__rhinfo_uid']); goto KFw7D; leqT1: vNi1W: goto fRU2A; KmEIV: $_W['openid'] = mc_uid2openid($uid); goto KPGcl; DOuxH: if (!$_W['isajax']) { goto f8S2Z; } goto jTjLX; B7nlf: $result = array(); goto ZdakZ; JDn87: $url = $this->createMobileurl('myauth', array("op" => "home")); goto sGvsG; WTy88: exit; goto o2CCX; KPGcl: $fields = array("openid" => $_W['openid'], "openid_wxapp" => $_W['openid_wxapp'], "openid_alipay" => $_W['openid_alipay'], "openid_aliapp" => $_W['openid_aliapp'], "openid_haina" => $_W['openid_haina']); goto pRg6s; S_vwP: $session_key = '__rhinfo_' . $_W['uniacid'] . '_session'; goto TYf4a; QpmQ9: if (!(empty($fan) && $_W['account']['level'] == ACCOUNT_SERVICE_VERIFY)) { goto EnXuV; } goto lkNPs; u2m08: return true; goto YGuHT; jeS8L: q9YxR: goto JDn87; HvVME: $result['act'] = 'redirect'; goto HFQzX; jTjLX: return false; goto B7nlf; Kg58E: goto fvo1h; goto jeS8L; TYf4a: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto PbN9t; lzBoN: goto fvo1h; goto WcNGK; ej4rd: if (!empty($_W['openid'])) { goto PRyhd; } goto sUxwH; n7TIm: if (!empty($uid)) { goto fHtEW; } goto xXb4p; q1JjI: if (!($this->syscfg['isvisitor'] == 1)) { goto H0M3B; } goto QrDAW; WcNGK: PftCf: goto M2u83; E1tX2: $fields = array("openid" => $_W['openid'], "openid_wxapp" => $_W['openid_wxapp'], "openid_alipay" => $_W['openid_alipay'], "openid_aliapp" => $_W['openid_aliapp'], "openid_haina" => $_W['openid_haina']); goto uyl8A; Khczm: if (!_my_login($uid)) { goto YTMvi; } goto E1tX2; VoL4b: YTMvi: goto leqT1; AUuXT: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto aGVFy; BfUvD: lWLBv: goto UUGwy; Eptu8: if (in_array($_GPC['do'], $dos)) { goto PftCf; } goto hHVPB; sUxwH: if (empty($_W['uniacid'])) { goto dFBbW; } goto S_vwP; abRLR: $_W['openid'] = !empty($_W['openid']) ? $_W['openid'] : mc_uid2openid($_W['member']['uid']); goto u2m08; ILdX4: $uid = intval($fan['uid']); goto gIU90; hHVPB: if ($_GPC['do'] == 'home') { goto q9YxR; } goto lzBoN; fRU2A: $forward = base64_encode($_SERVER['QUERY_STRING']); goto UZFcn; xXb4p: $session_key = '__rhinfo_' . $_W['uniacid'] . '_session'; goto AUuXT; lkNPs: $fan = mc_oauth_userinfo(); goto NnwnV; TCOdt: return true; goto Napfh; sGvsG: fvo1h: goto jW23L; uyl8A: my_member_update($uid, $fields); goto D5DIM; r7TLU: $fan = mc_fansinfo($_W['openid'], $_W['acid'], $_W['uniacid']); goto QpmQ9; YGuHT: Dmu6_: goto ej4rd; PCxHn: if (!empty($uid)) { goto sRGjW; } goto r7TLU; pRg6s: my_member_update($uid, $fields); goto TCOdt; HFQzX: exit(json_encode($result)); goto Comh8; gw1ja: $GLOBALS['engine']->died('抱歉，您需要先登录才能使用此功能，点击此处 <a href=\'' . $this->my_mobileurl($url) . '\'>【登录】</a>'); goto BfUvD; QrDAW: $dos = array("charging", "business", "selfdevice", "service"); goto Eptu8; PbN9t: $uid = intval($cookie['__rhinfo_uid']); goto rmBUf; o2CCX: } public function checkmember() { goto SxmIw; id61e: goto d1nTJ; goto SNVuA; G6W0y: Jf005: goto oRnON; O_EfK: if (RHINFO_ZYXQ_DEBUG || $this->rhinfo_wap) { goto jpmlP; } goto cuDx2; Wf8NQ: $this->my_checkauth(); goto C9jny; yakJo: exit('<!DOCTYPE html>' . '
' . '                <html>' . '
' . '                    <head>' . '
' . '                        <meta name=\'viewport\' content=\'width=device-width, initial-scale=1, user-scalable=0\'>' . '
' . '                        <title>抱歉，出错了</title><meta charset=\'utf-8\'><meta name=\'viewport\' content=\'width=device-width, initial-scale=1, user-scalable=0\'><link rel=\'stylesheet\' type=\'text/css\' href=\'https://res.wx.qq.com/connect/zh_CN/htmledition/style/wap_err1a9853.css\'>' . '
' . '                    </head>' . '
' . '                    <body>' . '
' . '                    <div class=\'page_msg\'><div class=\'inner\'><span class=\'msg_icon_wrp\'><i class=\'icon80_smile\'></i></span><div class=\'msg_content\'><h4>' . $diemsg . '</h4></div></div></div>' . '
' . '                    </body>' . '
' . '                </html>'); goto id61e; dCvIA: nDb98: goto izS2C; KC_nJ: $openid = $_W['fans']['from_user']; goto I8uQZ; F4U_T: return true; goto PjGGv; J8R1H: if (empty($openid)) { goto XFX7S; } goto QwOrv; nmBfp: if ($uid > 0) { goto Jf005; } goto cTWU4; ke_WH: if (RHINFO_ZYXQ_DEBUG || $this->rhinfo_wap) { goto Kpa7E; } goto Lz885; DqqrK: $this->my_checkauth(); goto CAiex; C9jny: d1nTJ: goto XrrWp; GPOe2: $default_groupid = pdo_fetchcolumn('SELECT groupid FROM ' . tablename('mc_groups') . ' WHERE uniacid = :uniacid AND isdefault = 1', array(":uniacid" => $_W['uniacid'])); goto JdBSb; dooYq: $mc['nationality'] = $userinfo['country']; goto TvStM; HbITf: mc_update($uid, $mc); goto AZuh7; QwOrv: $uid = mc_openid2uid($openid); goto nmBfp; K0z1_: XzcJx: goto JVznH; aSZ7D: if (!_my_login($uid)) { goto nDb98; } goto GmTh4; EWL3Q: goto xURv0; goto Qi93D; Lz885: $diemsg = '请在微信客户端打开链接'; goto oAaVs; bKRFj: $mc = array(); goto GPOe2; Xlsyh: $mc['nickname'] = $userinfo['nickname']; goto zgre8; B4OMb: $uid = mc_openid2uid($openid); goto oK23L; AZuh7: $uid = mc_openid2uid($openid); goto n5Xdj; nY6b1: if (!_my_login($uid)) { goto Z4s0g; } goto QQNyT; TeUSF: SncJn: goto K0z1_; dTyp9: $mc['uniacid'] = $_W['uniacid']; goto GcA41; F9FF8: Z4s0g: goto VtFxx; JdBSb: $mc['uniacid'] = $_W['uniacid']; goto Xlsyh; aNS_t: $mc['groupid'] = $default_groupid; goto HbITf; X5GZv: if ($this->rhinfo_isweixin) { goto rXu9n; } goto ke_WH; jW2mv: return true; goto Ah024; cuDx2: $diemsg = '请确认公众号为认证服务号'; goto yakJo; U_Omr: $openid = $_W['openid']; goto X5GZv; hu4i7: UvXNt: goto YHNjB; QQNyT: return true; goto F9FF8; DYBek: goto AIt_6; goto hHT5b; izS2C: goto XzcJx; goto baj7U; LOBPB: $mc['residecity'] = $userinfo['city']; goto aNS_t; rATaU: $default_groupid = pdo_fetchcolumn('SELECT groupid FROM ' . tablename('mc_groups') . ' WHERE uniacid = :uniacid AND isdefault = 1', array(":uniacid" => $_W['uniacid'])); goto dTyp9; RnBO_: return true; goto TeUSF; GcA41: $mc['nickname'] = $userinfo['nickname']; goto SzDKt; oRnON: my_member_update($uid, array("openid" => $openid)); goto Ijzq0; fsjHs: AZKEX: goto O_EfK; I8uQZ: $userinfo = mc_oauth_userinfo(); goto bKRFj; TvStM: $mc['resideprovince'] = $userinfo['province']; goto LOBPB; zgSXp: $mc['nationality'] = $userinfo['country']; goto Q2Z6Q; n5Xdj: my_member_update($uid, array("openid" => $openid)); goto nY6b1; CAiex: AIt_6: goto EWL3Q; xEjYQ: if (!_my_login($uid)) { goto SncJn; } goto RnBO_; vSDlW: $mc['residecity'] = $userinfo['city']; goto HD_Wm; cTWU4: if (!($_W['account']['level'] == ACCOUNT_SERVICE_VERIFY)) { goto CtuG2; } goto T7Ewx; JVznH: h36ad: goto ZM8vg; hHT5b: Kpa7E: goto DqqrK; S5JH3: $mc = array(); goto rATaU; ska6O: myload()->model('member'); goto U_Omr; Ckk28: XFX7S: goto isFXx; isFXx: if (!($_W['account']['level'] == ACCOUNT_SERVICE_VERIFY)) { goto oLVV0; } goto KC_nJ; SxmIw: global $_W, $_GPC; goto jw6mI; GmTh4: return true; goto dCvIA; Hsuly: $mc['gender'] = $userinfo['sex']; goto dooYq; xIX2Q: goto UvXNt; goto G6W0y; baj7U: xDLFT: goto ZKh32; jw6mI: load()->model('mc'); goto ska6O; Ijzq0: if (!_my_login($uid)) { goto AsHcI; } goto F4U_T; SNVuA: jpmlP: goto Wf8NQ; NXijA: if ($uid > 0) { goto xDLFT; } goto LfjhL; Q2Z6Q: $mc['resideprovince'] = $userinfo['province']; goto vSDlW; aVaGq: my_member_update($uid, array("openid" => $openid)); goto xEjYQ; SVmbG: $uid = mc_openid2uid($openid); goto NXijA; hJj5j: if (empty($openid)) { goto h36ad; } goto SVmbG; ZM8vg: oLVV0: goto fsjHs; VtFxx: CtuG2: goto xIX2Q; oAaVs: exit('<!DOCTYPE html>' . '
' . '                <html>' . '
' . '                    <head>' . '
' . '                        <meta name=\'viewport\' content=\'width=device-width, initial-scale=1, user-scalable=0\'>' . '
' . '                        <title>抱歉，出错了</title><meta charset=\'utf-8\'><meta name=\'viewport\' content=\'width=device-width, initial-scale=1, user-scalable=0\'><link rel=\'stylesheet\' type=\'text/css\' href=\'https://res.wx.qq.com/connect/zh_CN/htmledition/style/wap_err1a9853.css\'>' . '
' . '                    </head>' . '
' . '                    <body>' . '
' . '                    <div class=\'page_msg\'><div class=\'inner\'><span class=\'msg_icon_wrp\'><i class=\'icon80_smile\'></i></span><div class=\'msg_content\'><h4>' . $diemsg . '</h4></div></div></div>' . '
' . '                    </body>' . '
' . '                </html>'); goto DYBek; oK23L: my_member_update($uid, array("openid" => $openid)); goto aSZ7D; LfjhL: mc_update($uid, $mc); goto B4OMb; zgre8: $mc['avatar'] = $userinfo['avatar']; goto REly4; XrrWp: xURv0: goto jW2mv; Qi93D: rXu9n: goto J8R1H; HD_Wm: $mc['groupid'] = $default_groupid; goto hJj5j; REly4: $mc['gender'] = $userinfo['sex']; goto zgSXp; YHNjB: goto AZKEX; goto Ckk28; PjGGv: AsHcI: goto hu4i7; T7Ewx: $userinfo = mc_oauth_userinfo(); goto S5JH3; SzDKt: $mc['avatar'] = $userinfo['avatar']; goto Hsuly; ZKh32: mc_update($uid, $mc); goto aVaGq; Ah024: } public function getmywe() { goto M8vH9; TSze8: $this->syscfg = pdo_fetch($sql, array(":weid" => $mywe['weid'])); goto KFEU2; P7bdC: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto ppDMx; YHC2X: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto Cm77l; G9JKs: $mywe['direct'] = '&direct=1'; goto QojsQ; AO6CY: $cookie_weid = $_GPC['__uniacid']; goto VU66L; tvnro: if ($now - $cookie['__property_time'] > $timeout) { goto yiBmD; } goto EnxzA; Qgcbv: G6yDl: goto yibEn; VU66L: if (!(empty($uniacid) && empty($cookie_weid))) { goto vmWgh; } goto Vq_U2; UrR5v: vmWgh: goto NVRMs; Vq_U2: $mywe['weid'] = 1; goto e5Yto; U2vIO: goto Hp2ti; goto cJosn; YZICy: $session_key = '__property_' . $cookie['__property_uniacid'] . '_session'; goto dCOQG; qRjRG: $mywe['weid'] = $cookie_weid; goto BCKiO; ugInu: $timeout = $this->syscfg['outtime'] ? $this->syscfg['outtime'] * 60 : 300; goto XsXLC; HKeMi: XZKWV: goto qtOGU; a3GOH: $mywe['pid'] = $user['pid']; goto xlkMX; I7zPU: $mywe['pid'] = 0; goto YsQSe; wDrj8: $mywe['userno'] = $user['userno']; goto G9JKs; S2y4F: $cookie['__property_uid'] = 0; goto FeHc8; NVRMs: if (!empty($uniacid)) { goto ZqDiD; } goto qRjRG; dAbPh: goto Rdb3P; goto Vs9Jg; IgF_t: LtAMC: goto a3GOH; zag3E: $mywe['name'] = empty($user['name']) ? $user['username'] : $user['name']; goto EZsXh; ApZNA: if (!empty($_W['uniacid'])) { goto RvwF5; } goto Pnf0x; e5Yto: return $mywe; goto UrR5v; Tf6Fn: $session_key = '__property_' . $mywe['weid'] . '_session'; goto YZja9; Lm6wZ: goto G6yDl; goto XLo2g; EZsXh: $mywe['pid'] = $user['pid']; goto BEngF; R4jNV: $session_key = '__property_' . $cookie['__property_uniacid'] . '_session'; goto N7WXB; xcH_0: ZqDiD: goto xTlT2; dCOQG: isetcookie($session_key, $session, 0, true); goto y2ANp; BCKiO: goto dIoWq; goto xcH_0; cJosn: RvwF5: goto ekdIa; ekdIa: $mywe['weid'] = $_W['uniacid']; goto Zy_EX; XsXLC: $now = time(); goto tvnro; TVmS4: if (!(!rhinfo_check() && $_SERVER['HTTP_HOST'] !== '127.0.0.1')) { goto XZKWV; } goto ur5QY; ArjRG: if (!empty($cookie['__property_uid'])) { goto WEWkQ; } goto cQRU2; YsQSe: $mywe['rid'] = 0; goto uT8P2; Pnf0x: $uniacid = intval($_GPC['i']); goto AO6CY; Vs9Jg: yiBmD: goto aK2Qo; ca6bV: $mywe['userno'] = $user['userno']; goto BEFoV; EnxzA: $cookie['__property_time'] = time(); goto HExec; KFEU2: if (!empty($_W['uid'])) { goto QUaO6; } goto Tf6Fn; sjeCH: GZ0YR: goto Lm6wZ; tIQhk: $mywe['uid'] = $_W['uid']; goto dgGUG; BLB3b: return $mywe; goto kUMVv; aK2Qo: $cookie['__property_time'] = time(); goto S2y4F; y_LBC: goto GZ0YR; goto wZmme; y2ANp: $mywe['uid'] = $cookie['__property_uid']; goto YkoIk; BEFoV: TJ97x: goto dWLug; M8vH9: global $_W, $_GPC; goto xym9W; xlkMX: $mywe['rid'] = $user['rid']; goto wDrj8; xym9W: $mywe = array(); goto TVmS4; l4C0O: $mywe['direct'] = ''; goto Fsqqm; N7WXB: isetcookie($session_key, $session, 0, true); goto BLB3b; YZja9: $cookie = json_decode(base64_decode($_GPC[$session_key]), true); goto ArjRG; dgGUG: $mywe['name'] = $_W['username']; goto P7bdC; aIMaK: if (empty($property)) { goto LtAMC; } goto E7kNH; ur5QY: exit; goto HKeMi; BEngF: $mywe['rid'] = $user['rid']; goto ca6bV; zZWTp: dIoWq: goto U2vIO; QojsQ: return $mywe; goto dAbPh; kUMVv: Rdb3P: goto sjeCH; uzsyz: $sql = 'select * from ' . tablename('rhinfo_zyxq_sysset') . ' where weid = :weid'; goto TSze8; FeHc8: $session = base64_encode(json_encode($cookie)); goto R4jNV; E7kNH: $mywe['ispmanager'] = 1; goto IgF_t; Fsqqm: $mywe['ispmanager'] = 0; goto ApZNA; qtOGU: $mywe['uid'] = 0; goto I7zPU; dWLug: return $mywe; goto Qgcbv; XLo2g: QUaO6: goto tIQhk; uT8P2: $mywe['userno'] = ''; goto l4C0O; ppDMx: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $_W['uid'])); goto zXpZe; cQRU2: return $mywe; goto y_LBC; YkoIk: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto YHC2X; Cm77l: $mywe['name'] = empty($user['name']) ? $user['username'] : $user['name']; goto phi2w; phi2w: $property = pdo_get('rhinfo_zyxq_property', array("weid" => $mywe['weid'], "id" => $user['pid'], "userno" => $user['userno']), array("userno")); goto aIMaK; Zy_EX: Hp2ti: goto uzsyz; xTlT2: isetcookie('__uniacid', $uniacid, 7 * 86400); goto zZWTp; HExec: $session = base64_encode(json_encode($cookie)); goto YZICy; wZmme: WEWkQ: goto ugInu; zXpZe: if (empty($user)) { goto TJ97x; } goto zag3E; yibEn: } public function getmyinfo($openid) { goto zecoE; Ci6qo: $info['telphone'] = $region['telphone']; goto KeTS0; Znaa8: $info['rid'] = $_W['minirid']; goto yGd0y; SzD5v: $info['hid'] = $member['hid']; goto TeicZ; U8qc9: $info['rid'] = $regionarr[0]; goto WUTio; vaCbd: $info['rights'] = $mutiteam; goto Ev6CZ; FWRs1: $info['ismanager'] = 1; goto xBUz8; Q7aOK: UvxsD: goto ZxlcS; JbA2D: if (!empty($regionarr)) { goto BTWjp; } goto jL463; ZJpdq: $info['status'] = 0; goto XbVzD; EXw1x: $info['doortime'] = 0; goto Kt62R; u66Ly: QbrOn: goto Zupkp; Efy4x: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid>0 order by isdefault desc'; goto mgcYH; zs0PX: $info['isbind'] = 1; goto FWRs1; uHt8r: $info['telphone'] = $region['telphone']; goto sFGWi; g099j: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $region_follow['rid'])); goto glNqC; IPwlz: yqd8g: goto C3rod; xoPmd: $info['ismanager'] = 1; goto MOW2O; FrzKZ: $info['rights'] = $team; goto IPwlz; QMyun: $info['tid'] = $member['tid']; goto SzD5v; pKKK6: $info['lifepay_token'] = $region['lifepay_token']; goto D5973; nc531: $info['feeshowtype'] = $region['feeshowtype']; goto HOGVE; FyYHp: $info['rights'] = array(); goto xdR20; fj7WT: $info['address'] = '物业服务人员'; goto x3JCh; OOSfs: $info['tid'] = 0; goto HX1mF; Kxmud: $info['rtitle'] = $region['title']; goto Rf8f9; Eggg7: goto yqd8g; goto cohWp; mMEaZ: $info['pid'] = $region['pid']; goto ZaWIH; I8UXF: CZ0V0: goto CT06E; Zupkp: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto zBtIo; NwJYV: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid=0'; goto bpHzk; xdR20: if (!empty($_W['minirid'])) { goto pdrc0; } goto ePTjf; eihZP: if (!empty($team)) { goto QxoGS; } goto NwJYV; j4Pa7: Gg49D: goto B0NJ_; xBUz8: $info['otype'] = 0; goto uMgM1; Gob2R: $info['isfollow'] = 1; goto QLbHW; xnBuP: $info['category'] = 0; goto Ci6qo; QLbHW: xhj52: goto q1xja; hyHjQ: if (!empty($mutiteam)) { goto zLCkg; } goto bKew6; wMoUT: $info['hid'] = 0; goto xnBuP; t8Whx: $info['isfollow'] = 0; goto FyYHp; Rf8f9: $info['pid'] = $region['pid']; goto uN494; cohWp: QxoGS: goto toUzZ; ZLj0n: $info['menu'] = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'])); goto OMOFc; CT06E: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto ukKZa; K4BkR: $info['rtitle'] = $region['title']; goto FihgG; edzpL: $info['birthday'] = $info['birthyear'] . '-' . (strlen($info['birthmonth']) <= 1 ? '0' . $info['birthmonth'] : $info['birthmonth']) . '-' . (strlen($info['birthday']) <= 1 ? '0' . $info['birthday'] : $info['birthday']); goto jjYYK; zQ7dz: $info['address'] = '物业服务人员'; goto bkLc9; O2cDy: $sql = 'select * from ' . tablename('rhinfo_zyxq_region_follow') . ' where weid=:weid and uid=:uid and deleted=0'; goto jP8GP; ZaWIH: $info['bid'] = 0; goto foVLY; bawbC: qrOjS: goto w505I; aQJqF: if (!empty($_W['minirid'])) { goto wfJPI; } goto Efy4x; eIOYX: if (!empty($region_follow)) { goto UvxsD; } goto f8Ezj; SxpEu: FnfTM: goto eihZP; Ke_yw: wfJPI: goto NNBRv; x4B2L: goto b03A7; goto u66Ly; WUTio: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto BMXfl; EA5YS: $sql = 'select * from ' . tablename('rhinfo_zyxq_member') . ' where weid=:weid and rid=:rid and (openid=:openid or uid=:uid) and deleted=0 and status=0 order by isdefault desc'; goto Q8DCU; xzp7G: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $_W['minirid'])); goto Znaa8; jL463: goto j4Vco; goto zQW9Q; kY6mt: if (!empty($_W['minirid'])) { goto QbrOn; } goto S0lju; TgAt7: $info['status'] = $member['status']; goto PCGih; vZgHw: $info['telphone'] = $region['telphone']; goto zs0PX; HX1mF: $info['hid'] = 0; goto pF4Yu; PPk4X: $region_follow = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $_W['minirid'], ":uid" => $uid)); goto VgGry; SefYu: yPsR2: goto QKqbh; sFGWi: if (!in_array($_W['minirid'], $regionarr)) { goto h0omx; } goto Cl1x0; TeicZ: $info['category'] = $member['category']; goto Vsgqz; zecoE: global $_W; goto Sai5J; H67PS: $info['otype'] = 0; goto D46n7; edq8Q: $info['doortime'] = 0; goto zQ7dz; bpHzk: $mutiteam = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $uid)); goto hyHjQ; fPIC_: goto FnfTM; goto Ke_yw; tpmVj: $info['bid'] = 0; goto rij_Z; jjYYK: zq46X: goto W4PCX; OMOFc: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_member') . ' where weid = :weid and (openid=:openid or uid=:uid) and category = :category and deleted=0 and status=0'; goto bGNWl; Kt62R: $info['address'] = '物业服务人员'; goto ZJpdq; MIAgM: $info['otype'] = $member['otype']; goto NwLP3; XL1Vn: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $team['rid'])); goto B_Oxn; bBF2O: $sql = 'select * from ' . tablename('rhinfo_zyxq_region_follow') . ' where weid=:weid and rid:=rid and uid=:uid and deleted=0'; goto PPk4X; gvl1H: $info = pdo_fetch('select * from ' . tablename('mc_members') . ' where uniacid=:uniacid and uid=:uid', array(":uniacid" => $_W['uniacid'], ":uid" => $uid)); goto YoBno; q96o3: b03A7: goto BsVi0; rij_Z: $info['tid'] = 0; goto wMoUT; KBY2s: $info['pid'] = $region['pid']; goto NmEER; mgcYH: $team = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $uid)); goto fPIC_; VBhUY: pdrc0: goto EA5YS; bGNWl: $info['houses'] = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $_W['member']['uid'], ":category" => 1)); goto jaEST; bkLc9: $info['status'] = 0; goto j5pK5; BMXfl: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'])); goto Kxmud; ImPZo: $info['ismanager'] = 1; goto H67PS; yGd0y: $info['rtitle'] = $region['title']; goto mMEaZ; ePTjf: $sql = 'select * from ' . tablename('rhinfo_zyxq_member') . ' where weid=:weid and (openid=:openid or uid=:uid) and deleted=0 and status=0 order by isdefault desc'; goto HVQE0; NtHbl: $info['rid'] = $member['rid']; goto m5k82; zhgvo: if (!($uid == 0)) { goto yPsR2; } goto jbo61; MOW2O: $info['otype'] = 0; goto KL7iQ; toUzZ: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto XL1Vn; D46n7: $info['ctime'] = 0; goto edq8Q; NNBRv: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and t.rid=:rid and c.type=4 and (t.openid = :openid or t.uid = :uid) order by isdefault desc'; goto oLRrd; glNqC: $info['rtitle'] = $region['title']; goto r4gdc; FihgG: $info['pid'] = $team['pid']; goto tpmVj; KW3ar: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto g099j; pOFjq: $sql = 'select * from ' . tablename('rhinfo_zyxq_regionmenu') . ' where weid=:weid and rid=:rid and enabled=1'; goto ZLj0n; XbVzD: $info['ownername'] = $mutiteam['realname']; goto xBkvm; P91MB: $info['address'] = $member['address']; goto TgAt7; r4gdc: $info['telphone'] = $region['telphone']; goto Gob2R; KL7iQ: $info['ctime'] = 0; goto II40h; jbo61: load()->model('mc'); goto IZM6K; W15Mm: $info['pid'] = $member['pid']; goto v9qCi; f8Ezj: if (empty($info['groupid'])) { goto q1PQ2; } goto kY6mt; uMgM1: $info['ctime'] = 0; goto EXw1x; QKqbh: $info = array(); goto gvl1H; i2G2l: WDxAz: goto Eggg7; ZxlcS: $info['pid'] = $region_follow['pid']; goto PYuwY; Fckax: m1ilG: goto bBF2O; Qtkul: $info['ismanager'] = 0; goto t8Whx; uN494: $info['bid'] = 0; goto OOSfs; v9qCi: $info['bid'] = $member['bid']; goto QMyun; VsGFA: $info['hid'] = 0; goto LhuKY; Vsgqz: $info['telphone'] = $region['telphone']; goto knMPE; O9O9n: BTWjp: goto U8qc9; gZDdz: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto xzp7G; q1xja: goto WDxAz; goto drjWr; IZM6K: $uid = mc_openid2uid($openid); goto SefYu; oLRrd: $team = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $_W['minirid'], ":openid" => $_W['openid'], ":uid" => $uid)); goto SxpEu; ukKZa: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $member['rid'])); goto NtHbl; Su73w: $info['telphone'] = $region['telphone']; goto KBY2s; II40h: $info['doortime'] = 0; goto fj7WT; jENR3: $regionarr = explode(',', $mutiteam['ridstr']); goto HzeMi; XChjC: $info['feecontrol'] = $region['feecontrol']; goto nc531; jaEST: return $info; goto GVOnM; jP8GP: $region_follow = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto ovLWz; PCGih: $info['ownername'] = $member['realname']; goto pKKK6; xBkvm: $info['rights'] = $mutiteam; goto fyt3q; ovLWz: goto DfHXC; goto Fckax; bKew6: if (!empty($_W['minirid'])) { goto m1ilG; } goto O2cDy; C3rod: goto Aw22z; goto I8UXF; KeTS0: $info['isbind'] = 1; goto xoPmd; rgn7u: $info['doortime'] = $member['doortime']; goto P91MB; xo_1G: goto Gg49D; goto VBhUY; NwLP3: $info['ctime'] = $member['ctime']; goto rgn7u; drjWr: zLCkg: goto jENR3; zQW9Q: MDYnE: goto gZDdz; zBtIo: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $_W['minirid'])); goto q96o3; W4PCX: if (!empty($info['birthday'])) { goto qrOjS; } goto jNxFg; jNxFg: $info['birthday'] = ''; goto bawbC; B_Oxn: $info['rid'] = $team['rid']; goto K4BkR; fyt3q: j4Vco: goto i2G2l; foVLY: $info['tid'] = 0; goto VsGFA; Q_puE: q1PQ2: goto id6T5; HzeMi: if (!empty($_W['minirid'])) { goto MDYnE; } goto JbA2D; tnLw4: $info['ownername'] = $team['realname']; goto FrzKZ; Q8DCU: $member = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":rid" => $_W['minirid'], ":uid" => $uid)); goto j4Pa7; Mum2j: goto j4Vco; goto O9O9n; w505I: $info['isbind'] = 0; goto Qtkul; pF4Yu: $info['category'] = 0; goto vZgHw; B0NJ_: if (!empty($member)) { goto CZ0V0; } goto aQJqF; VgGry: DfHXC: goto eIOYX; BsVi0: $info['rtitle'] = $region['title']; goto Su73w; id6T5: goto xhj52; goto Q7aOK; knMPE: $info['isbind'] = 1; goto MIAgM; HVQE0: $member = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $uid)); goto xo_1G; Timsg: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":groupid" => $info['groupid'])); goto x4B2L; m5k82: $info['rtitle'] = $region['title']; goto W15Mm; D5973: $info['lifepay_rid'] = $region['lifepay_rid']; goto XChjC; PYuwY: $info['rid'] = $region_follow['rid']; goto KW3ar; Cl1x0: $info['isbind'] = 1; goto ImPZo; LhuKY: $info['category'] = 0; goto uHt8r; Ev6CZ: h0omx: goto Mum2j; HOGVE: Aw22z: goto pOFjq; NmEER: $info['rid'] = $region['id']; goto CjRy1; x3JCh: $info['status'] = 0; goto tnLw4; CjRy1: $info['isfollow'] = $region['nobindlimit']; goto Q_puE; S0lju: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and groupid=:groupid'; goto Timsg; j5pK5: $info['ownername'] = $mutiteam['realname']; goto vaCbd; YoBno: if (!(!empty($info['birthyear']) && !empty($info['birthmonth']) && !empty($info['birthday']))) { goto zq46X; } goto edzpL; Sai5J: $uid = intval($openid); goto zhgvo; GVOnM: } public function getmanager($openid, $rid = 0) { goto ZR0BI; oxJ83: $info['rights'] = $team; goto IE1TB; llm6R: $info['rid'] = $_W['minirid']; goto rPmhf; kp6nH: goto ZRLRA; goto L9n12; z8IhV: $uid = intval($openid); goto Gfgh0; utXiO: $team = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto oLTKr; zk8fi: xR5Mf: goto npV86; OVpCq: $info['rights'] = $team; goto YxJU3; tSyzN: return $info; goto wVnc_; vwkoD: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid>0'; goto Vjx3T; uwwub: if (!empty($team)) { goto xR5Mf; } goto IAmsv; OifTe: JRggK: goto WJ8DU; YxJU3: wknPd: goto ELzlR; c1awC: $info['rights'] = $team; goto V2T5r; jJIdu: $regionarr = explode(',', $mutiteam['ridstr']); goto nLWha; t3zBe: if (empty($mutiteam)) { goto jAq3Z; } goto jJIdu; Ej4bA: HPN1V: goto EgeJx; yXl4F: load()->model('mc'); goto lOd8Q; B8nYy: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid=0'; goto y_i4Y; yFgmy: if (!empty($team)) { goto SyyGN; } goto vwkoD; ae2O8: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid>0'; goto utXiO; H3f03: $info['rights'] = $mutiteam; goto kw95J; AXKXK: if (!in_array($info['rid'], $regionarr)) { goto iADCb; } goto ISQKq; ISQKq: $info['ismanager'] = 1; goto eoR65; jwJGO: if (empty($mutiteam)) { goto ykr_1; } goto GvXjS; vKBGI: zaMS2: goto amrn1; GvXjS: $regionarr = explode(',', $mutiteam['ridstr']); goto O0fIo; DQvNE: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and t.rid=:rid and c.type=4 and (t.openid = :openid or t.uid = :uid) order by isdefault desc'; goto Th0Bj; DMED0: $info['rid'] = $rid; goto DQvNE; L9n12: JweHl: goto llm6R; SAcUG: JbJfv: goto OifTe; amrn1: jAq3Z: goto wzzxZ; knjgF: $info['ismanager'] = 1; goto rsuW9; WJ8DU: goto wknPd; goto qgJ13; Vjx3T: $team = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto XuIPS; HTkRn: if (empty($mutiteam)) { goto JRggK; } goto lwQeW; RsLhn: $info['ismanager'] = 1; goto AuGan; V8AIg: if (!empty($_W['minirid'])) { goto JweHl; } goto ae2O8; UpwVv: SyyGN: goto EyiMu; iT9LZ: $info['rights'] = $team; goto Pd_YD; dz_jj: $mutiteam = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto jwJGO; kw95J: JWoTJ: goto k7EfC; cgTp7: $mutiteam = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto t3zBe; V2T5r: Bup40: goto kp6nH; iFNcz: iADCb: goto SAcUG; xbGmV: $team = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto yFgmy; qgJ13: q2fyd: goto g0IzK; W0fZ0: S9fOs: goto tSyzN; wzzxZ: goto A2Vtf; goto zk8fi; k7EfC: ykr_1: goto YQHCl; O0fIo: if (empty($regionarr)) { goto JWoTJ; } goto knjgF; y_i4Y: $mutiteam = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto HTkRn; fIYhW: if (empty($regionarr)) { goto JbJfv; } goto AXKXK; HvZWT: $info['rid'] = $team['rid']; goto c1awC; DGkd0: $info['ismanager'] = 0; goto rd4So; AuGan: $info['rights'] = $mutiteam; goto vKBGI; rd4So: $info['uid'] = $uid; goto vbb3H; FQjUK: $info = array(); goto DGkd0; s2iXk: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid=0'; goto dz_jj; IAmsv: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and c.type=4 and (t.openid = :openid or t.uid = :uid) and t.rid=0'; goto cgTp7; Pd_YD: A2Vtf: goto W0fZ0; XuIPS: if (!empty($team)) { goto q2fyd; } goto B8nYy; Cv1Fj: gUDqh: goto FQjUK; g0IzK: $info['ismanager'] = 1; goto OVpCq; lOd8Q: $uid = mc_openid2uid($openid); goto Cv1Fj; ebORB: ZRLRA: goto NiGTG; EgeJx: $info['ismanager'] = 1; goto HvZWT; EyiMu: $info['ismanager'] = 1; goto oxJ83; rsuW9: $info['rid'] = $regionarr[0]; goto H3f03; nLWha: if (!in_array($info['rid'], $regionarr)) { goto zaMS2; } goto RsLhn; Th0Bj: $team = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'], ":openid" => $_W['openid'], ":uid" => $info['uid'])); goto uwwub; VQCgb: if (!empty($rid)) { goto gcUjW; } goto V8AIg; lwQeW: $regionarr = explode(',', $mutiteam['ridstr']); goto fIYhW; IE1TB: fftek: goto ebORB; eoR65: $info['rights'] = $mutiteam; goto iFNcz; YQHCl: goto Bup40; goto Ej4bA; oLTKr: if (!empty($team)) { goto HPN1V; } goto s2iXk; NiGTG: goto S9fOs; goto q2Msw; ZR0BI: global $_W; goto z8IhV; Gfgh0: if (!($uid == 0)) { goto gUDqh; } goto yXl4F; rPmhf: $sql = 'select t.*,c.title,c.right1,c.right2,c.right3,c.right4,c.right5,c.right6,c.right7,c.right8,c.right9,c.right10,c.right11,c.right12,c.right13,c.right14,c.right15,c.right16,c.right17,c.right18 FROM ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.status=1 and t.weid = :weid and t.rid=:rid and c.type=4 and (t.openid = :openid or t.uid = :uid) order by isdefault desc'; goto xbGmV; npV86: $info['ismanager'] = 1; goto iT9LZ; ELzlR: goto fftek; goto UpwVv; q2Msw: gcUjW: goto DMED0; vbb3H: $info['rights'] = array(); goto VQCgb; wVnc_: } public function getnotice($openid) { goto uUksS; iam7s: $unreadnotice = 0; goto hhri6; lHsct: goto K6s0q; goto k0hJR; IYVdO: $info['unreadnotice'] = $unreadnotice; goto c_S4P; qvNbE: $info = $this->getmyinfo($openid); goto O_yPu; Ug20e: $data = array_merge($data1, $data2); goto MM5X0; hhri6: foreach ($data as &$value) { goto X0IPQ; X0IPQ: $sql = 'select id from ' . tablename('rhinfo_zyxq_notice_log') . ' where weid=:weid and nid=:nid and uid=:uid limit 1'; goto S2FhO; lpQAK: $unreadnotice++; goto ABfOT; se2GJ: if (!empty($item)) { goto zMvEZ; } goto lpQAK; ABfOT: zMvEZ: goto GtwWg; S2FhO: $item = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'], ":nid" => $value['id'], ":uid" => $_W['member']['uid'])); goto se2GJ; GtwWg: NQ3ip: goto rAfZY; rAfZY: } goto GcMw0; OtLIW: $data = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'])); goto lHsct; hpeVY: if (!empty($notice)) { goto ir3xc; } goto FkepJ; fj6U1: $info = array(); goto qvNbE; uUksS: global $_W; goto fj6U1; z6FNE: $data2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'])); goto Ug20e; t108T: QOIDC: goto hpeVY; k0hJR: ir3xc: goto R0sw5; PjB0n: $sql = 'select * from ' . tablename('rhinfo_zyxq_member') . ' where weid=:weid and rid=:rid and (openid=:openid or uid=:uid) and bid>0 and tid > 0 and deleted=0 and status=0 order by isdefault desc'; goto LqMSH; heIUP: $sql = 'select * from ' . tablename('rhinfo_zyxq_notice') . ' where weid=:weid and rid=:rid and status>1 and category=1 and ' . $notice['bid'] . ' in (bid) and tid in(0,' . $notice['tid'] . ') and hid in(0,' . $notice['hid'] . ')'; goto z6FNE; MM5X0: K6s0q: goto iam7s; qT03J: $data1 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'])); goto heIUP; GcMw0: R8fZT: goto IYVdO; c_S4P: return $info; goto zRz1o; LqMSH: $notice = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'], ":openid" => $_W['openid'], ":uid" => $_W['member']['uid'])); goto t108T; FkepJ: $sql = 'select * from ' . tablename('rhinfo_zyxq_notice') . ' where weid=:weid and rid=:rid and status>1 and bid=0 and tid=0 and category=1'; goto OtLIW; R0sw5: $sql = 'select * from ' . tablename('rhinfo_zyxq_notice') . ' where weid=:weid and rid=:rid and status>1 and bid=0 and tid=0 and category=1'; goto qT03J; O_yPu: if (empty($info)) { goto QOIDC; } goto PjB0n; zRz1o: } public function mycondition() { goto NHC6x; Qp4iM: $mywe = $this->mywe; goto QfnWv; H6f3H: ZHfi4: goto G7U5R; bDQUU: $condition = ''; goto Qp4iM; G7U5R: return $condition; goto JazvU; QfnWv: if (!empty($_W['uid'])) { goto N21gl; } goto uD_yF; bd2z3: N21gl: goto JWUX9; JWUX9: if (empty($mywe['pid'])) { goto PmxUP; } goto oJScr; MHn3f: PmxUP: goto H6f3H; NHC6x: global $_W, $_GPC; goto bDQUU; lH8oH: goto ZHfi4; goto bd2z3; uD_yF: $condition = ' and pid = ' . $mywe['pid']; goto lH8oH; oJScr: $condition = ' and pid = ' . $mywe['pid']; goto MHn3f; JazvU: } public function myproperty() { goto BgcQf; UQhY2: $mywe = $this->mywe; goto CfwPK; hT1jC: Ar20x: goto X9C2T; dj7vb: return $property; goto jDUQ0; AGZtD: $property = pdo_fetchall($sql, array(":weid" => $mywe['weid'], ":pid" => $mywe['pid'])); goto TZtwq; IyGwy: if (!empty($mywe['pid'])) { goto Ar20x; } goto pjEaI; rMyIz: $property = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":pid" => $mywe['pid'])); goto ot2hX; CfwPK: if (!empty($_W['uid'])) { goto Z9LCv; } goto RYG88; QKz7R: $sql = 'select id,title from ' . tablename('rhinfo_zyxq_property') . ' where ' . $condition; goto AGZtD; RYG88: $condition = ' weid = :weid and id = :pid'; goto QKz7R; TMyvn: goto Qm2S5; goto hT1jC; ot2hX: Qm2S5: goto FZ2GQ; X9C2T: $sql = 'select id,title from ' . tablename('rhinfo_zyxq_property') . ' where weid = :weid and id=:pid'; goto rMyIz; TZtwq: goto PsOf5; goto YEgWQ; pjEaI: $sql = 'select id,title from ' . tablename('rhinfo_zyxq_property') . ' where weid = :weid'; goto uGM4I; BgcQf: global $_W, $_GPC; goto UQhY2; uGM4I: $property = pdo_fetchall($sql, array(":weid" => $_W['uniacid'])); goto TMyvn; FZ2GQ: PsOf5: goto dj7vb; YEgWQ: Z9LCv: goto IyGwy; jDUQ0: } public function mydo() { goto va70H; AnBl2: return $data; goto LYGsb; FEFq4: $data = pdo_fetchall($sql); goto AnBl2; va70H: $sql = 'select do,title from ' . tablename('rhinfo_zyxq_secprg') . ' order by sid,displayorder desc'; goto FEFq4; LYGsb: } public function myrcondition() { goto X___y; bw0XT: $condition = ' and pid = ' . $mywe['pid']; goto YS7zC; JFXw8: IB52s: goto w1H0K; yCX0e: jVutZ: goto l5etw; ecqZ4: CyKBM: goto jvVOI; X___y: global $_W, $_GPC; goto kxkTl; Z8tYH: noRUQ: goto I15Ag; uORhx: p3Av2: goto YVp4o; l5etw: if (empty($mywe['pid'])) { goto tzbjZ; } goto ax4Up; ka7bu: if ($user['gid'] == 0) { goto IB52s; } goto BV0AK; lHqCA: if (empty($mywe['pid'])) { goto hc9HM; } goto idAeC; KmgG4: erLbD: goto gJzwz; ibFln: hc9HM: goto VDRWm; GgtKe: i2OPT: goto jxf61; Mzoxe: DgNck: goto KH1JW; idAeC: $condition = ' and pid = ' . $mywe['pid']; goto ibFln; gJzwz: k9p_x: goto s9hzB; ax4Up: $condition = ' and pid = ' . $mywe['pid']; goto RP4Hn; w1H0K: $condition = ' and pid = ' . $mywe['pid']; goto EnIUh; ua2CH: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto oUVJu; EnIUh: qqJJk: goto NcoWV; KAR7p: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $_W['uid'])); goto V10DE; sMXOI: if ($user['rid']) { goto i2OPT; } goto lHqCA; BV0AK: if ($user['rid']) { goto noRUQ; } goto bw0XT; V10DE: if ($user['gid'] == 0) { goto jVutZ; } goto sMXOI; RZmAs: $mywe = $this->mywe; goto jUlVy; YS7zC: goto p3Av2; goto Z8tYH; NcoWV: goto k9p_x; goto ecqZ4; YVp4o: goto qqJJk; goto JFXw8; s9hzB: return $condition; goto PJCIT; KH1JW: goto erLbD; goto yCX0e; jvVOI: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto KAR7p; VDRWm: goto DgNck; goto GgtKe; jUlVy: if (!empty($_W['uid'])) { goto CyKBM; } goto ua2CH; I15Ag: $condition = ' and rid = ' . $user['rid']; goto uORhx; kxkTl: $condition = ''; goto RZmAs; jxf61: $condition = ' and rid = ' . $user['rid']; goto Mzoxe; oUVJu: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto ka7bu; RP4Hn: tzbjZ: goto KmgG4; PJCIT: } public function wyrcondition() { goto sx216; dO3Tf: HQX4Z: goto iQNcg; Rjh3I: mJw_E: goto IPfep; LAdkq: $condition = ' and pid = ' . $mywe['pid']; goto m2lai; iLxgu: ZKZ9p: goto NfHoa; wqM_n: x05X0: goto xCMUk; kg_lp: $mywe = $this->mywe; goto W2vvQ; m2lai: iRKqX: goto Rjh3I; z9I6X: Q13al: goto i9ITV; noD2S: $condition = ''; goto kg_lp; KKAv5: $condition = ' and id = ' . $user['rid']; goto eYfcz; W2vvQ: if (!empty($_W['uid'])) { goto x05X0; } goto Nryq6; rux_D: if ($user['gid'] == 0) { goto ZKZ9p; } goto VMM4t; i9ITV: goto ej1f3; goto y7ErV; tqsdI: goto TVROL; goto T_Bzu; byxhn: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto rux_D; IPfep: zerYW: goto L05q3; eYfcz: ej1f3: goto vZZnW; JRJLq: if ($user['rid']) { goto xmtwT; } goto pqIXI; NWnaS: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $_W['uid'])); goto Pa4GR; pqIXI: if (empty($mywe['pid'])) { goto Q13al; } goto XV53N; w5GVq: TVROL: goto RsTLa; y7ErV: xmtwT: goto KKAv5; sx216: global $_W, $_GPC; goto noD2S; T_Bzu: PYiGp: goto qPINA; vZZnW: goto mJw_E; goto dO3Tf; XV53N: $condition = ' and pid = ' . $mywe['pid']; goto z9I6X; Pa4GR: if ($user['gid'] == 0) { goto HQX4Z; } goto JRJLq; iQNcg: if (empty($mywe['pid'])) { goto iRKqX; } goto LAdkq; RsTLa: goto tu2AW; goto iLxgu; NfHoa: $condition = ' and pid = ' . $mywe['pid']; goto maSUN; maSUN: tu2AW: goto bjwvT; xCMUk: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto NWnaS; VMM4t: if ($user['rid']) { goto PYiGp; } goto f_VIR; bjwvT: goto zerYW; goto wqM_n; L05q3: return $condition; goto Nfcj1; Nryq6: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto byxhn; qPINA: $condition = ' and id = ' . $user['rid']; goto w5GVq; f_VIR: $condition = ' and pid = ' . $mywe['pid']; goto tqsdI; Nfcj1: } public function mymenus() { goto hQcTh; Do3oI: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto HDTHI; dvZhw: if ($user['gid'] == 0) { goto y0qI2; } goto Ty0qi; gQWCy: JLF1f: goto uvL2y; nXeU2: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto cF9z5; Iww59: goto VqLX4; goto sLPFo; HDTHI: qmkix: goto Lmuxs; eat4b: QxwVz: goto Y7fMf; Ty0qi: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 order by displayorder ,id'; goto jxLfI; ogX5G: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto KBwFV; HhIv3: goto tWeDy; goto o5XH5; NaHMO: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto huxYm; agaV4: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay order by displayorder ,id'; goto fqBnc; QlBXs: $user = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $_W['uid'])); goto IcgyB; twVsZ: if (empty($menus)) { goto KjDg1; } goto ewjYj; clFlz: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay  order by displayorder ,id'; goto uYXJE; rlpIO: if (!empty($user)) { goto dWbv3; } goto aQdgI; Su3Nb: Bo96c: goto I1X3C; so0tA: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto suFvt; gm7Hc: uIIIh: goto Iww59; rPN4K: g_bpo: goto kEcNp; huxYm: goto ztNnO; goto tTX87; Xx8Gb: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder ,id'; goto gVO9Q; q4w4Q: YesqR: goto gBLWD; vxTP0: K1y4y: goto ddqBm; ugKxs: YImXo: goto PxT6o; hP4Q3: foreach ($menus as &$value) { goto I5Bib; HEZtj: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":isdisplay" => "1")); goto UD42Z; onY5i: $submenus = pdo_fetchall($sql, $params = array(":sid" => $value['id'], ":isdisplay" => "1")); goto LftZ3; g7EhW: if (empty($submenus)) { goto QNjkq; } goto p7hTo; I5Bib: if ($_W['isfounder']) { goto gaVoU; } goto uggWh; UD42Z: goto LiBEU; goto z1qx7; T_WB3: hcCP0: goto g7EhW; gfLBG: QNjkq: goto PnniC; f2wL2: FNT0w: goto Ae_PS; KMR3g: gaVoU: goto YbMHn; LftZ3: Bk1e3: goto VcIaq; oxC_U: $sql = 'select p.id,p.title,p.url,p.op,p.do,p.iconfont from ' . tablename('rhinfo_zyxq_secprg') . ' as p ,' . tablename('rhinfo_zyxq_secgprg') . 'as g where p.id = g.pid and g.gid = ' . $user['gid'] . ' and p.sid = :sid and p.isdisplay = :isdisplay and p.isdismenu=1  order by p.displayorder , p.id'; goto HEZtj; xeLMf: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdisplay = :isdisplay and isdismenu=1 order by displayorder, id'; goto alg8x; PnniC: vl03m: goto oCc0i; VcIaq: if (empty($user['pid'])) { goto hcCP0; } goto J0NoG; YbMHn: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdisplay = :isdisplay and isdismenu=1 order by displayorder, id'; goto onY5i; MeL5U: t7_s3: goto T_WB3; alg8x: $submenus = pdo_fetchall($sql, $params = array(":sid" => $value['id'], ":isdisplay" => "1")); goto N9fxL; N9fxL: LiBEU: goto IugJE; uggWh: if ($user['gid'] == 0) { goto FWO6G; } goto oxC_U; IugJE: goto Bk1e3; goto KMR3g; p7hTo: foreach ($submenus as &$item) { goto j3Ypv; T2G8J: h3jxc: goto JminU; j3Ypv: if (!(!empty($item['op']) && !empty($item['do']))) { goto h3jxc; } goto k97wg; JminU: Jw0W7: goto EzsR1; k97wg: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])) . $mywe['direct']; goto T2G8J; EzsR1: } goto f2wL2; Ae_PS: $value['submenus'] = $submenus; goto gfLBG; J0NoG: foreach ($submenus as $key => $subvalue) { goto GLtO7; lBpSa: nQoQL: goto aWRJF; GLtO7: if (!in_array($subvalue['id'], $hidemenus)) { goto nQoQL; } goto DZBh4; DZBh4: unset($submenus[$key]); goto lBpSa; aWRJF: cSG2e: goto p_jpL; p_jpL: } goto MeL5U; z1qx7: FWO6G: goto xeLMf; oCc0i: } goto eat4b; xIVMq: pG20A: goto agaV4; M3xNv: dWbv3: goto MVjG9; dbdXM: Lr3C7: goto j9N_b; eKkQm: A94Vf: goto rPN4K; fo6kI: VqLX4: goto q4w4Q; QVfey: if (!empty($_W['uid'])) { goto R_4lR; } goto b9OXT; PxT6o: xtyQJ: goto KGolP; K6syZ: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto jE9Xv; tPmvy: $secacc = pdo_fetch($sql, array(":weid" => $mywe['weid'])); goto QDt56; Mo_TK: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto ER8Re; yo7oY: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys= 0  order by displayorder ,id'; goto so0tA; jE9Xv: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto dvZhw; gVO9Q: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto BghRc; hQcTh: global $_W, $_GPC; goto qMK5S; Q_nFo: foreach ($menus as &$value) { goto a5jEz; ubG9l: $submenus = pdo_fetchall($sql, $params = array(":sid" => $value['id'], ":isdisplay" => "1")); goto jw9Hm; PCNtC: if (empty($submenus)) { goto irsjJ; } goto G0ah4; nfLtj: $value['submenus'] = $submenus; goto TBFWm; jw9Hm: zOmee: goto PCNtC; uBP3M: $sql = 'select p.id,p.title,p.url,p.op,p.do,p.iconfont from ' . tablename('rhinfo_zyxq_secprg') . ' as p ,' . tablename('rhinfo_zyxq_secgprg') . 'as g where p.id = g.pid and g.gid = ' . $user['gid'] . ' and p.sid = :sid and p.issys = 0 and p.isdisplay = :isdisplay and isdismenu=1 and p.id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by p.displayorder , p.id'; goto iOJsy; TBFWm: irsjJ: goto ldej1; ldej1: E72_m: goto PdERU; G0ah4: foreach ($submenus as &$item) { goto IH3Zp; vwL_f: yb0Fi: goto kfYy9; kfYy9: bixea: goto a9TTZ; IH3Zp: if (!(!empty($item['op']) && !empty($item['do']))) { goto yb0Fi; } goto S74zQ; S74zQ: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])) . $mywe['direct']; goto vwL_f; a9TTZ: } goto Stfc2; UItsn: lb8dk: goto wNMdT; iOJsy: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":isdisplay" => "1")); goto scWJf; scWJf: goto zOmee; goto UItsn; a5jEz: if ($user['gid'] == 0) { goto lb8dk; } goto uBP3M; Stfc2: mWSWr: goto nfLtj; wNMdT: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and issys = 0 and isdisplay = :isdisplay and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by displayorder , id'; goto ubG9l; PdERU: } goto CKuTN; QDt56: $hidesys = array("14", "8"); goto M6C1w; Hk_KX: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder ,id'; goto NaHMO; rphcX: IJJcS: goto YcxA5; fU0PR: $menus = array(); goto lUiOE; nGkSB: $sql = 'select * from ' . tablename('rhinfo_zyxq_secacc') . ' where weid = :weid and status=1'; goto tPmvy; jxLfI: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto HhIv3; o5XH5: y0qI2: goto yo7oY; sLPFo: R_4lR: goto aKxpB; ddqBm: goto YesqR; goto i1Cia; h_naK: if (empty($user['pid'])) { goto RAOlL; } goto B3Zri; VqnDt: goto ztNnO; goto RdbIX; suFvt: tWeDy: goto aLb2s; GLHE7: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto s2Qge; aKxpB: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto VpLyr; aQdgI: $menus = array(); goto VqnDt; i1Cia: J49li: goto QVfey; tTX87: l27KP: goto nzu3N; rb1VV: foreach ($menus as $key => $value) { goto k3KoB; Cx2PY: PtcyR: goto IADne; oJHcp: unset($menus[$key]); goto dJ21Z; k3KoB: if (!in_array($value['id'], $hidesys)) { goto MSLoY; } goto oJHcp; dJ21Z: MSLoY: goto Cx2PY; IADne: } goto Kqidb; iH_VI: okKON: goto jiwTp; s2Qge: ztNnO: goto h_naK; mVSdq: if (empty($user['pid'])) { goto g_bpo; } goto hYswH; Lmuxs: if (empty($menus)) { goto uIIIh; } goto Q_nFo; kEcNp: xdf0K: goto e_4aH; CKuTN: zhbkc: goto gm7Hc; gBLWD: return $menus; goto bRyOz; b9OXT: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto ogX5G; uYXJE: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto zzNZm; VpLyr: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $_W['uid'])); goto vJhrn; IIPTz: foreach ($menus as &$value) { goto iUkAD; X0uE8: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and issys = 0 and isdisplay = :isdisplay and isdismenu=1 order by displayorder , id'; goto ZfThR; Zr4c4: cRNnl: goto kDBKe; EKKZp: foreach ($submenus as &$item) { goto BuONf; urdkR: PiN0a: goto lLnU1; lLnU1: JhO8a: goto zW8mR; T_GTn: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])) . $mywe['direct']; goto urdkR; BuONf: if (!(!empty($item['op']) && !empty($item['do']))) { goto PiN0a; } goto T_GTn; zW8mR: } goto z2Hqg; L1l07: u48FP: goto Zr4c4; QKHPS: $value['submenus'] = $submenus; goto L1l07; WDtgr: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":isdisplay" => "1")); goto O6GY0; iUkAD: if ($user['gid'] == 0) { goto SR0xT; } goto WvJmd; apKqd: SR0xT: goto X0uE8; WvJmd: $sql = 'select p.title,p.url,p.op,p.do,p.iconfont from ' . tablename('rhinfo_zyxq_secprg') . ' as p ,' . tablename('rhinfo_zyxq_secgprg') . 'as g where p.id = g.pid and g.gid = ' . $user['gid'] . ' and p.sid = :sid and p.issys = 0 and p.isdisplay = :isdisplay and isdismenu=1 order by p.displayorder , p.id'; goto WDtgr; Hjhwo: v6Cjx: goto reHVH; O6GY0: goto v6Cjx; goto apKqd; ZfThR: $submenus = pdo_fetchall($sql, $params = array(":sid" => $value['id'], ":isdisplay" => "1")); goto Hjhwo; reHVH: if (empty($submenus)) { goto u48FP; } goto EKKZp; z2Hqg: BTBEZ: goto QKHPS; kDBKe: } goto ugKxs; KGolP: goto K1y4y; goto dbdXM; erj2p: if (!empty($user) && $user['gid'] == 0) { goto l27KP; } goto rlpIO; de6oU: if (!empty($user) && $user['gid'] == 0) { goto ZTrDJ; } goto bgMUm; eiVLl: goto nF6Q5; goto QtfKA; cF9z5: goto ztNnO; goto M3xNv; QtfKA: ZTrDJ: goto clFlz; hYswH: foreach ($menus as $key => $value) { goto bAXps; Ef5WW: ANb7s: goto euytW; bAXps: if (!in_array($value['id'], $hidesys)) { goto ANb7s; } goto TNSZr; TNSZr: unset($menus[$key]); goto Ef5WW; euytW: OdvU2: goto SXccu; SXccu: } goto eKkQm; Kqidb: gssrX: goto gQWCy; B3Zri: if (empty($user['pid'])) { goto JLF1f; } goto rb1VV; M6C1w: $hidemenus = array("70", "71", "72", "42", "3"); goto rdARI; Qz4z0: if (empty($user['pid'])) { goto xdf0K; } goto mVSdq; aLb2s: if (empty($menus)) { goto xtyQJ; } goto IIPTz; vJhrn: if ($_W['isfounder']) { goto lGBCA; } goto erj2p; I1X3C: KjDg1: goto fo6kI; BghRc: goto qmkix; goto iH_VI; RdbIX: lGBCA: goto Hk_KX; Y7fMf: no1v7: goto vxTP0; X41Gz: if (!empty($_W['uid'])) { goto Lr3C7; } goto K6syZ; e_4aH: if (empty($menus)) { goto no1v7; } goto hP4Q3; ER8Re: nF6Q5: goto Qz4z0; lUiOE: goto nF6Q5; goto xIVMq; jiwTp: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys= 0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder ,id'; goto Do3oI; ewjYj: foreach ($menus as &$value) { goto WU8wM; bF2ZR: if (empty($submenus)) { goto e7faN; } goto e31U9; e31U9: foreach ($submenus as &$item) { goto Nvlyz; LwzxT: ltJBH: goto aRCSg; IhvyA: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])) . $mywe['direct']; goto NKCQY; NKCQY: pzcRi: goto LwzxT; Nvlyz: if (!(!empty($item['op']) && !empty($item['do']))) { goto pzcRi; } goto IhvyA; aRCSg: } goto WRNgg; s7_Wi: CrDjm: goto YC0TW; WU8wM: if ($_W['isfounder']) { goto pj5b2; } goto ToC8g; eZWQK: $submenus = pdo_fetchall($sql, $params = array(":sid" => $value['id'], ":isdisplay" => "1")); goto MFkRa; GKyvY: DpDXT: goto IXz3i; WRNgg: StIY4: goto j6bN7; UjfHP: hXL6V: goto bF2ZR; lF9Eb: rdhlb: goto UjfHP; ToC8g: if ($user['gid'] == 0) { goto DpDXT; } goto deb4z; Cap7s: D3j2P: goto MPdIo; deb4z: $sql = 'select p.title,p.url,p.op,p.do,p.iconfont from ' . tablename('rhinfo_zyxq_secprg') . ' as p ,' . tablename('rhinfo_zyxq_secgprg') . 'as g where p.id = g.pid and g.gid = ' . $user['gid'] . ' and p.sid = :sid and p.isdisplay = :isdisplay and p.isdismenu=1 and p.id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by p.displayorder , p.id'; goto lEqZH; j6bN7: $value['submenus'] = $submenus; goto Uu3ee; Sf4MG: if (empty($user['pid'])) { goto hXL6V; } goto UyXKG; lEqZH: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":isdisplay" => "1")); goto CCxHZ; Vz1oA: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdisplay = :isdisplay and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by displayorder, id'; goto eZWQK; MFkRa: C3Fuv: goto Sf4MG; DNXlB: pj5b2: goto Vz1oA; RiLXn: $submenus = pdo_fetchall($sql, $params = array(":sid" => $value['id'], ":isdisplay" => "1")); goto s7_Wi; CCxHZ: goto CrDjm; goto GKyvY; UyXKG: foreach ($submenus as $key => $subvalue) { goto pFrIu; fvTTG: MmXFJ: goto e2MMi; VF5hz: oUS7F: goto fvTTG; NQATV: unset($submenus[$key]); goto VF5hz; pFrIu: if (!in_array($subvalue['id'], $hidemenus)) { goto oUS7F; } goto NQATV; e2MMi: } goto lF9Eb; IXz3i: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdisplay = :isdisplay and isdismenu=1  order by displayorder, id'; goto RiLXn; Uu3ee: e7faN: goto Cap7s; YC0TW: goto C3Fuv; goto DNXlB; MPdIo: } goto Su3Nb; zzNZm: goto nF6Q5; goto rphcX; qMK5S: $mywe = $this->mywe; goto nGkSB; KBwFV: if ($user['gid'] == 0) { goto okKON; } goto Xx8Gb; fqBnc: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto eiVLl; YcxA5: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $_W['uniacid'] . ') and isdisplay = :isdisplay order by displayorder ,id'; goto Mo_TK; j9N_b: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto QlBXs; MVjG9: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder ,id'; goto GLHE7; uvL2y: RAOlL: goto twVsZ; nzu3N: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder ,id'; goto nXeU2; rdARI: if (!empty($secacc)) { goto J49li; } goto X41Gz; IcgyB: if ($_W['isfounder']) { goto pG20A; } goto de6oU; bgMUm: if (!empty($user)) { goto IJJcS; } goto fU0PR; bRyOz: } public function rolemenus() { goto u4o6F; xIUpI: goto xiejv; goto vGPUW; CMeq0: F52nP: goto usCop; Hxa_d: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto cfgL4; cKpzt: foreach ($menus as &$value) { goto fySV0; XVDvo: Uw8jB: goto ts0yk; SA8Em: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto vB2X0; fySV0: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.issys = 0 and p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 order by isdisplay desc ,displayorder asc'; goto SA8Em; rAXPX: $value['submenus'] = $submenus; goto XVDvo; vB2X0: if (empty($submenus)) { goto Uw8jB; } goto tTcyC; ts0yk: GLe9D: goto zPoz5; RJJec: y0w9K: goto rAXPX; tTcyC: foreach ($submenus as &$item) { goto PRSix; cE7ys: g5t39: goto WernB; PRSix: if (!(!empty($item['op']) && !empty($item['do']))) { goto Z6abv; } goto fUALl; fUALl: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto X0jXu; X0jXu: Z6abv: goto cE7ys; WernB: } goto RJJec; zPoz5: } goto CbYGj; lK2yn: OhHgy: goto cBX4z; wCulK: foreach ($menus as &$value) { goto sbjHk; G1Oyv: if (empty($submenus)) { goto sViEz; } goto Obvas; XROQK: G89j0: goto Okawv; dwTFI: g3yGe: goto rnRX8; VuBSn: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto G1Oyv; x2fwz: sViEz: goto XROQK; rnRX8: $value['submenus'] = $submenus; goto x2fwz; sbjHk: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and issys=0 and isdismenu=1 order by isdisplay desc ,displayorder asc'; goto VuBSn; Obvas: foreach ($submenus as &$item) { goto OTcEK; M50Ph: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto Oe5XR; Oe5XR: D6ccA: goto c1e8p; c1e8p: fDp7Y: goto ReHHH; OTcEK: if (!(!empty($item['op']) && !empty($item['do']))) { goto D6ccA; } goto M50Ph; ReHHH: } goto dwTFI; Okawv: } goto kHs7e; eIR6D: goto Pu7hO; goto IcWxz; jlkU8: if ($_W['isfounder']) { goto XAN1A; } goto i2nCU; cvQru: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto LB4tM; jbgdm: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto uU5ar; n2qcv: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto eIR6D; BrfV_: if (empty($menus)) { goto Iq2lA; } goto WSyvl; CqMhs: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto dYUj0; TQJVj: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto cvQru; o6zk0: gKe0J: goto DNVmv; STKfi: goto F52nP; goto Un9sb; vr139: if (!empty($_W['uid'])) { goto SurmF; } goto rk_lr; vkE79: yyJCR: goto HIjKx; YNMRv: goto GN5nL; goto IWeVy; rySeD: RFi5p: goto HvXaR; RMvph: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto NvP7T; lTXLg: if (empty($menus)) { goto rvb8H; } goto V6Gew; UnObC: if ($user['gid'] == 0) { goto edF9C; } goto deDXQ; isBT2: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto tJS56; gz3TY: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay order by displayorder'; goto M4xGs; qcY1L: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys=0 order by displayorder'; goto o6zk0; IcWxz: visx1: goto RMvph; Un9sb: hFPNQ: goto HeBDu; YMvSK: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto a0AGi; BHnuS: foreach ($menus as &$value) { goto GYaXq; UucqQ: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto tS_Ao; Isx1b: jsLOa: goto feFVJ; tS_Ao: if (empty($submenus)) { goto u3K_N; } goto iN_wx; EgqUo: u3K_N: goto Isx1b; iN_wx: foreach ($submenus as &$item) { goto Xhxl1; hnAwv: tjYvk: goto lrZRk; lrZRk: IvmN9: goto xwX15; Xhxl1: if (!(!empty($item['op']) && !empty($item['do']))) { goto tjYvk; } goto yScuL; yScuL: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto hnAwv; xwX15: } goto Xp94a; GYaXq: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 order by isdisplay desc ,displayorder asc'; goto UucqQ; Xp94a: q0ARz: goto MhCkc; MhCkc: $value['submenus'] = $submenus; goto EgqUo; feFVJ: } goto PIa21; zugtm: xiejv: goto CMeq0; BKI9T: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto OQ73x; Gib3q: dM_6m: goto tTsYB; ZU0jf: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto YTrsX; ENYkr: XAN1A: goto TQJVj; ux8il: if (empty($user['gid'])) { goto aRG3e; } goto g9UEW; g9UEW: if (empty($menus)) { goto RFi5p; } goto cKpzt; hdkUI: goto NLMNb; goto N0Z8E; DbXcK: if (empty($menus)) { goto l42Ng; } goto wCulK; NxuXd: xxtGE: goto lnQXY; M4xGs: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto f1XNp; U1OLO: hnFor: goto lw27r; HvmHV: foreach ($menus as &$value) { goto CWh1n; lwkSF: DuiaB: goto nHopG; maVnp: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto qIMPt; Pb36Q: NZ4GI: goto lwkSF; ALrzN: gfAMM: goto EsCHl; qIMPt: if (empty($submenus)) { goto NZ4GI; } goto TwYbT; TwYbT: foreach ($submenus as &$item) { goto kNq5u; RVIqE: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto A1VoJ; A1VoJ: WdDbS: goto Pasxj; kNq5u: if (!(!empty($item['op']) && !empty($item['do']))) { goto WdDbS; } goto RVIqE; Pasxj: ROjxl: goto lh6Nf; lh6Nf: } goto ALrzN; EsCHl: $value['submenus'] = $submenus; goto Pb36Q; CWh1n: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.issys = 0 and p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 and p.id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto maVnp; nHopG: } goto NHSJ6; HIjKx: Iq2lA: goto hakxM; dfnn_: foreach ($menus as &$value) { goto lOP0X; PazV6: if (empty($submenus)) { goto ebYV0; } goto jpo7z; jpo7z: foreach ($submenus as &$item) { goto swCfV; svXg_: NaNlt: goto hbKVC; swCfV: if (!(!empty($item['op']) && !empty($item['do']))) { goto NaNlt; } goto K6_D4; K6_D4: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto svXg_; hbKVC: b5Wf7: goto POzCP; POzCP: } goto Xmahx; cUQ06: $value['submenus'] = $submenus; goto fJN36; tCUCD: huGUu: goto nYXZq; lOP0X: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 order by isdisplay desc ,displayorder asc'; goto IdfsE; fJN36: ebYV0: goto tCUCD; IdfsE: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto PazV6; Xmahx: dCnzm: goto cUQ06; nYXZq: } goto uw5qv; HeBDu: if (!empty($_W['uid'])) { goto Ua2Et; } goto HwO6W; rk_lr: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto pNOtq; V6Gew: foreach ($menus as &$value) { goto Rw0YY; nYb2K: BBG71: goto t4Loa; Rw0YY: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.issys=0 and p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 order by isdisplay desc ,displayorder asc'; goto jjc8d; jjc8d: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto je01x; rUpuE: VHImP: goto UyLP8; jE9hm: foreach ($submenus as &$item) { goto EO6R_; EO6R_: if (!(!empty($item['op']) && !empty($item['do']))) { goto jCzQ1; } goto h0J1N; Eef8L: Y0Mdv: goto vjbfS; h0J1N: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto oPjl7; oPjl7: jCzQ1: goto Eef8L; vjbfS: } goto nYb2K; prcCO: t2Lsn: goto rUpuE; je01x: if (empty($submenus)) { goto t2Lsn; } goto jE9hm; t4Loa: $value['submenus'] = $submenus; goto prcCO; UyLP8: } goto XraKF; DNVmv: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto ux8il; PM9Ta: foreach ($menus as &$value) { goto oYbfo; oYbfo: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto baomZ; K3mK3: bAj66: goto YFCiA; mUJoU: nm3cq: goto K3mK3; baomZ: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto jMEAN; jMEAN: if (empty($submenus)) { goto nm3cq; } goto rO67A; BWjLA: $value['submenus'] = $submenus; goto mUJoU; rO67A: foreach ($submenus as &$item) { goto l8UaJ; OMzXn: bKcE8: goto i9663; l8UaJ: if (!(!empty($item['op']) && !empty($item['do']))) { goto jZl5R; } goto jIBKN; NtB26: jZl5R: goto OMzXn; jIBKN: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto NtB26; i9663: } goto be6ug; be6ug: k41ld: goto BWjLA; YFCiA: } goto BtjOD; BtjOD: XWfaJ: goto hgHQ2; NHSJ6: JkuyM: goto SOwy7; cBX4z: NLMNb: goto ThI68; hXdkg: goto fa6cD; goto lc_yJ; NvP7T: Pu7hO: goto YMvSK; DRVK2: l42Ng: goto Ye0fH; jCQPC: if ($_W['isfounder']) { goto o2YiO; } goto UnObC; ygcEN: foreach ($menus as &$value) { goto TDEW1; pvC6w: $value['submenus'] = $submenus; goto KBTB1; qAYp5: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto EKnMX; HV5qV: foreach ($submenus as &$item) { goto RYMxp; RCQba: BltgE: goto T9wgG; n496g: ie6Oa: goto RCQba; k5_VM: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto n496g; RYMxp: if (!(!empty($item['op']) && !empty($item['do']))) { goto ie6Oa; } goto k5_VM; T9wgG: } goto ETjN7; udoed: l4CuY: goto h1G3M; ETjN7: br4dn: goto pvC6w; EKnMX: if (empty($submenus)) { goto vm70W; } goto HV5qV; TDEW1: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto qAYp5; KBTB1: vm70W: goto udoed; h1G3M: } goto eOFx2; WSyvl: foreach ($menus as &$value) { goto JXfzF; jRpTX: $value['submenus'] = $submenus; goto WwrLB; B08Ho: foreach ($submenus as &$item) { goto zm0Ps; zm0Ps: if (!(!empty($item['op']) && !empty($item['do']))) { goto Y6MAu; } goto M2MV1; lKnH_: Y6MAu: goto GsEcF; GsEcF: b2qdL: goto PrPXm; M2MV1: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto lKnH_; PrPXm: } goto l0jEf; hjDJv: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto JsuDt; gNEXy: icfU6: goto K6U9h; JXfzF: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and issys=0 and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto hjDJv; JsuDt: if (empty($submenus)) { goto FpRWI; } goto B08Ho; l0jEf: ijkVu: goto jRpTX; WwrLB: FpRWI: goto gNEXy; K6U9h: } goto vkE79; yfyXg: if (!empty($secacc)) { goto hFPNQ; } goto vr139; kHs7e: qxsg0: goto DRVK2; pS1UC: aRG3e: goto DbXcK; FsoYv: rvb8H: goto HJgm1; ThI68: GN5nL: goto STKfi; QzULr: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto lTXLg; XraKF: jRuGv: goto FsoYv; PIa21: A6toT: goto lK2yn; LBNZ9: KUrw2: goto zugtm; cpuwf: if (empty($menus)) { goto xxtGE; } goto gMgrc; usCop: return $menus; goto RQeA7; YTrsX: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto jlkU8; znE0N: $mywe = $this->mywe; goto Ab4To; tTsYB: goto KUrw2; goto ENYkr; Wpe9U: edF9C: goto Tw9yW; RITQD: shiYG: goto qcY1L; uU5ar: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto jCQPC; u4o6F: global $_W, $_GPC; goto znE0N; cM_GX: n52j_: goto NxuXd; hgHQ2: N248W: goto Gib3q; SOwy7: UqcUb: goto hXdkg; cfgL4: if (empty($menus)) { goto Cgkuh; } goto dfnn_; lnQXY: goto dM_6m; goto U1OLO; pNOtq: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto F50L2; CbYGj: txmXC: goto rySeD; eOFx2: KizQp: goto EouIZ; hakxM: fa6cD: goto xIUpI; deDXQ: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 order by displayorder'; goto QzULr; gMgrc: foreach ($menus as &$value) { goto Agggg; Ko_JW: GbKhy: goto pNdrO; Agggg: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.issys=0 and p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 and p.id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto BYjFC; eV03C: $value['submenus'] = $submenus; goto gHhjA; gHhjA: YZ4dH: goto Ko_JW; BYjFC: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto ewcLU; H7JvN: fES6F: goto eV03C; ewcLU: if (empty($submenus)) { goto YZ4dH; } goto JHI6U; JHI6U: foreach ($submenus as &$item) { goto XlKz3; zVFsn: WG_ba: goto FtSyP; tVJY0: bOtlP: goto zVFsn; XlKz3: if (!(!empty($item['op']) && !empty($item['do']))) { goto bOtlP; } goto NSLc9; NSLc9: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto tVJY0; FtSyP: } goto H7JvN; pNdrO: } goto cM_GX; zGBIt: if (empty($menus)) { goto UqcUb; } goto HvmHV; lc_yJ: zfqxb: goto BrfV_; LB4tM: if (empty($menus)) { goto K7tal; } goto ygcEN; Tw9yW: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys=0 order by displayorder'; goto Hxa_d; HwO6W: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto isBT2; bIEqd: Cgkuh: goto QcDbI; tJS56: if (empty($user['gid'])) { goto visx1; } goto n2qcv; EouIZ: K7tal: goto LBNZ9; f1XNp: if (empty($menus)) { goto OhHgy; } goto BHnuS; vGPUW: Ua2Et: goto ZU0jf; IWeVy: SurmF: goto jbgdm; yzqvy: goto gKe0J; goto RITQD; i2nCU: if ($user['gid'] == 0) { goto hnFor; } goto CqMhs; s_cYz: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay  and issys=0 order by displayorder'; goto yzqvy; dYUj0: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto cpuwf; a0AGi: if (empty($user['gid'])) { goto zfqxb; } goto zGBIt; HvXaR: goto gJVsB; goto pS1UC; N0Z8E: o2YiO: goto gz3TY; lw27r: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto BKI9T; QcDbI: TiyXw: goto hdkUI; uw5qv: rbbCn: goto bIEqd; Ab4To: $sql = 'select * from ' . tablename('rhinfo_zyxq_secacc') . ' where weid = :weid and status=1'; goto PVqO_; HJgm1: goto TiyXw; goto Wpe9U; Ye0fH: gJVsB: goto YNMRv; PVqO_: $secacc = pdo_fetch($sql, array(":weid" => $mywe['weid'])); goto yfyXg; OQ73x: if (empty($menus)) { goto N248W; } goto PM9Ta; F50L2: if (empty($user['gid'])) { goto shiYG; } goto s_cYz; RQeA7: } public function rolemenus_edit($gid) { goto TuTUu; TuTUu: global $_W, $_GPC; goto rWtNJ; Z70wd: AIaUH: goto POdl6; uP1MO: if ($_W['isfounder']) { goto t2MeS; } goto uApZ9; nC8ar: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto eqnD5; ZfRUC: return $menus; goto tXtDm; xfB5K: $sql = 'select * from ' . tablename('rhinfo_zyxq_secacc') . ' where weid = :weid and status=1'; goto NxKU7; jCMGr: if ($_W['isfounder']) { goto emY62; } goto UnGzT; ux9xx: yFngY: goto yF1be; x_9jB: foreach ($menus as &$value) { goto s4lbq; qrmFb: BsAMD: goto efPxA; UUP3S: M8un9: goto KOhRO; VZYfX: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto dPM7L; s4lbq: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and issys=0 and isdismenu=1 order by isdisplay desc ,displayorder asc'; goto VZYfX; efPxA: ZSkhE: goto CEvyr; h2xgF: if (empty($submenus)) { goto BsAMD; } goto a93Io; a93Io: foreach ($submenus as &$item) { goto Bwzoj; BF5p8: $item['rights'] = $rights; goto Ek050; Fq0P_: $rights = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":gid" => $gid, ":pid" => $item['id'])); goto v5BLN; Bwzoj: if (!(!empty($item['op']) && !empty($item['do']))) { goto JuWSe; } goto sM4ms; xQ1Z_: UkljV: goto xnZEj; xnZEj: WPDEZ: goto T0bsW; VsyyN: ufSLr: goto kbDOx; Ek050: $i = 0; goto k1xS_; kbDOx: $item['prg'] = $i; goto Uy7I7; fK_Zu: JuWSe: goto QzoPG; v5BLN: if (!$rights) { goto UkljV; } goto BF5p8; QzoPG: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto Fq0P_; sM4ms: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto fK_Zu; k1xS_: foreach ($rights as $key) { goto N4_r4; M7qr2: $i = 1; goto IhZjb; IhZjb: goto ufSLr; goto j3Pkm; j3Pkm: SzeN8: goto ZKq5D; ZKq5D: J6O3o: goto myNvC; N4_r4: if (!($key == 1)) { goto SzeN8; } goto M7qr2; myNvC: } goto VsyyN; Uy7I7: $j = $i; goto xQ1Z_; T0bsW: } goto UUP3S; dPM7L: $j = 0; goto h2xgF; KOhRO: $value['submenus'] = $submenus; goto nVbfO; nVbfO: $value['sys'] = $j; goto qrmFb; CEvyr: } goto dnStz; zxP8Y: foreach ($menus as &$value) { goto XSNz4; SlL0o: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto jY6mI; vt5Dv: foreach ($submenus as &$item) { goto fJMrU; dG1EE: eqgBM: goto M_oQ8; b3ZkD: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $gid, ":pid" => $item['id'])); goto jwmyW; FnbCQ: $j = $i; goto dG1EE; A1_E3: $i = 0; goto YjBWu; ZC0Mj: XP1e1: goto LgFm7; K7vHR: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto ZC0Mj; ZbcFJ: $item['prg'] = $i; goto FnbCQ; DvJyo: $item['rights'] = $rights; goto A1_E3; fJMrU: if (!(!empty($item['op']) && !empty($item['do']))) { goto XP1e1; } goto K7vHR; YjBWu: foreach ($rights as $key) { goto x7Hib; x7Hib: if (!($key == 1)) { goto GXy8H; } goto oTZuR; oTZuR: $i = 1; goto aKZCj; Q_l6v: pJLwL: goto O25sf; aKZCj: goto qG483; goto TqG6h; TqG6h: GXy8H: goto Q_l6v; O25sf: } goto PNjlF; LgFm7: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto b3ZkD; jwmyW: if (!$rights) { goto eqgBM; } goto DvJyo; PNjlF: qG483: goto ZbcFJ; M_oQ8: IhSSD: goto KbZed; KbZed: } goto vpN2t; TKeRJ: $value['sys'] = $j; goto PPsz2; XSNz4: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 order by isdisplay desc ,displayorder asc'; goto SlL0o; jY6mI: $j = 0; goto QUNWe; wOWDb: k_LCj: goto EnEfw; PPsz2: DdVuI: goto wOWDb; r5aLe: $value['submenus'] = $submenus; goto TKeRJ; vpN2t: t9GXa: goto r5aLe; QUNWe: if (empty($submenus)) { goto DdVuI; } goto vt5Dv; EnEfw: } goto ttH1b; ZmaE5: Pwqva: goto ZRB0q; OAs5r: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys=0 order by displayorder'; goto VFnhh; AN5bq: emY62: goto NCJ4m; RgzgI: if (empty($menus)) { goto SP83j; } goto OQzJN; ygg9y: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto EvH06; Qvrqg: if (empty($menus)) { goto fWJc2; } goto zxP8Y; JdETT: if (empty($menus)) { goto bFc9G; } goto x_9jB; KNru3: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $_W['uniacid'] . ') and isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto n3pDC; OD_83: goto Jsqkk; goto GCotQ; NCJ4m: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay order by displayorder'; goto PWrWt; Vqz2y: Dxyb0: goto CMCPJ; x66BI: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay order by displayorder'; goto xn3WR; WcX5u: QlAeD: goto HN9yM; cVpJx: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto mmKt9; r7Ruh: PJWyd: goto zb5QN; Bu8jw: jvSK_: goto nNp5Y; TXRzp: foreach ($menus as &$value) { goto nXMD1; KYew0: if (empty($submenus)) { goto FugF3; } goto u43El; xAlho: $value['sys'] = $j; goto muNCc; fk_Bm: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto i6RYX; YGcqA: b_OOy: goto c_gXy; M34Q4: $value['submenus'] = $submenus; goto xAlho; u43El: foreach ($submenus as &$item) { goto OfSiX; ZeJY7: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto WFkQ1; PxF40: $item['prg'] = $i; goto WJYOx; BLD5M: if (!$rights) { goto twyR4; } goto pnroO; tWPr9: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto adQpO; pnroO: $item['rights'] = $rights; goto ch4aW; M1xn2: foreach ($rights as $key) { goto BuJQX; PF0gA: rxju0: goto NIwrg; BuJQX: if (!($key == 1)) { goto jcMyC; } goto At6Fd; At6Fd: $i = 1; goto ZUIa3; ZUIa3: goto Ewaor; goto Dqyat; Dqyat: jcMyC: goto PF0gA; NIwrg: } goto oNI92; WFkQ1: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $gid, ":pid" => $item['id'])); goto BLD5M; kvaOi: twyR4: goto H5WmT; ch4aW: $i = 0; goto M1xn2; WJYOx: $j = $i; goto kvaOi; OfSiX: if (!(!empty($item['op']) && !empty($item['do']))) { goto wf2go; } goto tWPr9; H5WmT: vtfTz: goto mCzJI; adQpO: wf2go: goto ZeJY7; oNI92: Ewaor: goto PxF40; mCzJI: } goto kad4f; i6RYX: $j = 0; goto KYew0; muNCc: FugF3: goto YGcqA; nXMD1: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc,displayorder asc'; goto fk_Bm; kad4f: MAyhT: goto M34Q4; c_gXy: } goto Z70wd; Lt6YM: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto pYGHP; R0CwI: CaEAs: goto ZmaE5; HN9yM: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto cTslX; OQzJN: foreach ($menus as &$value) { goto SKQLi; rX9yf: if (empty($submenus)) { goto GARWv; } goto UPs8d; em4Yp: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto YhmaD; YhmaD: $j = 0; goto rX9yf; Djv2u: $value['submenus'] = $submenus; goto e3mpv; cNofA: usdJO: goto a018K; SKQLi: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 order by isdisplay desc ,displayorder asc'; goto em4Yp; Q7Mq_: GARWv: goto cNofA; FuvyA: EykjO: goto Djv2u; UPs8d: foreach ($submenus as &$item) { goto OFy7D; L2n0k: $i = 0; goto P87G5; x_VOm: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto V2ZYm; P87G5: foreach ($rights as $key) { goto Mo6mP; dERNL: goto xb6tf; goto DJN2i; Mo6mP: if (!($key == 1)) { goto ouZOm; } goto it21j; BtoS_: L28qQ: goto U0Neh; it21j: $i = 1; goto dERNL; DJN2i: ouZOm: goto BtoS_; U0Neh: } goto tIOWp; V2ZYm: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $gid, ":pid" => $item['id'])); goto cIk78; D3zwo: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto Os7QM; tPqqb: $item['rights'] = $rights; goto L2n0k; cIk78: if (!$rights) { goto CG_Jo; } goto tPqqb; tIOWp: xb6tf: goto yyVcZ; yyVcZ: $item['prg'] = $i; goto Ba950; Ba950: $j = $i; goto Fa2im; hRF3F: B2k_w: goto CuYqV; Os7QM: NIsjS: goto x_VOm; OFy7D: if (!(!empty($item['op']) && !empty($item['do']))) { goto NIsjS; } goto D3zwo; Fa2im: CG_Jo: goto hRF3F; CuYqV: } goto FuvyA; e3mpv: $value['sys'] = $j; goto Q7Mq_; a018K: } goto SYhr4; SBC4z: cwEoD: goto L4QzJ; aHNpT: if (empty($menus)) { goto fff_M; } goto TXRzp; QKHx6: if (empty($menus)) { goto HLYd7; } goto Ws4fD; XZUxa: goto yFngY; goto PGD1F; htSrU: SP83j: goto XZUxa; uApZ9: if ($user['gid'] == 0) { goto QlAeD; } goto KNru3; tqFBj: foreach ($menus as &$value) { goto n5veX; uuZcx: YJTxg: goto VoO6W; Y32oi: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto R3RiN; VoO6W: $value['submenus'] = $submenus; goto l8KLZ; jDQ4o: L_jDu: goto vahGo; www2t: if (empty($submenus)) { goto EWT1x; } goto m2Hmn; l8KLZ: $value['sys'] = $j; goto UKvJH; R3RiN: $j = 0; goto www2t; m2Hmn: foreach ($submenus as &$item) { goto g4C81; jYafr: Op8Qf: goto uLCmM; kkfLo: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto jYafr; m3wxe: $item['prg'] = $i; goto J3q2R; uLCmM: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto nz8cM; g4C81: if (!(!empty($item['op']) && !empty($item['do']))) { goto Op8Qf; } goto kkfLo; PsEFg: foreach ($rights as $key) { goto cz_a9; eggI9: BtACo: goto quEWk; quEWk: dZif5: goto UA84t; FyWRo: goto Y4dhK; goto eggI9; cz_a9: if (!($key == 1)) { goto BtACo; } goto C9qlV; C9qlV: $i = 1; goto FyWRo; UA84t: } goto Z4B6W; lTk_Z: YmjeZ: goto AzaA6; W2Jb4: Je38X: goto lTk_Z; nz8cM: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $gid, ":pid" => $item['id'])); goto zLGxx; zLGxx: if (!$rights) { goto Je38X; } goto yAwGq; Z4B6W: Y4dhK: goto m3wxe; J3q2R: $j = $i; goto W2Jb4; yAwGq: $item['rights'] = $rights; goto sCxs7; sCxs7: $i = 0; goto PsEFg; AzaA6: } goto uuZcx; n5veX: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 order by isdisplay desc,displayorder asc'; goto Y32oi; UKvJH: EWT1x: goto jDQ4o; vahGo: } goto jQ7uv; mmKt9: if (empty($menus)) { goto MhOGI; } goto tu_vY; Ws4fD: foreach ($menus as &$value) { goto ZQ85O; rx8Fb: if (empty($submenus)) { goto KnXfB; } goto lXoiA; lXoiA: foreach ($submenus as &$item) { goto beYsE; beYsE: if (!(!empty($item['op']) && !empty($item['do']))) { goto vBqdW; } goto bkJE4; UNx0V: vBqdW: goto Xo4Di; Q4bkx: foreach ($rights as $key) { goto qST9D; fXHk7: $i = 1; goto DPXgm; zU_6N: nWZxs: goto nw_e2; qST9D: if (!($key == 1)) { goto Dhyuq; } goto fXHk7; mjSsO: Dhyuq: goto zU_6N; DPXgm: goto xZTMM; goto mjSsO; nw_e2: } goto HGeOG; PHFLW: $item['prg'] = $i; goto ggYpT; Ug1Up: $item['rights'] = $rights; goto ewxAr; ewxAr: $i = 0; goto Q4bkx; z9WNx: if (!$rights) { goto W7Ay9; } goto Ug1Up; Ltgvn: W7Ay9: goto CWpnM; N6qX1: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $gid, ":pid" => $item['id'])); goto z9WNx; CWpnM: MC1Pr: goto r4FYg; Xo4Di: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto N6qX1; HGeOG: xZTMM: goto PHFLW; bkJE4: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto UNx0V; ggYpT: $j = $i; goto Ltgvn; r4FYg: } goto Q3wKE; HSfFQ: $j = 0; goto rx8Fb; ZQ85O: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 and p.id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto atDTb; fjng1: $value['submenus'] = $submenus; goto o0hBf; kdKzs: KnXfB: goto aqh7t; o0hBf: $value['sys'] = $j; goto kdKzs; aqh7t: CYXhI: goto V6PiR; Q3wKE: xUFHm: goto fjng1; atDTb: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto HSfFQ; V6PiR: } goto bXm7n; lYCHE: if (empty($menus)) { goto PJWyd; } goto tqFBj; YFX44: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto dAneC; n3pDC: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto QKHx6; Tpcjy: tMYrC: goto tyMtJ; dAneC: $user = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $_W['uid'])); goto jCMGr; tyMtJ: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto ygg9y; xn3WR: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto Qvrqg; WuqUm: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $user['gid'] . ' and weid =' . $_W['uniacid'] . ') and isdisplay = :isdisplay order by displayorder'; goto U1rp3; Np1Ea: bFc9G: goto OE_lJ; IY8Bv: DyUmR: goto Vp71_; PBrdU: $user = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $_W['uid'])); goto uP1MO; e6KnE: a3i_x: goto MDbJ7; GCotQ: n7S2_: goto OAs5r; iprqR: t2MeS: goto MoiGA; NxKU7: $secacc = pdo_fetch($sql, array(":weid" => $mywe['weid'])); goto KJZdl; QQYZp: goto gjXmP; goto iprqR; AFCC1: foreach ($menus as &$value) { goto kwKgA; dQq6J: ZtJop: goto q9O7D; u9teA: $value['sys'] = $j; goto py3gT; iCLW2: $j = 0; goto LRZQ0; LRZQ0: if (empty($submenus)) { goto wMory; } goto ERMxQ; kwKgA: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto rtlDN; qyA5q: Tqx8_: goto iTexf; rtlDN: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto iCLW2; py3gT: wMory: goto qyA5q; ERMxQ: foreach ($submenus as &$item) { goto H10AD; KWwnb: $j = $i; goto dF0cz; I1D_P: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto J2KRc; dF0cz: kLt8l: goto PlZs2; IdnWJ: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto Wy1Ev; H10AD: if (!(!empty($item['op']) && !empty($item['do']))) { goto I6POY; } goto I1D_P; PlZs2: Fx6VD: goto QDzJA; Sps6O: $i = 0; goto CgL6L; ZyV1A: eMX4P: goto PDFhI; rKoW1: if (!$rights) { goto kLt8l; } goto GJav0; J2KRc: I6POY: goto IdnWJ; GJav0: $item['rights'] = $rights; goto Sps6O; CgL6L: foreach ($rights as $key) { goto mP32E; mP32E: if (!($key == 1)) { goto ayjzz; } goto rgzIc; w6Suu: r3Us3: goto xjfZ9; oAHsB: goto eMX4P; goto CtLEw; rgzIc: $i = 1; goto oAHsB; CtLEw: ayjzz: goto w6Suu; xjfZ9: } goto ZyV1A; PDFhI: $item['prg'] = $i; goto KWwnb; Wy1Ev: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $gid, ":pid" => $item['id'])); goto rKoW1; QDzJA: } goto dQq6J; q9O7D: $value['submenus'] = $submenus; goto u9teA; iTexf: } goto R0CwI; iVZVl: foreach ($menus as &$value) { goto ZloLJ; VIzQq: $j = 0; goto PwX9b; PwX9b: if (empty($submenus)) { goto p6g2q; } goto SNByO; ZloLJ: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.issys = 0 and p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 and p.id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto D3_1D; YGQQu: p6g2q: goto kCUSc; gBVJE: wFwIT: goto QN1Oy; BmAxB: $value['sys'] = $j; goto YGQQu; SNByO: foreach ($submenus as &$item) { goto Efzb9; VZYwj: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto TNchA; zc8bb: $j = $i; goto cLJPC; cLJPC: AU91B: goto Wb3si; GfwvE: CbmY4: goto PU6iJ; uYEGU: Bb6Q3: goto VZYwj; TNchA: $rights = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":gid" => $gid, ":pid" => $item['id'])); goto BNp46; PU6iJ: $item['prg'] = $i; goto zc8bb; PnqFG: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto uYEGU; Wb3si: LwNsn: goto lOOMk; YU8uT: foreach ($rights as $key) { goto LGWwl; LGWwl: if (!($key == 1)) { goto vTs2u; } goto LJOPZ; NCpvC: goto CbmY4; goto UP0mR; UP0mR: vTs2u: goto Uw5iW; LJOPZ: $i = 1; goto NCpvC; Uw5iW: hlA9i: goto jYzdR; jYzdR: } goto GfwvE; BNp46: if (!$rights) { goto AU91B; } goto Y5U5o; Efzb9: if (!(!empty($item['op']) && !empty($item['do']))) { goto Bb6Q3; } goto PnqFG; XBD7d: $i = 0; goto YU8uT; Y5U5o: $item['rights'] = $rights; goto XBD7d; lOOMk: } goto gBVJE; QN1Oy: $value['submenus'] = $submenus; goto BmAxB; kCUSc: HAicG: goto bRcaX; D3_1D: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto VIzQq; bRcaX: } goto e6KnE; jQ7uv: cqmL8: goto r7Ruh; Vp71_: tAqgL: goto ZfRUC; SYhr4: F9wlY: goto htSrU; yF1be: goto yjh5y; goto AN5bq; dnStz: pFQ7K: goto Np1Ea; VFnhh: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto JdETT; JSrCw: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $gid . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 order by displayorder'; goto cVpJx; NSR6M: goto yNoys; goto Tpcjy; KJZdl: if (!empty($secacc)) { goto cwEoD; } goto PiMiv; Xre0I: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where id in (select sid from ' . tablename('rhinfo_zyxq_secgsys') . ' where gid = ' . $gid . ' and weid =' . $mywe['weid'] . ') and isdisplay = :isdisplay and issys=0 and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto Lt6YM; lo9fA: MhOGI: goto OD_83; kwoEP: oQyGT: goto PAp6O; MoiGA: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay and id in(select distinct sid from ' . tablename('rhinfo_zyxq_secasys') . ' where weid=' . $mywe['weid'] . ') order by displayorder'; goto Qvi0J; CMCPJ: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto PBrdU; j_Cv4: heqky: goto Bu8jw; uVwBI: goto DyUmR; goto Vqz2y; EYF3U: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto P9R4C; gMBXm: goto VbMwO; goto WcX5u; L4QzJ: if (!empty($_W['uid'])) { goto Dxyb0; } goto wlIEl; PWrWt: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto lYCHE; wlIEl: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto nC8ar; rWtNJ: $mywe = $this->mywe; goto xfB5K; PiMiv: if (!empty($_W['uid'])) { goto jEA10; } goto mm_lX; bXm7n: Nk8IN: goto YpBNQ; YpBNQ: HLYd7: goto gMBXm; zb5QN: yjh5y: goto kwoEP; pYGHP: if (empty($menus)) { goto GUbGp; } goto iVZVl; GTnrs: if (empty($menus)) { goto Pwqva; } goto AFCC1; PGD1F: iID2B: goto x66BI; es7by: fWJc2: goto ux9xx; wobYu: foreach ($menus as &$value) { goto AYZ_g; WnbH4: WEzgo: goto B7eBb; AYZ_g: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and issys=0 and isdismenu=1 and id in(select distinct pid from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid=' . $mywe['weid'] . ') order by isdisplay desc ,displayorder asc'; goto zmlnC; R6kjI: if (empty($submenus)) { goto WEzgo; } goto OfGtS; DtNsT: $value['submenus'] = $submenus; goto xsYIp; B7eBb: oBzJn: goto PLaAW; rSMuD: CgLa3: goto DtNsT; xsYIp: $value['sys'] = $j; goto WnbH4; vHiCk: $j = 0; goto R6kjI; OfGtS: foreach ($submenus as &$item) { goto wYQqN; cJGSG: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto rZ95H; RCNbd: yFXFX: goto RgQ4T; A0FEx: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto ZvyCT; Q3JP1: if (!$rights) { goto yFXFX; } goto B_wAH; wYQqN: if (!(!empty($item['op']) && !empty($item['do']))) { goto gIaR3; } goto A0FEx; PI7tQ: $i = 0; goto mIKZv; vq4sI: Eabf2: goto NIKZF; NIKZF: $item['prg'] = $i; goto C70RR; C70RR: $j = $i; goto RCNbd; mIKZv: foreach ($rights as $key) { goto XnLI8; AxEhG: XHvWY: goto M81pM; mkfw6: goto Eabf2; goto AxEhG; M81pM: ZVrdR: goto s3Vpv; XnLI8: if (!($key == 1)) { goto XHvWY; } goto CTcZf; CTcZf: $i = 1; goto mkfw6; s3Vpv: } goto vq4sI; ZvyCT: gIaR3: goto cJGSG; B_wAH: $item['rights'] = $rights; goto PI7tQ; RgQ4T: IfS3x: goto v9_59; rZ95H: $rights = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":gid" => $gid, ":pid" => $item['id'])); goto Q3JP1; v9_59: } goto rSMuD; zmlnC: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto vHiCk; PLaAW: } goto j_Cv4; nNp5Y: yNoys: goto uVwBI; tu_vY: foreach ($menus as &$value) { goto XxdF2; VDEaV: mtN6q: goto qrboj; wO9op: ww6QP: goto nisqK; qrboj: $value['submenus'] = $submenus; goto uLOon; uLOon: $value['sys'] = $j; goto MxZUg; XxdF2: $sql = 'select p.id,p.title,p.sid,p.do,p.op,p.name1,p.name2,p.name3,p.name4,p.name5,g.add,g.edit,g.delete,g.export,g.query,g.view,g.print,g.enabled,g.audit,g.other1,g.other2,g.other3,g.other4,g.other5 from ' . tablename('rhinfo_zyxq_secprg') . ' as p left join ' . tablename('rhinfo_zyxq_secgprg') . ' as g on p.id = g.pid  where p.issys = 0 and p.sid = :sid and g.weid=:weid and g.gid=:gid and g.sid=:sid and p.isdismenu=1 order by isdisplay desc ,displayorder asc'; goto vDiUm; HEy2i: if (empty($submenus)) { goto lDZBa; } goto cZraK; MxZUg: lDZBa: goto wO9op; vDiUm: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'], ":weid" => $mywe['weid'], ":gid" => $user['gid'])); goto G3zQc; G3zQc: $j = 0; goto HEy2i; cZraK: foreach ($submenus as &$item) { goto vZBfo; mF8Tz: $i = 0; goto c544s; lisGw: S4bc1: goto f1Saz; bgTgH: $j = $i; goto xBGp0; ZNTzq: $item['rights'] = $rights; goto mF8Tz; vZBfo: if (!(!empty($item['op']) && !empty($item['do']))) { goto S4bc1; } goto o5BVa; c544s: foreach ($rights as $key) { goto vni3F; vni3F: if (!($key == 1)) { goto YRpH7; } goto wCooj; KLhC4: goto EtMpG; goto T4IwH; wCooj: $i = 1; goto KLhC4; uKw0z: YQDbX: goto wUt1P; T4IwH: YRpH7: goto uKw0z; wUt1P: } goto ekf_u; o5BVa: $item['url'] = $this->createWeburl($item['do'], array("op" => $item['op'])); goto lisGw; bm2SR: if (!$rights) { goto HrOh9; } goto ZNTzq; xBGp0: HrOh9: goto Ngx5G; kqHoi: $rights = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":gid" => $gid, ":pid" => $item['id'])); goto bm2SR; pQK8n: $item['prg'] = $i; goto bgTgH; Ngx5G: Ry2Sg: goto SSO3o; ekf_u: EtMpG: goto pQK8n; f1Saz: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto kqHoi; SSO3o: } goto VDEaV; nisqK: } goto kfl_J; ttH1b: nZ1Nb: goto es7by; UnGzT: if ($user['gid'] == 0) { goto iID2B; } goto WuqUm; StjYn: jEA10: goto YFX44; PAp6O: goto tAqgL; goto SBC4z; ZRB0q: VbMwO: goto QQYZp; mm_lX: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto EYF3U; eqnD5: if ($user['gid'] == 0) { goto tMYrC; } goto Xre0I; kfl_J: M3H20: goto lo9fA; MDbJ7: GUbGp: goto NSR6M; POdl6: fff_M: goto chWXX; cTslX: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto GTnrs; U1rp3: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto RgzgI; XQD7D: goto oQyGT; goto StjYn; OE_lJ: Jsqkk: goto XQD7D; Qvi0J: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto aHNpT; P9R4C: if ($user['gid'] == 0) { goto n7S2_; } goto JSrCw; EvH06: if (empty($menus)) { goto jvSK_; } goto wobYu; chWXX: gjXmP: goto IY8Bv; tXtDm: } public function myrights($sid, $do, $op) { goto iQs4J; GSUJM: $sql = 'select gid from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and id = :uid'; goto w1AWb; XkZT1: $mywe = $this->mywe; goto qjQcd; N7681: if ($user['gid'] == 0) { goto kAhUP; } goto Bm0Il; YAtar: hcH9V: goto aCPiK; br6uD: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto kCV1v; w1AWb: $user = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":uid" => $mywe['uid'])); goto u4paY; Bm0Il: $sql = 'SELECT id FROM ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and do = :do and  op = :op'; goto cY8Me; EytHi: return $rights; goto AT0h2; wCv_0: $user = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $_W['uid'])); goto w1oQB; MzPLn: $rights = pdo_fetch($sql, array(":sid" => $sid, ":do" => $do, ":op" => $op)); goto PEuLO; wYl9k: $rights = pdo_fetch($sql, array(":sid" => $sid, ":do" => $do, ":op" => $op)); goto cCeEM; Lpppg: $rights = pdo_fetch($sql, array(":sid" => $sid, ":do" => $do, ":op" => $op)); goto CpKkD; QKekT: goto LhLnu; goto YAtar; u4paY: if ($user['gid'] == 0) { goto VomVE; } goto tA5wN; CTb2a: $sql = 'select * from ' . tablename('rhinfo_zyxq_secgprg') . ' where weid = :weid and gid = :gid and pid = :pid'; goto OMFGr; tOfZq: VomVE: goto eT2mV; eT2mV: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where issys = 0 and sid = :sid and do = :do and  op = :op and issys=0'; goto wYl9k; OMFGr: $rights = pdo_fetch($sql, array(":weid" => $mywe['weid'], ":gid" => $user['gid'], ":pid" => $pid)); goto w9Fk6; HYjTa: qJGn0: goto UrezV; CpKkD: EolQL: goto QKekT; zzxkB: goto h9OpE; goto HYjTa; qjQcd: if (!empty($_W['uid'])) { goto qJGn0; } goto GSUJM; iQs4J: global $_W, $_GPC; goto XkZT1; cCeEM: xOYel: goto zzxkB; kCV1v: $rights = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":gid" => $user['gid'], ":pid" => $pid)); goto yJcpQ; s7zrN: h9OpE: goto EytHi; w9Fk6: goto xOYel; goto tOfZq; tA5wN: $sql = 'SELECT id FROM ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and do = :do and  op = :op and issys=0'; goto gHCP7; yJcpQ: goto EolQL; goto HJmjj; UrezV: $sql = 'select gid from ' . tablename('rhinfo_zyxq_secuser') . ' where weid = :weid and uid = :uid'; goto wCv_0; PEuLO: LhLnu: goto s7zrN; HJmjj: kAhUP: goto XnZov; w1oQB: if ($_W['isfounder']) { goto hcH9V; } goto N7681; aCPiK: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and do = :do and  op = :op'; goto MzPLn; gHCP7: $pid = pdo_fetchcolumn($sql, array(":sid" => $sid, ":do" => $do, ":op" => $op)); goto CTb2a; cY8Me: $pid = pdo_fetchcolumn($sql, array(":sid" => $sid, ":do" => $do, ":op" => $op)); goto br6uD; XnZov: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and do = :do and  op = :op'; goto Lpppg; AT0h2: } public function mywebmsg($caption, $msg, $redirect = "", $label) { include $this->template('web/_message'); exit; } public function mywebmsg1($caption, $msg, $redirect = "", $label) { include $this->template('web/_message1'); exit; } public function createqrcode($url) { goto jiTgI; IJpVQ: K8Zs9: goto Vm3ih; jiTgI: global $_W; goto UuO_2; UuO_2: $path = IA_ROOT . '/addons/rhinfo_zyxq/data/qrcode/' . $_W['uniacid'] . '/'; goto ok0Jc; I_62F: QRcode::png($url, $qrcode_file, QR_ECLEVEL_L, 10); goto IJpVQ; kntbX: require_once IA_ROOT . '/framework/library/qrcode/phpqrcode.php'; goto I_62F; kU4d_: yQ2nc: goto vdh7B; TqJ20: mkdirs($path); goto kU4d_; XEwL8: load()->func('file'); goto TqJ20; ok0Jc: if (is_dir($path)) { goto yQ2nc; } goto XEwL8; swfkm: if (is_file($qrcode_file)) { goto K8Zs9; } goto kntbX; UhDVq: $qrcode_file = $path . $file; goto swfkm; Vm3ih: return $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/data/qrcode/' . $_W['uniacid'] . '/' . $file; goto tu9sS; vdh7B: $file = md5(base64_encode($url)) . '.jpg'; goto UhDVq; tu9sS: } public function mytpl($filename) { goto yu59K; FppSk: return $filename; goto DRJd3; yu59K: global $_W, $_GPC; goto NRJKv; KuC4S: goto aM5Rs; goto yz2YB; dzDSK: Qdauc: goto FppSk; LUyDB: $path = '/template/mobile/' . $this->syscfg['style'] . '/' . $filename; goto T0OA1; K993X: if (!is_file($source)) { goto MDuck; } goto CPf7P; NRJKv: if (!empty($this->syscfg['style'])) { goto LFW7X; } goto DeZun; DeZun: $filename = 'default/' . $filename; goto A2QIu; yz2YB: MDuck: goto QVpMr; CPf7P: $filename = $this->syscfg['style'] . '/' . $filename; goto KuC4S; A2QIu: goto Qdauc; goto MpXY1; T0OA1: $source = MODULE_ROOT . $path . '.html'; goto K993X; b2jDL: aM5Rs: goto dzDSK; QVpMr: $filename = 'default/' . $filename; goto b2jDL; MpXY1: LFW7X: goto LUyDB; DRJd3: } public function mywtpl($filename = "") { goto wi0WZ; Bd1Ta: if (!empty($this->syscfg['adminstyle'])) { goto DN1PP; } goto JCzOx; JCzOx: $filename = 'web/' . $_GPC['do'] . '/' . $filename; goto dr_Gc; IaBqb: $path = '/template/' . $this->syscfg['adminstyle'] . '/' . $_GPC['do'] . '/' . $filename; goto EdS25; qaKSI: $filename = 'web/' . $_GPC['do'] . '/' . $filename; goto Z3LLa; Z3LLa: aXsU6: goto LR9PG; ClF8U: DN1PP: goto IaBqb; wi0WZ: global $_W, $_GPC; goto dJPCO; NOumU: return $this->template($filename); goto bJPtI; bzS73: $filename = $this->syscfg['adminstyle'] . '/' . $_GPC['do'] . '/' . $filename; goto g0L25; g0L25: goto aXsU6; goto B8RtQ; tVHXY: if (!is_file($source)) { goto PCORT; } goto bzS73; LR9PG: VAFOS: goto NOumU; dr_Gc: goto VAFOS; goto ClF8U; dJPCO: $filename = empty($filename) ? $_GPC['op'] : $filename; goto qzzaK; qzzaK: $filename = empty($filename) ? 'index' : $filename; goto Bd1Ta; B8RtQ: PCORT: goto qaKSI; EdS25: $source = MODULE_ROOT . $path . '.html'; goto tVHXY; bJPtI: } public function mymtpl($filename = "") { goto Jo7gA; dUrag: Z0ig5: goto xOjrH; FiizF: if (!is_file($source)) { goto r7QSM; } goto af7Kx; kbiU6: iGpVu: goto YKm_T; MTkL6: uwwBd: goto XRiGt; LCbJb: UxKsJ: goto IkWq7; v1aAz: goto iGpVu; goto j13dh; qQF0U: Q08fU: goto HvcbP; CBXAh: if ($this->rhinfo_wap) { goto jKohl; } goto yri28; T4vHh: IyLtq: goto GH4vj; K2gcj: $source = MODULE_ROOT . $path . '.html'; goto FdazY; j3Ag1: $filename = empty($filename) ? $_GPC['op'] : $filename; goto W2VaF; lRZKu: return $this->template($filename); goto K9A6a; OWUfx: $filename = $this->syscfg['style'] . '/' . $_GPC['do'] . '/' . $filename; goto hvKmV; RPhXm: goto MEstk; goto T4vHh; amP1B: $filename = $this->syscfg['style'] . '/' . $_GPC['do'] . '/' . $filename; goto I83BC; Jo7gA: global $_W, $_GPC; goto j3Ag1; BRUlu: if (!empty($this->syscfg['style'])) { goto IyLtq; } goto CBXAh; gRNr_: $path = '/template/mobile/' . $this->syscfg['style'] . '/' . $_GPC['do'] . '/' . $filename; goto Ool8I; H7W4T: r7QSM: goto IjRaI; bjOC_: goto UxKsJ; goto H7W4T; xOjrH: goto tZ1Sp; goto L3W4W; IkqGG: $filename = $this->syscfg['style'] . '/wap/' . $_GPC['do'] . '/' . $filename; goto kbiU6; ub8_h: $wapsource = MODULE_ROOT . $path . '.html'; goto LxB7Q; W2VaF: $filename = empty($filename) ? 'index' : $filename; goto BRUlu; GH4vj: if ($this->rhinfo_wap) { goto h0rVO; } goto gRNr_; LxB7Q: if (is_file($wapsource)) { goto rEBMs; } goto GWrLY; gxR3L: $filename = 'default/wap/' . $_GPC['do'] . '/' . $filename; goto Uq60r; cwhql: if (is_file($wapsource)) { goto DLk56; } goto iHv9w; Uq60r: SOqt5: goto v1aAz; Ejc9H: $source = MODULE_ROOT . $path . '.html'; goto FiizF; XRiGt: $filename = 'default/' . $_GPC['do'] . '/' . $filename; goto dUrag; HWDae: if (!is_file($source)) { goto uwwBd; } goto amP1B; WD8_i: $wapsource = MODULE_ROOT . $path . '.html'; goto cwhql; Fka8k: jKohl: goto ZwhY_; lcIgl: DLk56: goto gxR3L; j13dh: rEBMs: goto IkqGG; L3W4W: h0rVO: goto eqOci; IkWq7: v2819: goto RPhXm; yri28: $filename = 'default/' . $_GPC['do'] . '/' . $filename; goto cPSmf; OIb77: nI8ps: goto J03VV; IjRaI: $filename = 'default/' . $_GPC['do'] . '/' . $filename; goto LCbJb; ZwhY_: $path = '/template/mobile/default/wap/' . $_GPC['do'] . '/' . $filename; goto Ejc9H; HvcbP: goto SOqt5; goto lcIgl; GWrLY: $path = '/template/mobile/default/wap/' . $_GPC['do'] . '/' . $filename; goto WD8_i; iHv9w: $path = '/template/mobile/' . $this->syscfg['style'] . '/' . $_GPC['do'] . '/' . $filename; goto K2gcj; FdazY: if (!is_file($source)) { goto nI8ps; } goto OWUfx; eqOci: $path = '/template/mobile/' . $this->syscfg['style'] . '/wap/' . $_GPC['do'] . '/' . $filename; goto ub8_h; J03VV: $filename = 'default/' . $_GPC['do'] . '/' . $filename; goto qQF0U; HWKHV: MEstk: goto lRZKu; af7Kx: $filename = 'default/wap/' . $_GPC['do'] . '/' . $filename; goto bjOC_; Ool8I: $source = MODULE_ROOT . $path . '.html'; goto HWDae; hvKmV: goto Q08fU; goto OIb77; cPSmf: goto v2819; goto Fka8k; I83BC: goto Z0ig5; goto MTkL6; YKm_T: tZ1Sp: goto HWKHV; K9A6a: } public function getarrearage($openid) { goto mBAQY; mBAQY: global $_W; goto fPD1X; Lzvmu: if ($days > 0) { goto eYSvi; } goto KAQaY; RPs44: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto MzEjX; m2bdB: $days = intval($timediff / 86400); goto Lzvmu; MzEjX: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'])); goto EBL_9; C4WX7: gUzpi: goto RPs44; fPD1X: $info = array(); goto KWKR2; A8e4h: return $region; goto y2ch0; KWKR2: $info = $this->getmyinfo($openid); goto hF5YA; KAQaY: return false; goto fdygG; ytJkz: $arrearagedate = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'], ":rid" => $info['rid'], ":bid" => $info['bid'], ":tid" => $info['tid'], ":hid" => $info['hid'])); goto l2oN1; hF5YA: $sql = 'select min(startdate) from ' . tablename('rhinfo_zyxq_feebill') . ' where weid=:weid and rid=:rid and bid=:bid and tid=:tid and hid=:hid and status=1'; goto ytJkz; XPn23: $timediff = $currentdate - $arrearagedate; goto m2bdB; ZgqRH: eYSvi: goto A8e4h; fdygG: goto oaw2Q; goto ZgqRH; N5n2C: return false; goto C4WX7; EBL_9: $str = $region['arrearagemonths'] ? 'now -' . $region['arrearagemonths'] . 'months' : 'now -1days'; goto fkkDt; fkkDt: $currentdate = strtotime($str); goto XPn23; l2oN1: if (!empty($arrearagedate)) { goto gUzpi; } goto N5n2C; y2ch0: oaw2Q: goto LNefe; LNefe: } public function getBoard($bid = 0, $pid = 0, $rid = 0) { global $_W; return pdo_fetch('select * from ' . tablename('rhinfo_zyxq_sns_board') . ' where weid=:weid and id=:id and (pid=:pid or pid=0) and (rid=:rid or rid=0)  limit 1', array(":weid" => $_W['uniacid'], ":id" => $bid, ":pid" => $pid, ":rid" => $rid)); } public function isManager($pid = 0, $rid = 0, $bid = 0, $openid = "") { goto wFNat; wFNat: global $_W; goto vUauD; Zuj5S: dOrPh: goto kANvI; dKXId: $openid = $_W['openid']; goto Zuj5S; kANvI: $count = pdo_fetchcolumn('select count(*)  from ' . tablename('rhinfo_zyxq_sns_manager') . ' where weid=:weid and (pid=:pid or pid=0) and (rid=:rid or rid=0) and bid=:bid and openid=:openid limit 1', array(":weid" => $_W['uniacid'], ":pid" => $pid, ":rid" => $rid, ":bid" => $bid, ":openid" => $openid)); goto MaizT; vUauD: if (!empty($openid)) { goto dOrPh; } goto dKXId; MaizT: return 0 < $count; goto A3BsI; A3BsI: } public function isSuperManager($pid = 0, $rid = 0, $openid = "") { goto IqVz2; t_HBU: $openid = $_W['openid']; goto ixXof; VBNYJ: return 0 < $count; goto oT2uC; IqVz2: global $_W; goto AKMZk; nzovO: $count = pdo_fetchcolumn('select count(*)  from ' . tablename('rhinfo_zyxq_sns_manager') . ' where weid=:weid and (pid=:pid or pid=0) and (rid=:rid or rid=0) and bid=0 and openid=:openid limit 1', array(":weid" => $_W['uniacid'], ":pid" => $pid, ":rid" => $rid, ":openid" => $openid)); goto VBNYJ; ixXof: dDGaA: goto nzovO; AKMZk: if (!empty($openid)) { goto dDGaA; } goto t_HBU; oT2uC: } public function getPost($id = "0") { global $_W; return pdo_fetch('select * from ' . tablename('rhinfo_zyxq_sns_post') . ' where weid=:weid and id=:id  limit 1', array(":weid" => $_W['uniacid'], ":id" => $id)); } public function getPostCount($bid) { global $_W; return pdo_fetchcolumn('select count(*) from ' . tablename('rhinfo_zyxq_sns_post') . '
' . ' where weid=:weid and boardid=:bid and postid=0 and deleted = 0 limit 1', array(":weid" => $_W['uniacid'], ":bid" => $bid)); } public function getFollowCount($bid) { global $_W; return pdo_fetchcolumn('select count(*) from ' . tablename('rhinfo_zyxq_sns_board_follow') . '
' . ' where weid=:weid and bid=:bid limit 1', array(":weid" => $_W['uniacid'], ":bid" => $bid)); } public function isFollow($bid) { goto s481a; DG2jt: return 0 < $count; goto ihc9q; v6lOc: $count = pdo_fetchcolumn('select count(*) from ' . tablename('rhinfo_zyxq_sns_board_follow') . ' where weid=:weid and bid=:bid and openid=:openid limit 1', array(":weid" => $_W['uniacid'], ":bid" => $bid, ":openid" => $_W['openid'])); goto DG2jt; s481a: global $_W; goto v6lOc; ihc9q: } public function getTops($bid = 0) { goto uBkei; fBOel: J9Mdo: goto Zs2FC; Zs2FC: $condition .= ')'; goto jnh3Z; uBkei: global $_W; goto IbrFL; jnh3Z: return pdo_fetchall('select id,title,istop,isboardtop from ' . tablename('rhinfo_zyxq_sns_post') . ' where weid=:weid ' . $condition . ' and postid=0 and deleted=0  order by istop desc,replytime desc', array(":weid" => $_W['uniacid'])); goto G4NZ7; IbrFL: $condition = ' and ( istop=1'; goto J00GC; qDky9: $condition .= ' or (isboardtop=1 and boardid=' . intval($bid) . ')'; goto fBOel; J00GC: if (empty($bid)) { goto J9Mdo; } goto qDky9; G4NZ7: } public function rhinfo_share($title = "", $imgurl = "", $desc = "", $url = "") { goto PKLY9; YIooO: $share['desc'] = empty($desc) ? $this->syscfg['sharedesc'] : $desc; goto Lo8EZ; qBXAy: $share['link'] = $url; goto v0EWn; Lo8EZ: $share['desc'] = empty($desc) ? $_W['uniaccount']['description'] : $desc; goto qBXAy; sG9Rv: $share['imgUrl'] = empty($imgurl) ? MODULE_URL . 'static/mobile/images/icon.jpg' : $imgurl; goto YIooO; NrRnJ: $share['title'] = empty($title) ? $_W['uniaccount']['name'] : $title; goto KxE2X; PKLY9: global $_W; goto eLg1E; KxE2X: $share['imgUrl'] = empty($imgurl) ? tomedia($this->syscfg['shareicon']) : $imgurl; goto sG9Rv; VYndS: $share['title'] = empty($title) ? $this->syscfg['sharetitle'] : $title; goto NrRnJ; eLg1E: $share = array(); goto VYndS; v0EWn: return $share; goto AeFj4; AeFj4: } public function check_snsmember($pid, $rid) { goto uUKEX; uUKEX: global $_W; goto Akk83; lcdag: if (!empty($member)) { goto C0fir; } goto eCf0O; Akk83: $member = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_sns_member') . ' where weid=:weid and pid=:pid and rid=:rid and openid=:openid limit 1', array(":weid" => $_W['uniacid'], ":pid" => $pid, ":rid" => $rid, ":openid" => $_W['openid'])); goto lcdag; wFFgW: if (empty($member['isblack'])) { goto bmWxG; } goto PbENq; VeDZv: C0fir: goto wFFgW; eCf0O: $member = array("weid" => $_W['uniacid'], "pid" => $pid, "rid" => $rid, "openid" => $_W['openid'], "createtime" => time()); goto KIfLb; KIfLb: pdo_insert('rhinfo_zyxq_sns_member', $member); goto c4A_N; A_Txm: bmWxG: goto F2tVh; c4A_N: return; goto VeDZv; PbENq: $this->mymsg('error', '错误', '禁止访问，请联系客服!', ''); goto A_Txm; F2tVh: } public function send_mycustextmsg($title, $info, $openid) { goto QISBh; VtvMc: if (!is_error($status)) { goto FiVxe; } goto fMUtI; ePLkS: v7Dus: goto ubw4l; G0lcJ: $message = array("msgtype" => "text", "text" => array("content" => urlencode($info)), "touser" => $openid); goto T9Ilh; fMUtI: return false; goto Z4Eli; TX01V: if (!($_W['account']['level'] >= ACCOUNT_SUBSCRIPTION_VERIFY)) { goto v7Dus; } goto pmGWo; Z4Eli: FiVxe: goto Uw19U; QISBh: global $_W; goto TX01V; T9Ilh: $account_api = WeAccount::create(); goto cIvws; cIvws: $status = $account_api->sendCustomNotice($message); goto VtvMc; ubw4l: return false; goto H2OzX; Uw19U: return true; goto ePLkS; pmGWo: $info .= "【{$_W['account']['name']}-" . $title . '】\\n'; goto G0lcJ; H2OzX: } public function send_mycusnewsmsg($title, $info, $url, $thumb_url, $openid) { goto E17oZ; ZDEHf: return false; goto qmxuc; cN7fG: $account_api = WeAccount::create(); goto A0K2Z; lOGab: $articles[0] = array("title" => urlencode($title), "description" => urlencode($info), "url" => $url, "picurl" => $thumb_url); goto YRjdC; YRjdC: $message = array("touser" => $openid, "msgtype" => "news", "news" => array("articles" => $articles)); goto cN7fG; A0K2Z: $res = $account_api->sendCustomNotice($message); goto NuA2p; KEf65: $articles = array(); goto lOGab; kupGE: return false; goto TXxxv; J5ciz: iN2QI: goto ZDEHf; XxON4: return true; goto J5ciz; E17oZ: global $_W; goto qdbmm; NuA2p: if (!is_error($res)) { goto kBHWF; } goto kupGE; qdbmm: if (!($_W['account']['level'] >= ACCOUNT_SUBSCRIPTION_VERIFY)) { goto iN2QI; } goto KEf65; TXxxv: kBHWF: goto XxON4; qmxuc: } public function send_mysendtplnotice($openid, $tplid, $postdata, $url, $topcolor) { goto BJgUm; avbZY: $data = array("touser" => $openid, "template_id" => $tplid, "url" => $url, "topcolor" => $topcolor, "data" => $postdata); goto POsmK; I7arZ: $res = ihttp_post($posturl, $json); goto SqQPB; POsmK: $json = json_encode($data); goto t0BOU; q_VYx: return true; goto cQdX5; NyaW_: if ($result['errcode'] == 0) { goto HGWvT; } goto WVhwn; K8psD: return error(-1, '发送失败'); goto JuWm2; WVhwn: $this->mysyslog(0, 'error', 'tpl', '模板消息发送' . $openid, '发送失败' . $result['errcode'] . ':' . $result['errmsg']); goto qtgxo; swC0m: goto GqP5U; goto Ozfmn; BOq54: if (!empty($tplid)) { goto cR_0C; } goto dnY9Y; t0BOU: $posturl = 'https://api.weixin.qq.com/cgi-bin/message/template/send?access_token=' . $access_token; goto I7arZ; ZlE7F: $access_token = $obj->fetch_available_token(); goto avbZY; lODfW: $obj = new WeiXinAccount(); goto ZlE7F; pX8I0: $result = json_decode($res['content'], 1); goto NyaW_; Pu7vV: load()->func('communication'); goto lODfW; dnY9Y: return error(-1, '发送失败:模板ID为空'); goto HXotx; BJgUm: global $_W, $_GPC; goto aMGX5; SqQPB: if ($res['code'] == 200 && $res['status'] == 'OK') { goto h6p1J; } goto jwGHZ; EIGCx: GqP5U: goto K8psD; HXotx: cR_0C: goto Fi5KP; aMGX5: if (!empty($openid)) { goto cUUNV; } goto Lx1X2; cQdX5: oO0ME: goto EIGCx; Ozfmn: h6p1J: goto pX8I0; xuRfy: cUUNV: goto BOq54; qtgxo: goto oO0ME; goto DAv4X; jwGHZ: $this->mysyslog(0, 'error', 'tpl', '模板消息发送' . $openid, '发送失败:异常错误'); goto swC0m; DAv4X: HGWvT: goto q_VYx; Lx1X2: return error(-1, '发送失败:OPENID为空'); goto xuRfy; Fi5KP: load()->classs('weixin.account'); goto Pu7vV; JuWm2: } public function myupload($uploadfile) { goto T0DOA; YiDAA: if (!($uploadfile['error'] != 0)) { goto pDUOZ; } goto SUAFg; UVwqa: pDUOZ: goto YL8ii; vUPHN: return $result; goto V965B; yHkHN: KvY6f: goto OyWy_; lBNNr: $result['message'] = $remote['message']; goto Ift2I; sdKTB: $file = file_upload($uploadfile, 'image'); goto xsA4K; u9236: if (empty($_W['setting']['remote']['type'])) { goto g8n1_; } goto fGnjS; fnnnQ: SL5kL: goto jUfVU; xsA4K: if (!is_error($file)) { goto KvY6f; } goto ecBt4; vgt8S: goto vKF1m; goto SM0_Y; T0DOA: global $_W, $_GPC; goto EeTNy; PzlBL: if (is_error($remotestatus)) { goto FV_3i; } goto MFI4w; kPBKK: return $result; goto MBkqK; Ift2I: return $result; goto fnnnQ; w8IeF: $target_file = IA_ROOT . '/attachment/' . $path . $filename; goto lkmTm; q15vR: $pathname = $path . $filename; goto jCtiR; tAnpG: $result['message'] = $remote['message']; goto vUPHN; oU_6b: return $result; goto yHkHN; BYMZZ: $ext = pathinfo($tmp_file, PATHINFO_EXTENSION); goto RFbpG; lkmTm: $imagesize = $this->syscfg['imagesize'] > 1024 ? 640 : $this->syscfg['imagesize']; goto khO9J; ajqOn: $result['status'] = 'success'; goto VsXT1; MjJnM: $tmp_file = IA_ROOT . '/attachment/' . $file['path']; goto BYMZZ; SM0_Y: FV_3i: goto tAnpG; l7RiB: $result['filename'] = $pathname; goto f8F_0; SUAFg: $result['message'] = '上传失败，请重试！'; goto Y6OsO; tqRTz: $path = 'images/' . intval($_W['uniacid']) . '/' . date('Y/m/'); goto JpqQg; V965B: vKF1m: goto zg2dt; MFI4w: $remoteurl = tomedia($pathname); goto tnZRz; EeTNy: $result['status'] = 'error'; goto YiDAA; khO9J: file_image_thumb($tmp_file, $target_file, $imagesize); goto zrgyS; ecBt4: $result['message'] = $file['message']; goto oU_6b; VsXT1: $result['error'] = 0; goto l7RiB; raiWZ: $filename = file_random_name(ATTACHMENT_ROOT . '/' . $path, $ext); goto w8IeF; f8F_0: $result['url'] = $fileurl; goto kPBKK; uH1tz: if (!is_error($remote)) { goto SL5kL; } goto lBNNr; jCtiR: $fileurl = trim($_W['attachurl'] . $pathname); goto u9236; aqDbQ: $remote = file_remote_upload($file['path']); goto uH1tz; Y6OsO: return $result; goto UVwqa; tnZRz: $fileurl = $remoteurl; goto vgt8S; jUfVU: kQTJH: goto MjJnM; fGnjS: $remotestatus = file_remote_upload($pathname); goto PzlBL; OyWy_: if (!function_exists('file_remote_upload')) { goto kQTJH; } goto aqDbQ; zg2dt: g8n1_: goto ajqOn; YL8ii: load()->func('file'); goto sdKTB; JpqQg: mkdirs(ATTACHMENT_ROOT . '/' . $path); goto raiWZ; RFbpG: $ext = strtolower($ext); goto tqRTz; zrgyS: unlink($tmp_file); goto q15vR; MBkqK: } public function mymsg($type, $title, $message, $redirect = "", $buttondisplay = 1, $buttontext = "确认") { goto oeCYR; g5E02: YsWAq: goto XAcc9; h5ALb: include $this->template($this->mytpl('_message')); goto YEt4T; BAdYy: goto vr3IT; goto ekgNN; oeCYR: if (empty($redirect)) { goto eaKbA; } goto S4yfp; NhXVh: $redirect = 'javascript:history.back(-1);'; goto BAdYy; QNUdF: goto vr3IT; goto ap9Gd; hCbg2: rArM9: goto OlGSP; vHx5F: goto YsWAq; goto hCbg2; YYSpE: $redirect = 'javascript:WeixinJSBridge.call("closeWindow")'; goto vHx5F; JZ_ax: $redirect = 'javascript:history.back(-1);'; goto G4HzM; S4yfp: if ($redirect == 'close') { goto XLSZ8; } goto QNUdF; jmPF1: if ($this->rhinfo_isalipay) { goto rArM9; } goto JZ_ax; h4xiJ: aq02_: goto YYSpE; OlGSP: $redirect = 'javascript:alipay_close()'; goto g5E02; G4HzM: goto YsWAq; goto h4xiJ; YEt4T: exit; goto dniJ7; ap9Gd: eaKbA: goto NhXVh; gqb3j: if ($this->rhinfo_isweixin) { goto aq02_; } goto jmPF1; ekgNN: XLSZ8: goto gqb3j; XAcc9: vr3IT: goto h5ALb; dniJ7: } public function send_sms($smstype, $mobile, $tpl_id, $data) { goto czBK6; XEmcA: $dayuResult = $dayuClient->execute($dayuRequest); goto Qwbeu; Ng1Y0: sdBvs: goto zttD8; EBuRt: $params = 'mobile=' . $mobile . '&tpl_id=' . $tpl_id . '&tpl_value=' . $params . '&key=' . $this->syscfg['appkey']; goto u1ndP; juwhd: NGXLx: goto tOWBI; LIhA9: date_default_timezone_set('Asia/Shanghai'); goto njdj7; qwkFA: return array("status" => 1, "message" => "发送失功"); goto WdjoC; tASoR: $paramstr = http_build_query(array("ParamString" => $params, "RecNum" => $mobile, "SignName" => $this->syscfg['alisignname'], "TemplateCode" => $tpl_id)); goto kA30P; L9vIg: o_A5p: goto HEPV2; czBK6: $params = sms_data($smstype, $data); goto seFNS; WdjoC: RXyUB: goto c5dYF; c5dYF: if (!($smstype == 4)) { goto KALlu; } goto LIhA9; XPxIB: KALlu: goto Fq43f; YhVa3: SUb4b: goto QBx1y; kA30P: $header = array("Authorization" => 'APPCODE ' . $this->syscfg['app_code']); goto RYKwR; zttD8: return array("status" => 0, "message" => '短信发送失败(错误信息: ' . $result['message'] . ')'); goto XytPr; pmgT2: $result = json_decode($request['content'], true); goto MTNOI; u1ndP: $url = 'http://v.juhe.cn/sms/send'; goto gkIHm; sgTM3: $result = ihttp_post($url, $params); goto KolzR; S2Dph: $dayuRequest->setSmsTemplateCode($tpl_id); goto XEmcA; bnSqS: if (!($request['code'] != 200)) { goto sdBvs; } goto ulMMi; P3kSc: if (!($res['Code'] != 'OK')) { goto o_A5p; } goto UvHJ5; ulMMi: $result['message'] = $request['headers']['X-Ca-Error-Message']; goto Ng1Y0; mz68L: return array("status" => 0, "message" => '短信发送失败(' . $result['error_code'] . ')：' . $result['reason']); goto Ii91Z; Ii91Z: UalWu: goto RRM7u; HEPV2: return array("status" => 1, "message" => "发送失功"); goto XPxIB; WsphJ: $res = json_decode(json_encode($response), 1); goto P3kSc; cL6i0: $dayuClient = new TopClient(); goto xuXmQ; zVNPI: $alisms = new SmsApi($this->syscfg['access_key_id'], $this->syscfg['access_key_secret']); goto q2Pyr; Qwbeu: $dayuResult = (array) $dayuResult; goto ud0cw; Ph3Hc: $dayuClient->secretKey = $this->syscfg['app_serve']; goto vNB37; RYKwR: $request = ihttp_request('http://sms.market.alicloudapi.com/singleSendSms?' . $paramstr, '', $header); goto pmgT2; kK6DR: $dayuRequest->setSmsParam($params); goto Z4zan; QBx1y: if (!($smstype == 3)) { goto RXyUB; } goto p4YRF; RRM7u: return array("status" => 1, "message" => "发送成功"); goto HOm47; HOm47: gMDG8: goto Bk02p; q2Pyr: $response = $alisms->sendSms($this->syscfg['aliaccsignname'], $tpl_id, $mobile, $data); goto WsphJ; seFNS: if (!($smstype == 1)) { goto gMDG8; } goto EBuRt; UvHJ5: return array("status" => 0, "message" => '短信发送失败(错误信息: ' . $res['Message'] . ')'); goto L9vIg; Bk02p: if (!($smstype == 2)) { goto SUb4b; } goto vIHsu; XytPr: KYKRr: goto qwkFA; KolzR: if (!(empty($result) || 0 < $result['error_code'])) { goto UalWu; } goto mz68L; p4YRF: load()->func('communication'); goto tASoR; Fq43f: return array("status" => 0, "message" => "没有设定短信验证"); goto o4Shv; yowPo: $dayuRequest->setSmsFreeSignName($this->syscfg['signname']); goto kK6DR; Z4zan: $dayuRequest->setRecNum('' . $mobile); goto S2Dph; MTNOI: if (!(!$result['success'] || $request['code'] != 200)) { goto KYKRr; } goto bnSqS; ypulI: set_time_limit(0); goto zVNPI; ud0cw: if (!(empty($dayuResult) || !empty($dayuResult['code']))) { goto NGXLx; } goto D57FU; fLllZ: $dayuRequest->setSmsType('normal'); goto yowPo; vNB37: $dayuRequest = new AlibabaAliqinFcSmsNumSendRequest(); goto fLllZ; vIHsu: include_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/dayu/TopSdk.php'; goto cL6i0; D57FU: return array("status" => 0, "message" => '短信发送失败(' . $dayuResult['sub_msg'] . '/code: ' . $dayuResult['code'] . '/sub_code: ' . $dayuResult['sub_code'] . ')'); goto juwhd; njdj7: require_once IA_ROOT . '/addons/rhinfo_zyxq/vendor/alisms/SmsApi.php'; goto ypulI; tOWBI: return array("status" => 1, "message" => "发送成功"); goto YhVa3; xuXmQ: $dayuClient->appkey = $this->syscfg['app_key']; goto Ph3Hc; gkIHm: load()->func('communication'); goto sgTM3; o4Shv: } public function opendoor($doortype, $locksn, $lockid) { goto KETjM; KePpq: xFuRL: goto mMPz8; tmXju: if ($rs[1] == 'OK') { goto xFuRL; } goto KZ2Bk; d8BB1: pbYj0: goto CJUui; HiLms: $res['code'] = '1'; goto Z6EYN; EqmT0: goto lp3df; goto bkC3C; x8G9x: $res['msg'] = '开门成功!'; goto jqdA0; RAYCX: $res['msg'] = '开门失败!' . $rs[1]; goto M7bIx; L6kyJ: if ($rs['state'] == '1' && $rs['state_code'] == '1') { goto EzUYI; } goto HiLms; MNSbe: goto pbYj0; goto Q7Phm; rdRuc: if ($doortype == 3) { goto Ii0uA; } goto ndfgA; RQrJV: $post_data = array("action" => "sendIns", "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid'], "pluse" => "0001", "device_code" => $locksn); goto vrpqc; uUrUN: EzUYI: goto B3r9J; Ph0r9: $post_data['command'] = '01'; goto jk0Fs; Z6EYN: $res['msg'] = '开门失败!' . $rs['state_msg']; goto PgpZh; MjCkT: return $res; goto d8BB1; Kx7fy: $res['code'] = '1'; goto AZN1N; YW9Zx: $res = Zr_httpPost($url, $post_data); goto tHAXr; jk0Fs: $post_data['lockid'] = $lockid; goto DMGNe; NvnX0: $post_data['sn'] = $locksn; goto YW9Zx; LM3WD: $rs = wmj_httpPost($url, $locksn); goto L6kyJ; tHAXr: return $res; goto p0T_C; VUhmm: GQciA: goto vbgmL; Q7Phm: Ii0uA: goto jbNcC; jbNcC: $url = 'openlock.html?appid=' . $this->syscfg['mj_apiid'] . '&appsecret=' . $this->syscfg['mj_apikey']; goto LM3WD; PgpZh: goto K1QnV; goto uUrUN; p0T_C: goto pbYj0; goto Ip5kI; mMPz8: $res['code'] = '0'; goto eEdWh; AZN1N: $res['msg'] = '开门失败!'; goto EqmT0; ndfgA: if ($doortype == 4) { goto GQciA; } goto twCTN; JYht5: if ($rs[0] == 'SUCCESS') { goto GUwe3; } goto Kx7fy; Ip5kI: aVHvk: goto amFNz; jqdA0: K1QnV: goto djfht; vbgmL: $url = 'AccessControl02/Api.php'; goto RQrJV; Ctb2b: lp3df: goto MjCkT; OGw8G: $post_data['token'] = $this->syscfg['apikey']; goto NvnX0; DMGNe: $res = Park_httpPost(1, $post_data); goto MvXu1; m9iQN: goto pbYj0; goto VUhmm; M7bIx: goto ljth3; goto KePpq; amFNz: $post_data['apikey'] = $this->syscfg['bl_apikey']; goto o_zdC; djfht: return $res; goto m9iQN; o_zdC: $post_data['deviceid'] = $locksn; goto Ph0r9; bkC3C: GUwe3: goto tmXju; eEdWh: $res['msg'] = '开门成功!'; goto QFGbn; vrpqc: $rs = Mx_httpPost($url, $post_data); goto JYht5; B3r9J: $res['code'] = '0'; goto x8G9x; KETjM: if ($doortype == 2) { goto aVHvk; } goto rdRuc; zyZ3j: $post_data['op'] = '1'; goto OGw8G; MvXu1: return $res; goto MNSbe; KZ2Bk: $res['code'] = '1'; goto RAYCX; QFGbn: ljth3: goto Ctb2b; twCTN: $url = 'lock.php'; goto zyZ3j; CJUui: } public function devstatus($doortype, $locksn) { goto tw7LD; M0gIs: goto J2x8p; goto Y_GO3; KGQq2: WpV37: goto MCFsV; SU4l4: $res['msg'] = '在线'; goto YJmAv; Y_GO3: Jb5H2: goto aSlhH; XX4PV: $res['code'] = '1'; goto zptSg; zMpxz: goto lnrmL; goto KGQq2; RRJ1_: if ($rs[0] == 'SUCCESS') { goto Jb5H2; } goto XX4PV; wAamE: $post_data = array("action" => "checkStas", "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid'], "device_code" => $locksn); goto t_s9h; Y6XPR: return $res; goto CgSiu; YJmAv: lnrmL: goto hFLwA; cUJHa: $rs = wmj_httpPost($url, $locksn); goto jqfsw; fccjD: $url = 'lock.php'; goto wESef; PBeFB: $res['msg'] = '在线'; goto ug0pn; DMerr: $res['code'] = '1'; goto tdJ0y; t_s9h: $rs = Mx_httpPost($url, $post_data); goto RRJ1_; KKWzn: jym74: goto zobvb; dAEos: if ($doortype == 4) { goto yvRvB; } goto fccjD; JLSY2: $res['code'] = '0'; goto PBeFB; o9c0v: if ($doortype == 3) { goto iKSWj; } goto dAEos; Dy_Xz: $post_data['token'] = $this->syscfg['apikey']; goto tuVP3; upyyp: $res['msg'] = '离线'; goto zPhgg; k7ycv: yvRvB: goto YKWPi; bWy7q: return $res; goto jkHfy; zPhgg: goto w6KMt; goto KKWzn; oS_ZN: $res = Park_httpPost(0, $post_data); goto Y6XPR; lt3zv: goto R5N3Q; goto vSojk; of0oU: gUIC3: goto QvUOH; cOBaR: OjPA7: goto CAw2E; WnHv9: $post_data['deviceid'] = $locksn; goto m0Nl1; MCFsV: $res['code'] = '0'; goto SU4l4; FUQp6: return $res; goto of0oU; RWuJQ: $post_data['statuscode'] = 1; goto oS_ZN; CAw2E: $post_data['apikey'] = $this->syscfg['bl_apikey']; goto WnHv9; zobvb: if ($rs['data']['online'] == '1') { goto WpV37; } goto EvKns; BgkXJ: $url = 'lockstate.html?appid=' . $this->syscfg['mj_apiid'] . '&appsecret=' . $this->syscfg['mj_apikey']; goto cUJHa; wESef: $post_data['op'] = '0'; goto Dy_Xz; YKWPi: $url = 'AccessControl02/Api.php'; goto wAamE; RySsp: return $res; goto oEJwf; oEJwf: goto gUIC3; goto cOBaR; CgSiu: goto gUIC3; goto vzqsv; tuVP3: $post_data['sn'] = $locksn; goto oSdhr; oSdhr: $res = Zr_httpPost($url, $post_data); goto RySsp; tw7LD: if ($doortype == 2) { goto OjPA7; } goto o9c0v; vSojk: FeYfT: goto JLSY2; zptSg: $res['msg'] = '离线'; goto M0gIs; NCMKn: $res['code'] = '1'; goto upyyp; ug0pn: R5N3Q: goto JM5yn; aSlhH: if ($rs[1] == '0001') { goto FeYfT; } goto DMerr; vzqsv: iKSWj: goto BgkXJ; jqfsw: if ($rs['state'] == '1' && $rs['state_code'] == '1') { goto jym74; } goto NCMKn; m0Nl1: $post_data['module'] = 1; goto RWuJQ; tdJ0y: $res['msg'] = '离线'; goto lt3zv; jkHfy: goto gUIC3; goto k7ycv; PVq06: $res['msg'] = '离线'; goto zMpxz; hFLwA: w6KMt: goto bWy7q; EvKns: $res['code'] = '1'; goto PVq06; JM5yn: J2x8p: goto FUQp6; QvUOH: } public function mysyslog($pid, $do, $op, $title, $content) { goto a8HBW; AqaYm: $data = array("weid" => $mywe['weid'], "pid" => $pid, "do" => $do, "op" => $op, "title" => $title, "content" => $content, "ip" => $_W['clientip'], "cuid" => $mywe['uid'], "ctime" => TIMESTAMP); goto igUjO; igUjO: pdo_insert('rhinfo_zyxq_syslog', $data); goto zRrij; msSDI: $mywe = $this->mywe; goto AqaYm; a8HBW: global $_W, $_GPC; goto msSDI; zRrij: } public function opendoorlog($id, $res) { goto lqW8p; Jvd8V: pdo_insert('rhinfo_zyxq_doorlog', $data); goto gPx0D; B8xlG: $data = array("weid" => $_W['uniacid'], "uid" => $_W['member']['uid'], "did" => $id, "status" => $res['code'], "result" => $res['msg'], "opentime" => TIMESTAMP); goto Jvd8V; lqW8p: global $_W; goto B8xlG; gPx0D: } public function parkingiolog($lotid, $id, $io, $res) { goto plmhF; IrTkK: pdo_insert('rhinfo_zyxq_parkingiolog', $data); goto xQZh4; Tahcp: $data = array("weid" => $_W['uniacid'], "uid" => $_W['member']['uid'], "openid" => $_W['openid'], "lotid" => $lotid, "ioid" => $id, "io" => $io, "status" => $res['code'], "result" => $res['msg'], "ctime" => TIMESTAMP); goto IrTkK; plmhF: global $_W; goto Tahcp; xQZh4: } public function parklocklog($lockid, $updown, $res) { goto Z7El9; ni6KY: $data = array("weid" => $_W['uniacid'], "uid" => $_W['member']['uid'], "openid" => $_W['openid'], "lockid" => $lockid, "updown" => $updown, "status" => $res['code'], "result" => $res['msg'], "ctime" => TIMESTAMP); goto l85Vm; Z7El9: global $_W; goto ni6KY; l85Vm: pdo_insert('rhinfo_zyxq_parklocklog', $data); goto Obcqp; Obcqp: } public function send_print($pid, $rid, $printtype, $content, $content1) { goto JzBYN; HJxK6: qSbPu: goto Ym9mF; Ynisd: FBYHZ: goto i7F6F; z61by: iREnL: goto bzXZu; rA7S0: if ($printer['printbrand'] == 1) { goto tDkf0; } goto Xiyoq; DcSys: vJmSo: goto NEUs6; zDf1B: if ($res['state'] == 1) { goto veOi4; } goto sEYlh; NfKMH: $res = yyl_print($printer['userid'], $printer['printno'], $content, $printer['apikey'], $printer['printkey'], $printer['url']); goto zDf1B; T_OSl: ptRMM: goto puxA8; LNcLh: return array("status" => 0, "message" => '打印失败:' . $res['msg']); goto vCXZr; ZoioZ: if ($res['ret'] == 0) { goto vJmSo; } goto LNcLh; Xiyoq: if ($printer['printbrand'] == 2) { goto FBYHZ; } goto xfcvi; NEUs6: return array("status" => 1, "message" => '打印成功' . $res['msg']); goto T_OSl; JzBYN: global $_W; goto yUhsE; bzXZu: $sql = 'select * from ' . tablename('rhinfo_zyxq_printer') . ' where weid=:weid and pid=:pid and rid=:rid and (printtype=:printtype or printtype=0) and status=1 order by printtype desc'; goto jhglr; eyWby: $_W['uniacid'] = $mywe['weid']; goto z61by; xfcvi: return array("status" => 0, "message" => "无打印机"); goto urDZ9; pDR_W: if (!empty($_W['uniacid'])) { goto iREnL; } goto eyWby; TntK9: tDkf0: goto NfKMH; BZl4l: veOi4: goto MWjb3; yUhsE: $mywe = $this->mywe; goto pDR_W; urDZ9: goto hEZ9H; goto TntK9; vCXZr: goto ptRMM; goto DcSys; sEYlh: return array("status" => 0, "message" => '打印失败:' . $res['state']); goto hA51J; jhglr: $printer = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":pid" => $pid, ":rid" => $rid, ":printtype" => $printtype)); goto rA7S0; MWjb3: return array("status" => 1, "message" => '打印成功' . $res['id']); goto HJxK6; i7F6F: $res = feie_print($printer['userid'], $printer['printno'], $content1, $printer['apikey'], $printer['printkey'], $printer['url']); goto ZoioZ; puxA8: hEZ9H: goto OkTa6; hA51J: goto qSbPu; goto BZl4l; Ym9mF: goto hEZ9H; goto Ynisd; OkTa6: } public function repeat_wechat_order_query($params, $mywechat) { goto bMOMF; cEQix: pdo_update('rhinfo_zyxq_paylog', array("status" => -1), array("weid" => $mywe['weid'], "id" => $params['logid'])); goto HAW2Y; lDhui: return error(-1, '支付失败'); goto xhePp; bMOMF: $res = my_wechat_order_query($params['tid'], $params['fee'], $mywechat); goto ow34T; Q4hIS: if (!($res['trade_state'] == 'REFUND' || $res['message'] == '该订单已经关闭或者已经退款')) { goto SAWnM; } goto cEQix; xj4uI: return $this->repeat_wechat_order_query($params, $mywechat); goto VG2CH; nL0A8: SAWnM: goto kH5oU; VG2CH: goto o9_Nt; goto xvJnM; xhePp: Vtju4: goto Q4hIS; HAW2Y: return error(-1, $res['message']); goto nL0A8; YB1xG: return true; goto zXGOZ; kH5oU: if ($res['total_fee'] == round($params['fee'] * 100, 2) || $res['total_amount'] == round($params['fee'], 2)) { goto k5QBb; } goto xj4uI; xvJnM: k5QBb: goto YB1xG; ow34T: if (!empty($res)) { goto Vtju4; } goto lDhui; zXGOZ: o9_Nt: goto VQR6r; VQR6r: } public function my_mobileurl($url) { goto TE9ct; DrW0T: return $siteurl . 'app' . substr($url, 1, strlen($url)); goto duVJ6; o7GA0: $siteurl = !empty($this->syscfg['siteurl']) ? $this->syscfg['siteurl'] : $_W['siteroot']; goto DrW0T; TE9ct: global $_W; goto o7GA0; duVJ6: } public function check_api_token($token) { goto W37ml; W37ml: if (!(empty($this->syscfg['isopenapi']) || empty($this->syscfg['siteurl']) || empty($this->syscfg['api_token']))) { goto VTntU; } goto vO6os; ki4Mv: return true; goto JW7tZ; kFbpW: VTntU: goto eOrf0; eOrf0: if (!($token != $this->syscfg['api_token'])) { goto t8R7p; } goto vinbu; NpiDh: t8R7p: goto ki4Mv; vinbu: exit(json_encode(array("errno" => 1, "message" => "Access Denied."))); goto NpiDh; vO6os: exit(json_encode(array("errno" => 1, "message" => "Access Denied."))); goto kFbpW; JW7tZ: } public function send_redpacket($redid, $openid, $rednum) { goto U_H1z; qDxBL: WbT3d: goto prcQq; ds9JO: AwRbB: goto vcKJY; L1T8S: $amount = 0; goto VOKKz; Cqiw2: zc1D9: goto jBOmq; mSnjD: dywGv: goto iaJyH; kWbf1: if (!($gettotal == 0 && !empty($redmember))) { goto Ky42l; } goto tPcPj; sfDqs: if (!($rednum == 0)) { goto cuAlI; } goto lCxGE; v4WeI: $redmid = $redmember['id']; goto gCm4o; wfMMd: XV9pA: goto dpD83; iaJyH: pdo_insert('rhinfo_zycj_redpacket_member', $data); goto m0iMg; wFnsM: if (empty($redpacket['sumamount']) && empty($redpacket['totalnum'])) { goto LwnnL; } goto kZv6O; dFOJ8: u5Vy6: goto CbktM; dpD83: $amount = mt_rand($redpacket['minamount'], $redpacket['maxamount']); goto Jt5uO; DYnti: return error(-1, '红包生成失败'); goto v0S61; zl9_E: goto o7BoK; goto i_kIv; Jt5uO: a7ffe: goto sSMu4; oVAe8: if ($redpacket['category'] == 2) { goto Fy13y; } goto wVh0L; RL9WW: if (empty($redpacket['totalnum'])) { goto hsLrC; } goto geO_q; m0iMg: $isred = 1; goto um2AA; Wsa8i: jorAZ: goto iiTzw; v0S61: goto u5Vy6; goto V2LjE; geO_q: if ($total_num < $redpacket['totalnum'] * 100) { goto sKkmU; } goto chP91; FHnVD: $isred = 1; goto Ez00U; DSxjv: vkuXo: goto oVAe8; W32Kb: $sql = 'select * from ' . tablename('rhinfo_zycj_redpacket') . ' where id=:id and weid=:weid and status=1 '; goto mYnCT; V25qy: if (!($rednum == 1)) { goto iWyLq; } goto Sn061; V2LjE: HQBKc: goto xTiHL; bkqG6: Bxhg9: goto uvSpE; jBOmq: hsLrC: goto eGM0k; wVh0L: $amount = $redpacket['amount']; goto zl9_E; uvSpE: if (!($isred == 1)) { goto xJaEI; } goto WfS7V; yri9y: $sum_amount = pdo_fetchcolumn('select sum(amount) from ' . tablename('rhinfo_zycj_redpacket_member') . ' where redid=:redid and weid=:weid ', array(":redid" => $redid, ":weid" => $_W['uniacid'])); goto G2S_S; tPcPj: $isred = 1; goto v4WeI; jSOcv: pdo_insert('rhinfo_zycj_redpacket_member', $data); goto ujXKb; BMeK5: if (empty($redpacket['sumamount']) || empty($redpacket['totalnum'])) { goto ZEAMP; } goto CD6wd; sSMu4: o7BoK: goto aoxSu; zaVtH: return error(-1, '红包超出总金额或总数量'); goto xzWZz; iq2wi: return array("url" => $url); goto dFOJ8; WfS7V: $redmid = pdo_insertid(); goto CJ6Nq; lCxGE: $redmember = pdo_fetch('select * from ' . tablename('rhinfo_zycj_redpacket_member') . ' where redid=:redid and weid=:weid and openid=:openid and status=0 ', array(":redid" => $redid, ":weid" => $_W['uniacid'], ":openid" => $openid)); goto I1zAC; nQ0XI: $isred = 1; goto qDxBL; Ez00U: $redmid = $redmember['id']; goto L2qCW; Sn061: $redmember = pdo_fetch('select * from ' . tablename('rhinfo_zycj_redpacket_member') . ' where redid=:redid and weid=:weid and openid=:openid and rid=:rid ', array(":redid" => $redid, ":weid" => $_W['uniacid'], ":openid" => $openid, ":rid" => $redpacket['rid'])); goto TIEux; i_kIv: Fy13y: goto l_nGw; CD6wd: if ($sum_amount < $redpacket['sumamount'] * 100 && $total_num < $redpacket['totalnum'] * 100) { goto AwRbB; } goto zaVtH; U_H1z: global $_W; goto VRY96; aoxSu: $data = array("weid" => $_W['uniacid'], "rid" => $redpacket['rid'], "redid" => $redid, "amount" => $amount, "openid" => $openid, "starttime" => TIMESTAMP, "endtime" => strtotime('+30 days'), "status" => 0, "cuid" => $_W['member']['uid'], "ctime" => TIMESTAMP); goto yri9y; xTiHL: $url = $this->createMobileUrl('redpacket', array("op" => "index", "redid" => $redpacket['id'], "redmid" => $redmid, "authkey" => md5(base64_encode($openid)))); goto iq2wi; AdubE: $isred = 1; goto Cqiw2; B4v8J: HIFVZ: goto bkqG6; mYnCT: $redpacket = pdo_fetch($sql, array(":id" => $redid, ":weid" => $_W['uniacid'])); goto rk2zI; ujXKb: $isred = 1; goto B4v8J; AihNk: LwnnL: goto jSOcv; rk2zI: if (!empty($redpacket)) { goto vkuXo; } goto mtVx4; mtVx4: return error(-1, '没有找到相关红包策略'); goto DSxjv; l_nGw: if ($redpacket['minamount'] > 0 && $redpacket['maxamount'] > 0) { goto XV9pA; } goto L1T8S; um2AA: O4dh3: goto zE_l5; iiTzw: if ($isred == 1) { goto HQBKc; } goto DYnti; chP91: return error(-1, '红包超出总数量'); goto DgKuv; BkVkh: return error(-1, '红包超出总金额'); goto O5Fsn; K7dhL: if (!($amount > 0 && empty($redmember))) { goto jorAZ; } goto BMeK5; gCm4o: Ky42l: goto XlEbm; O5Fsn: goto O4dh3; goto mSnjD; prcQq: goto Bxhg9; goto DZCN0; vcKJY: pdo_insert('rhinfo_zycj_redpacket_member', $data); goto nQ0XI; DZCN0: ZEAMP: goto wFnsM; kZv6O: if (empty($redpacket['sumamount'])) { goto CQrof; } goto Qzstk; xzWZz: goto WbT3d; goto ds9JO; WyFNW: $total_num = empty($total_num) ? 0 : $total_num; goto V25qy; pZ1WJ: cuAlI: goto K7dhL; DgKuv: goto zc1D9; goto Sq27s; Qzstk: if ($sumamount < $redpacket['sumamount'] * 100) { goto dywGv; } goto BkVkh; eGM0k: goto HIFVZ; goto AihNk; VRY96: $isred = 0; goto W32Kb; zE_l5: CQrof: goto RL9WW; L2qCW: OlGQs: goto pZ1WJ; XlEbm: iWyLq: goto sfDqs; Sq27s: sKkmU: goto SxUt5; I1zAC: if (empty($redmember)) { goto OlGQs; } goto FHnVD; TIEux: $gettotal = pdo_fetchcolumn('select count(*) from ' . tablename('rhinfo_zycj_redpacket_member') . ' where redid=:redid and weid=:weid and openid=:openid and rid=:rid and status=1 ', array(":redid" => $redid, ":weid" => $_W['uniacid'], ":openid" => $openid, ":rid" => $redpacket['rid'])); goto kWbf1; VOKKz: goto a7ffe; goto wfMMd; SxUt5: pdo_insert('rhinfo_zycj_redpacket_member', $data); goto AdubE; UE7v9: $sum_amount = empty($sum_amount) ? 0 : $sum_amount; goto WyFNW; CJ6Nq: xJaEI: goto Wsa8i; G2S_S: $total_num = pdo_fetchcolumn('select count(*) from ' . tablename('rhinfo_zycj_redpacket_member') . ' where redid=:redid and weid=:weid ', array(":redid" => $redid, ":weid" => $_W['uniacid'])); goto UE7v9; CbktM: } public function mxdevstatus($devsn) { goto KlsIe; D96T1: if ($rs[0] == 'SUCCESS') { goto Ney33; } goto MUZU2; f0B3Q: kJIFn: goto lPpIG; AP5i5: $post_data = array("action" => "checkStas", "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid'], "device_code" => $devsn); goto Rg4xK; EVpcG: $res['msg'] = '离线'; goto rNe5v; j4zJ9: sAqKp: goto mZdsF; EyLA8: $res['msg'] = '离线'; goto R3noX; GKNCP: if ($rs[1] == '0001') { goto kJIFn; } goto zW6Kp; lPpIG: $res['code'] = '0'; goto zaQfa; zW6Kp: $res['code'] = '1'; goto EVpcG; zaQfa: $res['msg'] = '在线'; goto YtoWc; YtoWc: u5N4D: goto j4zJ9; mZdsF: return $res; goto i71g7; MUZU2: $res['code'] = '1'; goto EyLA8; rNe5v: goto u5N4D; goto f0B3Q; L9laY: Ney33: goto GKNCP; R3noX: goto sAqKp; goto L9laY; Rg4xK: $rs = Mx_httpPost($url, $post_data); goto D96T1; KlsIe: $url = 'paycloud/Api.php'; goto AP5i5; i71g7: } public function mxdevopen($devsn) { goto LeB9k; KKjCk: $res['msg'] = '开启失败!'; goto Wz7KM; J1akY: $rs = Mx_httpPost($url, $post_data); goto neAjj; eVbL4: $res['code'] = '1'; goto KKjCk; Ho_yj: N6tPh: goto L0ACZ; LeB9k: $url = 'paycloud/Api.php'; goto NvmzY; OoTkp: N6dqw: goto aUNGS; aUNGS: return $res; goto AJDYw; L0ACZ: $res['code'] = '0'; goto J1YAS; NvmzY: $post_data = array("action" => "sendIns", "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid'], "pluse" => "0002", "device_code" => $devsn); goto J1akY; Wz7KM: goto N6dqw; goto Ho_yj; J1YAS: $res['msg'] = '开启成功!'; goto OoTkp; neAjj: if ($rs[0] == 'SUCCESS') { goto N6tPh; } goto eVbL4; AJDYw: } public function mxdevreg($devsn) { goto Ky822; PkY8f: $res['code'] = '0'; goto TmbqA; Ky822: $url = 'paycloud/Api.php'; goto PZasy; PZasy: $post_data = array("action" => "registered", "device_code" => $devsn, "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid']); goto jbf2q; TmbqA: $res['msg'] = '注册成功!'; goto yQZEW; j7xfP: if ($rs[0] == 'SUCCESS') { goto CQ8xR; } goto qaJki; qaJki: $res['code'] = '1'; goto o2v9f; sWm87: CQ8xR: goto PkY8f; yQZEW: b7bcO: goto OBLSL; OBLSL: return $res; goto cPdCD; o2v9f: $res['msg'] = '注册失败!'; goto pSAyh; pSAyh: goto b7bcO; goto sWm87; jbf2q: $rs = Mx_httpPost($url, $post_data); goto j7xfP; cPdCD: } public function accountmenus() { goto Q7VZQ; Q7VZQ: global $_W, $_GPC; goto omEmG; WNKr3: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto o4icj; wjT8l: b502X: goto nMEUJ; omEmG: $mywe = $this->mywe; goto xG8s4; e5GoG: return $menus; goto be7FN; xG8s4: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay order by displayorder'; goto WNKr3; nMEUJ: J1DHk: goto e5GoG; o4icj: if (empty($menus)) { goto J1DHk; } goto RbRVr; RbRVr: foreach ($menus as &$value) { goto ueSyo; ueSyo: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 order by isdisplay desc ,displayorder asc'; goto ulUQg; pwbRu: punfk: goto l7Q58; JqumZ: $value['submenus'] = $submenus; goto pwbRu; ulUQg: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto JqumZ; l7Q58: } goto wjT8l; be7FN: } public function accountmenus_edit($aid, $weid) { goto lHwp4; NC4_y: return $menus; goto F_zSV; Fz6Ix: if (empty($menus)) { goto qrO7m; } goto mu9xu; mu9xu: foreach ($menus as &$value) { goto V05ZE; pP0UI: foreach ($submenus as &$item) { goto Vs8kc; ovRgn: $rights = pdo_fetch($sql, array(":weid" => $weid, ":aid" => $aid, ":pid" => $item['id'])); goto ON1vL; Vs8kc: $sql = 'select * from ' . tablename('rhinfo_zyxq_secaprg') . ' where weid = :weid and aid = :aid and pid = :pid'; goto ovRgn; w2CIK: $item['rights'] = $rights; goto wOq3y; g61CZ: $item['prg'] = $i; goto BZG3M; BZG3M: $j = $i; goto gwpcw; gwpcw: w09E6: goto bl4Rz; wOq3y: $i = $rights['weid'] == $weid ? 1 : 0; goto g61CZ; ON1vL: if (empty($rights)) { goto w09E6; } goto w2CIK; bl4Rz: SYGhz: goto kicVG; kicVG: } goto LXJYm; p46o7: $value['submenus'] = $submenus; goto mqjm_; uNSYM: UTunG: goto yZyzI; O_0T_: if (empty($submenus)) { goto UTunG; } goto pP0UI; LXJYm: X41hs: goto p46o7; mqjm_: $value['sys'] = $j; goto uNSYM; P4buS: $submenus = pdo_fetchall($sql, array(":sid" => $value['id'])); goto b_l3u; b_l3u: $j = 0; goto O_0T_; V05ZE: $sql = 'select * from ' . tablename('rhinfo_zyxq_secprg') . ' where sid = :sid and isdismenu=1 order by isdisplay desc,displayorder asc'; goto P4buS; yZyzI: w5_Zy: goto ds1cC; ds1cC: } goto iXK8p; OBGUt: qrO7m: goto NC4_y; PcIhn: $menus = pdo_fetchall($sql, array(":isdisplay" => "1")); goto Fz6Ix; lHwp4: global $_W, $_GPC; goto FzwS5; FzwS5: $sql = 'select * from ' . tablename('rhinfo_zyxq_secsys') . ' where isdisplay = :isdisplay  order by displayorder'; goto PcIhn; iXK8p: X5CB3: goto OBGUt; F_zSV: } public function express_build_orderno($orderno, $expresssn) { goto H5iru; AN9KW: return $orderno; goto LUAMt; LzrbB: $sql = 'select count(*) from ' . tablename('rhinfo_zycj_express') . ' where weid=:weid and  orderno=:orderno'; goto oalym; svDmi: $orderno = $this->express_build_orderno(build_order_no() . substr($expresssn, -2), $expresssn); goto S6x7h; H5iru: global $_W, $_GPC; goto LzrbB; LFh13: if (!($total > 0)) { goto zXcy1; } goto svDmi; oalym: $total = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'], ":orderno" => $orderno)); goto LFh13; S6x7h: zXcy1: goto AN9KW; LUAMt: } public function express_store_rights($sid, $uid) { goto x7C6W; UyCTH: $retarr['sid'] = $store['id']; goto m3n2C; Y29dV: return $retarr; goto W6MuT; sw_fl: $retarr['sid'] = $sid; goto TDDo_; vIFqF: $retarr['sid'] = $sid; goto CTH1z; NqbkY: $retarr['from'] = 'store'; goto UyCTH; a_faN: $retarr['from'] = 'employee'; goto SxjxO; xuXLI: if (!empty($employee)) { goto bOQLJ; } goto rvUut; CTH1z: X9cNe: goto GTkY4; ogVBW: $store = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto kVgpX; m3n2C: dmuKR: goto KW5en; ycbpG: if (!empty($sid)) { goto sWL9i; } goto DTlD9; AFBVW: bOQLJ: goto a_faN; oxCLo: C5hs9: goto W3Ow_; IxXSb: $sql = 'select * from ' . tablename('rhinfo_zycj_express_employee') . ' where weid= :weid and sid=:sid and uid=:uid and status=1'; goto ytbD3; p1yMN: $retarr = array(); goto Ysljp; kVgpX: if (empty($store)) { goto dmuKR; } goto NqbkY; XxKbI: $retarr['from'] = 'store'; goto vIFqF; ytbD3: $employee = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $sid, ":uid" => $uid)); goto BcjHE; rvUut: $sql = 'select * from ' . tablename('rhinfo_zycj_express_store') . ' where weid= :weid and uid=:uid'; goto ogVBW; Ysljp: $retarr['from'] = 'member'; goto fx_Aq; SxjxO: $retarr['sid'] = $employee['sid']; goto oxCLo; GTkY4: goto nLQR_; goto x5Rk5; KW5en: goto C5hs9; goto AFBVW; x7C6W: global $_W, $_GPC; goto p1yMN; BcjHE: if (!empty($employee)) { goto QZhI9; } goto DeuoP; mgruQ: $retarr['from'] = 'employee'; goto sw_fl; AzAPC: $employee = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto xuXLI; TBUVd: if (empty($store)) { goto X9cNe; } goto XxKbI; fx_Aq: $retarr['sid'] = $sid; goto ycbpG; V88wz: $store = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $sid, ":uid" => $uid)); goto TBUVd; x5Rk5: QZhI9: goto mgruQ; JlV1u: sWL9i: goto IxXSb; zJagI: JwQWH: goto Y29dV; TDDo_: nLQR_: goto zJagI; DeuoP: $sql = 'select * from ' . tablename('rhinfo_zycj_express_store') . ' where weid= :weid and id=:sid and uid=:uid'; goto V88wz; DTlD9: $sql = 'select * from ' . tablename('rhinfo_zycj_express_employee') . ' where weid= :weid and uid=:uid and status=1'; goto AzAPC; W3Ow_: goto JwQWH; goto JlV1u; W6MuT: } public function express_express_rights($sid, $compid, $uid) { goto tm8M_; D_bKs: aMoLC: goto HpS8x; qCzXD: $retarr['sid'] = $sid; goto e31on; CLM26: $retarr['sid'] = $sid; goto Wy_co; yub0Q: DwYI0: goto Ii9im; JlSIO: hCcOo: goto jV9lL; sa6xl: $sql = 'select b.*,a.sid from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_company') . ' as b on a.compid=b.id where a.weid = :weid and b.uid=:uid'; goto KkJKe; Es8hP: if (!empty($compid)) { goto O2jjX; } goto sa6xl; VZiYi: $sql = 'select b.* from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_company') . ' as b on a.compid=b.id where a.weid = :weid and a.sid=:sid and b.id=:compid and  b.uid=:uid'; goto yemYP; W0z2r: goto tXxW2; goto NMIZ2; z0SxY: $retarr['sid'] = $person['sid']; goto aZVgs; ojfNE: goto KOthS; goto n4b_W; hP5Ah: kHxpA: goto YB9zW; IrZFd: if (!empty($company)) { goto rrnR4; } goto nxjul; vC_xQ: if (!empty($company)) { goto DwYI0; } goto XKOIA; eARip: $person = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $sid, ":uid" => $uid, ":compid" => $compid)); goto p7Tjc; qm_wh: $retarr['sid'] = $sid; goto HAB0l; tn9k4: if (!empty($company)) { goto qRSky; } goto zJMwL; p7Tjc: if (empty($person)) { goto aMoLC; } goto vyENM; p4T4o: if (!empty($company)) { goto ElKkp; } goto n_gYr; Oxega: $company = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":compid" => $compid, ":uid" => $uid)); goto IrZFd; CpYir: $retarr['compid'] = $company['id']; goto qrJ4m; JYPjZ: $retarr['from'] = 'express'; goto CLM26; rwKRo: W0nqC: goto zvnvE; P_r_4: $company = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto Wfa_p; e31on: $retarr['compid'] = $person['compid']; goto D_bKs; NMIZ2: O2jjX: goto UgUWL; tm8M_: global $_W, $_GPC; goto bSgE2; WX19m: MvTXp: goto VZiYi; MlPNc: $retarr['sid'] = $company['sid']; goto GkAFT; HAB0l: $retarr['compid'] = $compid; goto AELfi; U8PU0: A8C77: goto gMSu1; gMSu1: return $retarr; goto FdxJs; aZVgs: $retarr['compid'] = $person['compid']; goto hP5Ah; VBV5u: if (empty($person)) { goto ouV8R; } goto JYPjZ; GkAFT: $retarr['compid'] = $compid; goto Y7XDK; XKOIA: $sql = 'select b.*,a.sid from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_person') . ' as b on a.expid=b.id where a.weid = :weid and b.uid=:uid and status=1'; goto YSNuR; n4b_W: qRSky: goto jZevq; D2Jb5: $retarr['sid'] = $company['sid']; goto mahfT; f2Gq0: $retarr['sid'] = $sid; goto CpYir; jV9lL: Vuqat: goto U8PU0; zJMwL: $sql = 'select b.* from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_person') . ' as b on a.expid=b.id where a.weid = :weid and a.sid=:sid and b.uid=:uid and status=1'; goto OIk06; FThap: FpsIa: goto W0z2r; nO1LA: goto wKls8; goto T2hPO; AxXq7: if (!empty($compid)) { goto MvTXp; } goto l2Jq9; RqhVu: $retarr['compid'] = $compid; goto JlSIO; AN4kz: $retarr['sid'] = $company['sid']; goto GFYMz; B_fIx: $retarr['from'] = 'company'; goto wVssT; bSgE2: $retarr = array(); goto T_FCU; T_FCU: $retarr['from'] = 'member'; goto qm_wh; T2hPO: rrnR4: goto uFLoO; mahfT: $retarr['compid'] = $company['id']; goto FThap; bC7yq: ElKkp: goto B_fIx; Gm6VF: $retarr['compid'] = $person['compid']; goto umC3y; vZYEc: $retarr['sid'] = $person['sid']; goto Gm6VF; YSNuR: $person = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto P2oey; vyENM: $retarr['from'] = 'express'; goto qCzXD; UgUWL: $sql = 'select b.*,a.sid from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_company') . ' as b on a.compid=b.id where a.weid = :weid and b.id=:compid and b.uid=:uid'; goto Oxega; CMzNN: ouV8R: goto ojfNE; KkJKe: $company = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto vC_xQ; r7FLk: tXxW2: goto xG1sE; uFLoO: $retarr['from'] = 'company'; goto MlPNc; P2oey: if (empty($person)) { goto RgJfj; } goto GgEOI; TOtv_: YdSlL: goto nO1LA; HpS8x: goto hCcOo; goto bC7yq; jg7Sl: goto Vuqat; goto WX19m; xG1sE: goto A8C77; goto LYmKI; Ii9im: $retarr['from'] = 'company'; goto D2Jb5; zvnvE: $retarr['from'] = 'company'; goto AN4kz; l2Jq9: $sql = 'select b.* from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_company') . ' as b on a.compid=b.id where a.weid = :weid and a.sid=:sid and b.uid=:uid'; goto QWGtl; hNtk2: $person = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":uid" => $uid)); goto GJxAz; GgEOI: $retarr['from'] = 'express'; goto vZYEc; nxjul: $sql = 'select b.*,a.sid from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_company') . ' as b on a.compid=b.id where a.weid = :weid and b.uid=:uid'; goto P_r_4; GFYMz: $retarr['compid'] = $company['id']; goto TOtv_; OIk06: $person = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $sid, ":uid" => $uid)); goto VBV5u; FLUl1: $sql = 'select b.*,a.sid from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_person') . ' as b on a.expid=b.id where a.weid = :weid and b.uid=:uid and status=1'; goto hNtk2; iVpgg: goto FpsIa; goto yub0Q; Wfa_p: if (!empty($company)) { goto W0nqC; } goto FLUl1; umC3y: RgJfj: goto iVpgg; YB9zW: goto YdSlL; goto rwKRo; Syv6g: $retarr['from'] = 'express'; goto z0SxY; qrJ4m: KOthS: goto jg7Sl; jZevq: $retarr['from'] = 'company'; goto f2Gq0; QWGtl: $company = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $sid, ":uid" => $uid)); goto tn9k4; AELfi: if (!empty($sid)) { goto GW7bc; } goto Es8hP; n_gYr: $sql = 'select b.* from ' . tablename('rhinfo_zycj_express_storecomp') . ' as a left join ' . tablename('rhinfo_zycj_express_person') . ' as b on a.expid=b.id where a.weid = :weid and a.sid=:sid and b.uid=:uid and b.compid=:compid and status=1'; goto eARip; yemYP: $company = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $sid, ":compid" => $compid, ":uid" => $uid)); goto p4T4o; GJxAz: if (empty($person)) { goto kHxpA; } goto Syv6g; Y7XDK: wKls8: goto r7FLk; LYmKI: GW7bc: goto AxXq7; Wy_co: $retarr['compid'] = $person['compid']; goto CMzNN; wVssT: $retarr['sid'] = $sid; goto RqhVu; FdxJs: } public function activity_check_member($item = array()) { goto NHHhx; We282: pfbDP: goto v1y9w; F7ytT: if (!($item['enddate'] < TIMESTAMP)) { goto Jks1F; } goto Dcl3K; ZqLgc: $sign = pdo_get('rhinfo_zyxq_activity_sign', array("weid" => $_W['uniacid'], "actid" => $item['id'], "uid" => $_W['member']['uid'])); goto UDo_s; TAAg9: return array("errno" => 1, "message" => "抱歉，您已经参加了"); goto NyeG4; oTv0c: if (!($item['startdate'] > TIMESTAMP)) { goto oJelV; } goto CsoQE; Dcl3K: return array("errno" => 1, "message" => "抱歉，活动已经结束"); goto NJE_e; CsoQE: return array("errno" => 1, "message" => "抱歉，活动还未开始"); goto oaSZ4; i5IyJ: if ($item['checkmethod'] == 3) { goto lFieA; } goto xf7xr; NHHhx: global $_W; goto vGxnn; ASIV6: X_JFR: goto exyX1; Ogc0W: lFieA: goto gcqjU; Be51r: if ($item['checkmethod'] == 1) { goto pfbDP; } goto chcyB; oaSZ4: oJelV: goto F7ytT; l1zkg: ipWpk: goto aYP8D; vpZ0X: return array("errno" => 1, "message" => "抱歉，您不是业主"); goto fKFiP; qHsqL: return array("errno" => 1, "message" => "抱歉，您已经参加了"); goto ASIV6; lrBs_: goto lIZ7q; goto g_ayJ; NyeG4: utKtN: goto ZjmMh; OfzJP: goto lIZ7q; goto Ogc0W; NkA50: lIZ7q: goto UD3PS; g_ayJ: pyMCe: goto OUkGh; E1TJ2: $member = pdo_get('rhinfo_zyxq_member', array("weid" => $_W['uniacid'], "rid" => $item['rid'], "uid" => $_W['member']['uid'], "deleted" => 0, "otype" => 0)); goto BGAhG; chcyB: if ($item['checkmethod'] == 2) { goto pyMCe; } goto i5IyJ; vGxnn: if (!(empty($item) || empty($item['status']))) { goto Rh_kp; } goto VtP3Z; T8lKb: return array("errno" => 0, "message" => "success"); goto hVRwZ; aYP8D: $vote = pdo_get('rhinfo_zyxq_activity_vote', array("weid" => $_W['uniacid'], "actid" => $item['id'], "uid" => $_W['member']['uid'])); goto k28h5; QKL_C: return array("errno" => 1, "message" => "抱歉，您不是业主"); goto LWJEI; exyX1: goto KJ6Q2; goto l1zkg; tiUZt: return array("errno" => 0, "message" => "抱歉，您未关注公众号"); goto hL6om; UDo_s: if (empty($vote)) { goto X_JFR; } goto qHsqL; tVduy: if (!empty($member)) { goto XN84u; } goto QKL_C; HcDoY: Rh_kp: goto oTv0c; fKFiP: O3Y8I: goto NkA50; v1y9w: if (!($_W['fans']['follow'] != '1')) { goto jNOcg; } goto AIf5l; k28h5: if (empty($vote)) { goto utKtN; } goto TAAg9; ZjmMh: KJ6Q2: goto T8lKb; gcqjU: if (!($_W['fans']['follow'] != '1')) { goto L67U5; } goto tiUZt; xf7xr: goto lIZ7q; goto We282; vZMMR: jNOcg: goto lrBs_; hL6om: L67U5: goto E1TJ2; UD3PS: if ($item['category'] == 1) { goto ipWpk; } goto ZqLgc; NJE_e: Jks1F: goto Be51r; VtP3Z: return array("errno" => 1, "message" => "抱歉，未找到相关活动"); goto HcDoY; BGAhG: if (!empty($member)) { goto O3Y8I; } goto vpZ0X; LWJEI: XN84u: goto OfzJP; OUkGh: $member = pdo_get('rhinfo_zyxq_member', array("weid" => $_W['uniacid'], "rid" => $item['rid'], "uid" => $_W['member']['uid'], "deleted" => 0, "otype" => 0)); goto tVduy; AIf5l: return array("errno" => 0, "message" => "抱歉，您未关注公众号"); goto vZMMR; hVRwZ: } public function get_my_doors($rid, $bid, $tid, $devtype = 0, $cate = 0) { goto ICNLb; ugrnf: goto JWHx1; goto Rcq6b; xhCv3: goto maiXY; goto gndP3; thPsS: if (empty($doors)) { goto nCoWU; } goto Mi5nD; L12OY: return $device; goto H6c3g; UJQor: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and status = 1 and lid=0 and bid=0 and tid=0'; goto k7MJH; BsqHP: if (!empty($devtype)) { goto jqmS4; } goto UJQor; b2C43: if (empty($doors2)) { goto hJ0L5; } goto Z3RTH; zVxaR: $doors = array_merge($doors1, $doors); goto thPsS; CYVm1: if (!($cate == 1)) { goto HFYb1; } goto X84Xa; p_DXZ: $device_arr = iunserializer($doors[$m]['device_json']); goto Ivy1y; F4dPC: goto Z1BZi; goto KGrlc; ybsFv: UeHBi: goto O1prK; Qyp1c: kTlTs: goto j_BnP; JONGi: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and status = 1 and bid=:bid and tid=:tid'; goto IWoF2; mMeZv: hJ0L5: goto lDU1o; BVNbK: maiXY: goto WVJDm; RavRU: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":devtype" => $devtype, ":bid" => $bid, ":tid" => $tid)); goto G2k_G; j_BnP: if (!empty($devtype)) { goto oc3L2; } goto JONGi; WI1Bs: reZ1t: goto jbsKy; eUmif: jqmS4: goto WG33D; QvkDC: $doors = array_merge($doors, $doors2); goto ybsFv; mxMn9: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":devtype" => $devtype, ":bid" => $bid, ":tid" => $tid)); goto nZDOK; nZDOK: NRTto: goto ppfuM; WG33D: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and devtype = :devtype and status = 1 and lid=0 and bid=0 and tid=0'; goto MvEAE; STDO6: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and status = 1 and bid=:bid and tid=:tid'; goto kJjmy; j2FXC: $lid = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":bid" => $bid)); goto nAqDa; Rdr6V: $m++; goto xhCv3; FSfSi: $doors = array_merge($doors, $doors2); goto Qyp1c; KGrlc: IB9gk: goto x39XU; ppfuM: if (empty($doors2)) { goto UeHBi; } goto QvkDC; XMh2s: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and status = 1 and bid=:bid and tid=:tid'; goto Jx0fG; G2k_G: JWHx1: goto EwRZj; PWvdD: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":devtype" => $devtype, ":bid" => 0, ":tid" => 0)); goto qGojx; YigQr: goto QoosP; goto eUmif; y2lQ3: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and status = 1 and bid=:bid and tid=:tid'; goto L_3Hr; lha98: $doors = array_merge($doors, $doors2); goto HLLKV; MomiQ: $sql = 'select lid from ' . tablename('rhinfo_zyxq_building') . ' where weid=:weid and rid = :rid and id=:bid'; goto j2FXC; ACY_s: NWkJ1: goto ycsBZ; nMrbD: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and devtype=:devtype and status = 1 and bid=:bid and tid=:tid'; goto mxMn9; ICNLb: global $_W; goto sJJ9r; pCwT8: rvU9F: goto b2C43; X7w3W: MqDx4: goto zVxaR; YgiK2: return $doors; goto yiiyR; KifeB: if (empty($doors2)) { goto kTlTs; } goto FSfSi; HLLKV: FrqQY: goto X7w3W; Ivy1y: $device[] = array("device_id" => $device_arr['device_id']); goto e8vGC; rmP83: $m = 0; goto BVNbK; H6c3g: HFYb1: goto YgiK2; qGojx: Z1BZi: goto KifeB; IWoF2: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":bid" => $bid, ":tid" => $tid)); goto ugrnf; x39XU: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and devtype=:devtype and status = 1 and bid=:bid and tid=:tid'; goto PWvdD; nAqDa: $lid = empty($lid) ? 0 : $lid; goto McGBX; jbsKy: if (!empty($devtype)) { goto NWkJ1; } goto XMh2s; vGcJP: nCoWU: goto CYVm1; Rcq6b: oc3L2: goto zjf_z; X84Xa: $device = array(); goto rmP83; wkhBC: cBb3h: goto nMrbD; Z3RTH: $doors = array_merge($doors, $doors2); goto mMeZv; sJJ9r: $doors = array(); goto S99p6; WVJDm: if (!($m < count($doors))) { goto YYXTh; } goto p_DXZ; qxaLd: QoosP: goto MomiQ; zjf_z: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and devtype=:devtype and status = 1 and bid=:bid and tid=:tid'; goto RavRU; e8vGC: r4Q3a: goto Rdr6V; EwRZj: if (empty($doors2)) { goto FrqQY; } goto lha98; kJjmy: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":bid" => $bid, ":tid" => $tid)); goto bT5uG; MvEAE: $doors1 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":devtype" => $devtype)); goto qxaLd; ycsBZ: $sql = 'select * from ' . tablename('rhinfo_zyxq_door') . ' where weid=:weid and rid = :rid and lid=:lid and devtype=:devtype and status = 1 and bid=:bid and tid=:tid'; goto InnGc; gndP3: YYXTh: goto L12OY; McGBX: if ($lid > 0) { goto reZ1t; } goto VcV5J; AAysC: $doors2 = array(); goto BsqHP; InnGc: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":devtype" => $devtype, ":bid" => $bid, ":tid" => 0)); goto pCwT8; O1prK: goto MqDx4; goto WI1Bs; S99p6: $doors1 = array(); goto AAysC; k7MJH: $doors1 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid)); goto YigQr; L_3Hr: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":bid" => 0, ":tid" => 0)); goto F4dPC; bT5uG: goto NRTto; goto wkhBC; VcV5J: if (!empty($devtype)) { goto cBb3h; } goto STDO6; lDU1o: if (!empty($devtype)) { goto IB9gk; } goto y2lQ3; Jx0fG: $doors2 = pdo_fetchall($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid, ":lid" => $lid, ":bid" => $bid, ":tid" => 0)); goto uPVmn; uPVmn: goto rvU9F; goto ACY_s; Mi5nD: $doors = multi_array_unique($doors); goto vGcJP; yiiyR: } public function scan_opendoor($rid, $devtype, $doortype, $locksn, $lockid, $fromdo, $doorid, $isajax = 0) { goto ZbUDN; RsEAO: $post_data = array("m" => "do", "f" => "smd", "a" => "get_net_open_key", "device_sncode" => $locksn); goto MTVTn; Qjddu: if ($devtype == 2 || $devtype == 3) { goto dvuij; } goto GLV09; oFwVf: header('Location:' . $this->createMobileurl($fromdo, array("op" => "qrcode", "id" => $doorid))); goto Zo8pL; j_U08: goto FeOZY; goto IrRd9; FTh5F: $set = array("mailin_appid" => $region['mailin_appid'], "mailin_secret" => $region['mailin_secret'], "mailin_token" => $region['mailin_token']); goto RsEAO; IrRd9: GYAtw: goto MpzX8; z_Rcs: if ($ret['state'] == 1) { goto XH3FM; } goto Yq1OB; AxiEe: return $res; goto yrXJU; pS7au: d3H8D: goto LIsZm; MTVTn: $result = mailin_http_post($set, $post_data); goto DpTFU; m3asm: $res['msg'] = $resp['message']; goto ISjSw; Zo8pL: exit; goto lvzvD; GBCyH: FY2Qj: goto h6_ls; MbiXD: Qp53f: goto SOs13; DMONA: XH3FM: goto NH3e8; SOs13: $post_data = array("m" => "do", "f" => "smd", "a" => "net_open", "device_sncode" => $locksn, "net_open_key" => $result['return_data']['net_open_key']); goto MEMK0; UyHwE: $data = '{
					"dev_sn":"' . $locksn . '"
				  }'; goto ClLJd; IUwoc: $sql = 'select doorlock_type,thinmoo_token,mailin_appid,mailin_secret,mailin_token from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid'; goto vzL5x; LIsZm: bk4sY: goto qjLOE; NH3e8: $res['code'] = '0'; goto a_Gn1; DpTFU: if ($result['state'] == 1) { goto Qp53f; } goto g3nts; hveDr: FeOZY: goto AxiEe; tI6yP: if ($doortype == 5) { goto fxWaM; } goto AJH46; ZbUDN: global $_W; goto MnuIj; a_Gn1: $res['msg'] = '开门成功'; goto pS7au; RxHfT: $res['msg'] = $result['state'] . '-' . $result['return_data']; goto Kjjhe; RGGgx: goto d3H8D; goto DMONA; AJH46: if ($doortype == 6) { goto yKZsM; } goto zDpb1; YZlYC: fxWaM: goto FTh5F; MpzX8: if (!($isajax != 1)) { goto K0yDh; } goto oFwVf; iPkcc: $res['msg'] = '开门成功'; goto mAQaw; GLV09: $res = $this->opendoor($this->syscfg['doortype'], $locksn, $lockid); goto j_U08; ncaQd: if (is_error($resp)) { goto FY2Qj; } goto GLv7b; ClLJd: $resp = $thinmoo->open_door($data); goto ncaQd; GLv7b: $res['code'] = '0'; goto iPkcc; Yq1OB: $res['code'] = '1'; goto DlGkz; CxZHW: $thinmoo = new ThinMoo($region); goto UyHwE; qjLOE: goto Qlzlm; goto tEyo1; QevYE: goto Qlzlm; goto YZlYC; MEMK0: $ret = mailin_http_post($set, $post_data); goto z_Rcs; tEyo1: yKZsM: goto J3W5i; J50EN: goto FeOZY; goto fyMU3; h6_ls: $res['code'] = '1'; goto m3asm; wSe1d: Qlzlm: goto hveDr; ISjSw: IBhPn: goto wSe1d; zDpb1: $res = $this->opendoor($this->syscfg['doortype'], $locksn, $lockid); goto QevYE; AM9fn: if ($devtype == 1) { goto GYAtw; } goto Qjddu; Kjjhe: goto bk4sY; goto MbiXD; fyMU3: dvuij: goto IUwoc; g3nts: $res['code'] = '1'; goto RxHfT; DlGkz: $res['msg'] = $ret['state'] . '-' . $ret['return']; goto RGGgx; MnuIj: $res = array("code" => 1, "msg" => "error"); goto AM9fn; vzL5x: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid)); goto tI6yP; mAQaw: goto IBhPn; goto GBCyH; lvzvD: K0yDh: goto J50EN; J3W5i: myload()->classs('thinmoo'); goto CxZHW; yrXJU: } public function pc_remonthcard($rid, $parklot, $parkpay) { goto u5iWS; A_Tms: return array(0, $res['resultMsg']); goto BR7X0; wty_G: if ($resmsg['ErrNo'] == '0000') { goto SuKyp; } goto Us6Ju; JDK8S: $machlist = ''; goto i2Vbf; wwboq: if ($res['result'] == 'success') { goto U7_jN; } goto TG2sG; xv1b5: if ($resmsg['ErrNo'] == '0000') { goto vjP0U; } goto aHy0A; n5GCR: $res = ipms_httpsign_post($set, $params); goto oaF8v; oSYZq: $res = pdo_update('rhinfo_zyxq_car_whitelist', $data_white, array("weid" => $parkpay['weid'], "id" => $whitelist['id'])); goto ClLRr; Ty0Qk: KKBal: goto SAD4T; N356g: $params = array(); goto M4_VX; Dab4F: $params = array("plantNum" => $parkpay['carno'], "beginDate" => $res['beginDate'], "endDate" => date('Y-m-d', $parkpay['enddate']), "payMode" => 1, "chargeMoney" => 1); goto q0rrZ; cSsGX: $cardno = $res['id']; goto aSZ3g; wEkOa: ulJkd: goto kiKrb; PhMIY: $params = array("CarNo" => $parkpay['carno'], "UserName" => $parkpay['realname'], "OperType" => "Delay", "Fee" => 100, "StartTime" => date('YmdHis', $parkpay['starttime']), "EndTime" => date('YmdHis', $parkpay['endtime']), "CarType" => "月卡A", "CardStatus" => 0, "Balance" => 0, "MachList" => $machlist, "SetNo" => "000"); goto FUrml; C1ytZ: z8rNp: goto haQ8b; K3N7C: vjP0U: goto UfusA; TDQ2e: $res = $res['datas'][0]; goto XzI09; OyW9d: $lanelist = $res['LaneList']; goto mx7Cq; WJPcG: hMz78: goto yARuk; L7rTM: if ($parklot['pc_type'] == 1) { goto daloX; } goto QJ1e8; TG2sG: return array(0, $res['resultMsg']); goto A41J6; FR2QJ: e2zQK: goto Uqz69; fBLYd: return array(1, "操作成功"); goto aatks; FvXSk: $set['userKey'] = $region['pc_secret']; goto Sq5i4; WL08w: $res = ipms_httpsign_post($set, $params); goto Szjya; Vp08L: return array(0, $res['msg']); goto Z7r2A; OwL0V: $machlist = substr($machlist, 0, -1); goto nOAk8; P8y6h: goto L_Lr4; goto DPdyf; du4jL: p0Ho1: goto GI_ug; lfGP7: nPwjJ: goto Ty0Qk; as2gO: Xh95j: goto ZzGIp; nblbj: return array(0, $res['result'] . $res['errorCode']); goto Nia97; evxZs: return array(0, "未找到月卡信息"); goto P8y6h; OQJ68: goto KKBal; goto HdYM2; QaqM3: zqD2M: goto du4jL; tlTn1: goto KKBal; goto PDe9W; vbtaw: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto x08ai; V1y0s: if ($parklot['pc_type'] == 8) { goto tZ53K; } goto gBseG; HdYM2: tXgxD: goto O3iVj; lb0kq: $res = deliyun_http_post($set, $params); goto la2_O; CX8zn: $set['url'] = 'third_api/monthCardAppAction_updateMonthCard.action'; goto EUuaZ; kH_5m: gxUgb: goto LfOqS; sX3bs: $res = deliyun_http_post($set, $params); goto zMy7K; DmTmc: if ($res['successCode'] == '100') { goto COmMK; } goto nblbj; gM32d: $params = array("plantNum" => $parkpay['carno'], "cardTypeId" => 2, "page" => 1, "size" => 1); goto sX3bs; c_RdT: Uxjza: goto pzkS5; haQ8b: goto KKBal; goto TNmWl; EN3Bp: return array(0, $res['result'] . $res['errorCode']); goto fZDS5; oHdYJ: htpfP: goto sGN86; xQRyN: SuKyp: goto OyW9d; x08ai: return array(1, "操作成功"); goto QaqM3; CQe8t: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto xOOfO; zxlTK: return array(0, $res['msg']); goto iM5St; PXcww: $res = icar_post_querycarid($set, $params); goto x5J0v; uqTyr: return array(0, $res['msg']); goto Yx1gL; x84e3: $params = array("parkId" => $parklot['pc_plotid'], "carNum" => $parkpay['carno'], "startTime" => date('Y-m-d', $parkpay['starttime']), "endTime" => date('Y-m-d', $parkpay['endtime']), "userPhone" => $parkpay['mobile'], "userName" => $parkpay['ownername'], "loginUserName" => $parkpay['mobile'], "rechangeFee" => 100); goto WL08w; yW_U1: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto Vfzr9; BR7X0: goto zghfi; goto CKvGo; aatks: zghfi: goto ftx1A; M1dky: YZXD8: goto OQJ68; eLWpt: or78w: goto OwL0V; Us6Ju: return array(0, '操作异常' . $res['MsgStr']); goto tX5Ef; yDjhE: enyOk: goto i9BNr; TNmWl: bUIYF: goto MDdY4; xKIyc: if ($parklot['pc_type'] == 3) { goto tXgxD; } goto HdKHs; tX5Ef: goto z8rNp; goto xQRyN; svxhq: $set['url'] = 'parking/carDelay/'; goto Dab4F; ek13f: $params = array("plantNum" => $parkpay['carno'], "beginDate" => date('Y-m-d', $parkpay['starttime']), "endDate" => date('Y-m-d', $parkpay['endtime']), "carTypeId" => 2, "money" => 1, "pname" => $parkpay['ownername'], "mobile" => $parkpay['mobile']); goto lb0kq; CDyWP: $rows = $res['rows']; goto HdZPY; J4Ya0: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto fBLYd; u5iWS: global $_W; goto IzDSc; pzkS5: EPSnb: goto M1dky; AfLE3: return array(1, "操作成功"); goto QsZ57; v6xZ9: $resmsg = $res['ReMsg']; goto V8SAu; k5nw0: $set['url'] = 'parking/saveCar/'; goto ek13f; n2GLa: if (!empty($res)) { goto KGBAS; } goto k5nw0; a7gqc: return array(1, "操作成功"); goto c_RdT; x5J0v: if ($res['successCode'] == '100') { goto rNM5R; } goto EN3Bp; UfusA: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto AfLE3; IzDSc: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and id=:rid'; goto okq_S; fZDS5: goto gxUgb; goto GlV4k; WG_Ur: goto nPwjJ; goto QLuN7; MDdY4: return array(0, "未启用云停车"); goto Yzeh0; D0MUN: goto KKBal; goto KNXhm; q0rrZ: $res = deliyun_http_post($set, $params); goto PoA7z; oaF8v: if ($res['resultCode'] == '0000') { goto UVph3; } goto A_Tms; P1F_i: jB5Ba: goto u1Em_; Sq5i4: $params = array(); goto bVWAe; du2Y1: if (!empty($whitelist)) { goto My9xx; } goto CiZL0; EUuaZ: $params = array("id" => $cardno, "parkId" => $parklot['pc_plotid'], "carNum" => $parkpay['carno'], "startTime" => $startdate, "endTime" => date('Y-m-d H:i', $parkpay['endtime']), "loginUserName" => $parkpay['mobile'], "rechangeFee" => 100); goto n5GCR; Fdp8M: goto SJVM9; goto K3N7C; okq_S: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $rid)); goto vaDh_; DPdyf: jVOqn: goto cSsGX; ffIi1: $params = array("parkId" => $parklot['pc_plotid'], "type" => 1, "carNum" => $parkpay['carno']); goto xLjDU; gYYmS: $resmsg = $res['ReMsg']; goto wty_G; zMy7K: if ($res['ecode'] == 0) { goto jB5Ba; } goto zxlTK; DTGOE: goto Uxjza; goto XJLHM; FUrml: $res = etpcar_http_post($set, $params); goto NEa_A; mx7Cq: $parkios = $lanelist['LaneInfo']; goto JDK8S; Yzeh0: goto KKBal; goto WJPcG; xLjDU: $res = ipms_http_post($set, $params); goto wwboq; ZlNe0: nH0sw: goto j2ywc; TGRi_: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto a7gqc; yARuk: $set = array("url" => "parking/findCarList/", "accessKeyID" => $region['pc_appid'], "accessKeySecret" => $region['pc_secret'], "commKey" => $parklot['pc_secret']); goto gM32d; tySnr: L8T7y: goto Q0uZU; IuWGy: goto ulJkd; goto TCrkO; kiKrb: goto GDCMP; goto oHdYJ; u1Em_: $res = $res['data']; goto n2GLa; HdZPY: if (empty($rows)) { goto htpfP; } goto N356g; i6rvS: $params = array("CarNo" => $parkpay['carno'], "UserName" => $parkpay['realname'], "OperType" => "Add", "Fee" => 100, "StartTime" => date('YmdHis', $parkpay['starttime']), "EndTime" => date('YmdHis', $parkpay['endtime']), "CarType" => "月卡A", "CardStatus" => 0, "Balance" => 0, "MachList" => $machlist, "SetNo" => "000"); goto FFEEK; NEa_A: $resmsg = $res['ReMsg']; goto xv1b5; WrnsR: $set = array(); goto mkC3y; GlV4k: rNM5R: goto CDyWP; aHy0A: return array(0, '操作异常' . $res['MsgStr']); goto Fdp8M; Szjya: if ($res['resultCode'] == '0000') { goto n_S9p; } goto R_kuh; nOAk8: $set['url'] = 'app/UpMonCar.aspx'; goto i6rvS; i2Vbf: foreach ($parkios as $vio) { $machlist .= $vio['MachNo'] . '_'; mDayB: } goto eLWpt; i9BNr: $set = array(); goto WKHKJ; Jb5Re: return array("code" => 1, "msg" => "操作成功"); goto tySnr; ez8pB: dQAKn: goto C1ytZ; gBseG: return array(0, "未启用云停车"); goto tlTn1; WKHKJ: $set['pc_appid'] = $region['pc_appid']; goto boxHw; Gc9K2: YFdDo: goto vbtaw; mkC3y: $set['userId'] = $region['pc_appid']; goto FvXSk; ZzGIp: $set['url'] = 'third_api/monthCardAppAction_create.action'; goto x84e3; HdKHs: if ($parklot['pc_type'] == 4) { goto bUIYF; } goto vxwX8; FFEEK: $res = etpcar_http_post($set, $params); goto v6xZ9; VsyMv: $set['url'] = 'api/queryCreatMonthCardData.action'; goto ffIi1; iM5St: goto B0r36; goto P1F_i; KtYXT: $data_white = array("weid" => $parkpay['weid'], "parklotid" => $parkpay['parklotid'], "starttime" => $parkpay['starttime'], "endtime" => $parkpay['endtime'], "carno" => $parkpay['carno'], "mobile" => $parkpay['mobile'], "realname" => $parkpay['realname'], "idcard" => $parkpay['idcard'], "status" => 1, "cuid" => $parkpay['cuid'], "ctime" => TIMESTAMP); goto lXuiJ; j2ywc: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto LsYU1; qmd5l: if (empty($res)) { goto Xh95j; } goto TDQ2e; Vfzr9: return array(1, "操作成功"); goto lfGP7; UACHk: $params = array(); goto bPc7Q; ClLRr: goto e2zQK; goto v6BKK; Q0uZU: GDCMP: goto kH_5m; V8SAu: if ($resmsg['ErrNo'] == '0000') { goto nH0sw; } goto PhMIY; TMhSz: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto Jb5Re; O3iVj: $set = array("url" => "app/getLaneList.aspx", "parkno" => $parklot['pc_plotid'], "secret" => $parklot['pc_secret']); goto UACHk; boxHw: $set['pc_secret'] = $region['pc_secret']; goto VsyMv; SCDwP: $whitelist = pdo_get('rhinfo_zyxq_car_whitelist', array("weid" => $parkpay['weid'], "parklotid" => $parkpay['parklotid'], "carno" => $parkpay['carno'])); goto du2Y1; xOOfO: return array(1, "操作成功"); goto wEkOa; vaDh_: $parklot['pc_type'] = !empty($parklot['pc_type']) ? $parklot['pc_type'] : $region['pc_type']; goto L7rTM; bPc7Q: $res = etpcar_http_post($set, $params); goto gYYmS; sGN86: $params = array(); goto l2aH8; PDe9W: daloX: goto WrnsR; LsYU1: return array(1, "操作成功"); goto ez8pB; aSZ3g: $startdate = date('Y-m-d', strtotime($res['tpStartTime'])); goto CX8zn; vxwX8: if ($parklot['pc_type'] == 5) { goto hMz78; } goto V1y0s; bVWAe: $params['searchParamsItems'] = array(array("name" => "rows", "value" => 1), array("name" => "page", "value" => 1), array("name" => "plgId", "value" => $parklot['pc_plotid']), array("name" => "licensePlate", "value" => $parkpay['carno'])); goto PXcww; ZQ3UM: $res = json_decode(urldecode($res['data']), true); goto qmd5l; lXuiJ: $res = pdo_insert('rhinfo_zyxq_car_whitelist', $data_white); goto FR2QJ; Uqz69: if ($res) { goto VpMAk; } goto N_szv; BHVcU: U7_jN: goto ZQ3UM; Nia97: goto L8T7y; goto Oj5BJ; XJLHM: n_S9p: goto TGRi_; yjAxm: KGBAS: goto svxhq; cCxO5: if ($res['successCode'] == '100') { goto Kzldc; } goto d0xX2; Z7r2A: goto vIrVv; goto OWigB; ratTr: goto EPSnb; goto as2gO; W4lH1: $res = icar_post_editcarid($set, $params); goto cCxO5; LfOqS: goto KKBal; goto yDjhE; KNXhm: tZ53K: goto SCDwP; QLuN7: VpMAk: goto yW_U1; zfJuP: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $parkpay['weid'], "id" => $parkpay['id'])); goto VcLf_; Yx1gL: goto zqD2M; goto Gc9K2; v6BKK: My9xx: goto KtYXT; d0xX2: return array(0, $res['result'] . $res['errorCode']); goto IuWGy; XzI09: if (!empty($res)) { goto jVOqn; } goto evxZs; CiZL0: $data_white = array("starttime" => $parkpay['starttime'], "endtime" => $parkpay['endtime'], "mobile" => $parkpay['mobile'], "realname" => $parkpay['realname'], "idcard" => $parkpay['idcard'], "status" => 1, "cuid" => $parkpay['cuid']); goto oSYZq; PoA7z: if ($res['ecode'] == 0) { goto YFdDo; } goto uqTyr; N_szv: return array(0, "操作失败"); goto WG_Ur; QsZ57: SJVM9: goto iMUst; l2aH8: $params['updateCreateParamItems'] = array(array("name" => "plgId", "value" => $parklot['pc_plotid']), array("name" => "name", "value" => $parkpay['carno']), array("name" => "licensePlateType", "value" => 0), array("name" => "licensePlate", "value" => $parkpay['carno']), array("name" => "expireTime", "value" => date('Y-m-d', $parkpay['endtime']) . ' 00:00:00')); goto hS9xP; ftx1A: L_Lr4: goto ratTr; A41J6: goto YZXD8; goto BHVcU; TCrkO: Kzldc: goto CQe8t; M4_VX: $params['updateCreateParamItems'] = array(array("name" => "id", "value" => $rows['id']), array("name" => "name", "value" => $parking['carno']), array("name" => "expireTime", "value" => date('Y-m-d', $parkpay['endtime']) . ' 00:00:00')); goto W4lH1; Oj5BJ: COmMK: goto TMhSz; QJ1e8: if ($parklot['pc_type'] == 2) { goto enyOk; } goto xKIyc; yz1rQ: goto p0Ho1; goto yjAxm; hS9xP: $res = icar_post_createcarid($set, $params); goto DmTmc; R_kuh: return array(0, $res['resultMsg']); goto DTGOE; GI_ug: B0r36: goto D0MUN; OWigB: s_zL6: goto zfJuP; yKUtC: vIrVv: goto yz1rQ; CKvGo: UVph3: goto J4Ya0; VcLf_: return array(1, "操作成功"); goto yKUtC; iMUst: goto dQAKn; goto ZlNe0; la2_O: if ($res['ecode'] == 0) { goto s_zL6; } goto Vp08L; SAD4T: } public function successResult($data) { goto gb1l8; Gj21g: $message = 'sucess'; goto N5a6D; N5a6D: exit(json_encode(array("errno" => $errno, "message" => $message, "result" => $data))); goto ZwzbK; gb1l8: $errno = 0; goto Gj21g; ZwzbK: } public function errorResult($message) { goto R3Bud; c7xLD: exit(json_encode(array("errno" => $errno, "message" => $message, "result" => $data))); goto kxqfx; R3Bud: $errno = 1; goto sX41v; sX41v: $data = ''; goto c7xLD; kxqfx: } public function payResult($params) { goto Fq09u; oyAe0: if (!($region['payrate'] > 0 && $region['paycost'] > 0 && $region['paycredit'])) { goto uTguN; } goto v50h5; HScZ6: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto c5eGx; vtUpW: if (!($this->syscfg['cost'] > 0 && $this->syscfg['credit'] > 0)) { goto ReUiN; } goto ovMP3; nnTy9: if ($resmsg['ErrNo'] == '0000') { goto mRPJW; } goto brtYg; MAC0T: goto Y16PZ; goto Gul4R; NaXfv: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_parkingio') . ' where status=1 and weid = :weid and id=:id '; goto XTs8T; fEqDV: MoN8i: goto D0VO1; ft21c: ekJ6d: goto jAGBt; Noug0: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto DnKHX; aSYoO: ReUiN: goto cwNp8; hzL0T: $mywechat['apiclient_key'] = $this->syscfg['apiclient_key']; goto BEEAk; Nvuud: T7grg: goto sJkYP; ojd3F: $minutes = intval($timediff % 86400 % 3600 / 60); goto jiykw; eXxdi: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and pid=:pid and  id = :rid '; goto V5WTQ; kcy2M: $res = $this->opendoor($this->syscfg['doortype'], $inout['locksn'], $inout['lockid']); goto YipEy; YfUao: $url = $this->createMobileUrl('home', array("op" => "index")); goto erSFp; q2ZC7: pdo_insert('rhinfo_zyxq_paylog', $data); goto aODPu; DQVX_: $url = $this->my_mobileurl($this->createMobileUrl('member', array("op" => "index"))); goto Bva4U; XRWTx: InYTM: goto vuMjq; LNB7s: $smslog_data = array("weid" => $log['uniacid'], "sid" => 0, "compid" => $tag['compid'], "expid" => 0, "title" => '短信充值' . $tag['smsqty'] . '条', "io" => 1, "mobile" => "", "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto qIdKb; aw4Qx: $res = mc_credit_update($tag['payuser'], 'credit1', $getcredit, array(0, "消费送积分", "rhinfo_zyxq")); goto ryL41; MRq0q: HEy8h: goto uaJTX; qd59B: $paymethod1 = '支付方式:支付宝<BR>'; goto dF8zE; eVQS8: pdo_query($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto wt0Ie; xSGEk: fO1iO: goto DGbZU; Zi0uT: pdo_insert('rhinfo_zycj_platform_credit_log', $plat_data); goto subZz; R1H4B: if ($task['redcate'] == 2) { goto w5sMs; } goto vjlrg; ig2_t: goto l5gtx; goto AQVN8; nWa10: xCgv_: goto Qy7ke; tmeeX: if ($park['pc_type'] == 3) { goto XAbVE; } goto YVRID; dF8zE: RWIbe: goto Iww7n; wMTPk: $data['weid'] = $log['uniacid']; goto Ui7UC; d4OY2: if ($log['type'] == 'wechat') { goto FdX6D; } goto ML5Xd; R6ea8: $getcredit = $credit - $retcredit; goto HJ1pB; PQcbz: if (!(!empty($business['credit']) && !empty($business['cost']))) { goto U9Z7V; } goto qITnC; giQY6: if (empty($this->syscfg['businesstplid'])) { goto wig4n; } goto DN7s1; k3fv9: $post_data['out_trade_no'] = $params['uniontid']; goto MqRpk; UKzY4: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto qvIbn; INHzU: if (!($params['from'] == 'return')) { goto YWLPo; } goto uAt0q; Xvrye: $sql = 'select min(enddate) from ' . tablename('rhinfo_zyxq_carbill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto VHZlY; byYDf: MB12K: goto jPK1u; DkCYe: $this->mysyslog(0, 'error', '停车办理月卡', '月卡建立或延期失败' . $tag['carno'], '操作失败'); goto iNYWJ; b1E4D: ZyT1z: goto Xh5yr; yClKm: ZjFIW: goto NnJet; LKbug: PvLFx: goto hV5pm; pQ3x1: mc_credit_update($tag['payuser'], 'credit1', $credit, array(0, "充值送积分", "rhinfo_zyxq")); goto SUsQY; cNOM_: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto QGU2G; vZRI9: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto kKSNo; } goto d7aWL; EL4yW: WLwdV: goto uEXMp; xsEC3: $res = posei_http_post($set, $post_data); goto u1PyK; LQvK7: $property = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_property') . ' where weid=:weid and id=:pid', array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto ZBrx7; CWF1a: $totalfee = $fee * (1 + $this->syscfg['credit2'] / 100); goto N_oa_; t9Tqu: $content .= '金额:' . $fee . '元\\n'; goto E3na_; xZ8ai: if (empty($this->syscfg['businesstplid'])) { goto TlezI; } goto eS8KC; j0rwp: sj4jZ: goto dFIqF; DU7gX: Y16PZ: goto UWVug; EHYFk: if (empty($this->syscfg['businesstplid'])) { goto GcVzp; } goto VoD70; J9uez: if (!($tag['feetype'] == 19)) { goto vfP01; } goto ZBfGN; RhBZ9: $mycredit = intval($creditfee * $creditset['paycredit'] / $creditset['paycost']); goto cFYye; HaNeg: mFwvi: goto QFjK5; kJhlO: pdo_query($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto XPTn_; tRil0: $postdata = array("first" => array("value" => $park['title'] . '(' . $park['address'] . ')'), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '停车时间' . $timestr . ',感谢支持')); goto XAdAM; jgz4a: $printpznum = $pznopre . $printpznum; goto P_e82; BLW02: $data['status'] = $params['result'] == 'success' ? 1 : 0; goto l0P1p; DSOkI: $post_data = array("action" => "SendIns", "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid'], "port" => sprintf('%02d', $tag['port']), "pluse" => sprintf('%02d', $tag['plus']), "device_code" => $charging['devicesn']); goto QaCUL; PxMuB: if ($res) { goto TJ7p4; } goto DkCYe; GWhps: $params = array("parkId" => $parklot['pc_plotid'], "type" => 1, "carNum" => $tag['carno']); goto N3PHu; fRXPB: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":carno" => $tag['carno'])); goto oJaCf; eFWYc: Cmcix: goto YccGQ; ikEjx: AAeVH: goto YQmpw; x33Nv: $res = $this->send_print($tag['pid'], $tag['rid'], 4, urlencode($content), $content1); goto NNnnQ; axbft: if ($park['parktype'] == 1) { goto I41eI; } goto kcy2M; RBPY6: $credit_data = array("weid" => $log['uniacid'], "bid" => $tag['businessid'], "io" => 2, "credit" => $credit, "title" => "消费送积分", "openid" => $log['openid'], "cuid" => 0, "ctime" => TIMESTAMP); goto xm0ju; yfn9E: $res = deliyun_http_post($set, $params); goto m_ZgL; WeskT: $res = json_decode(urldecode($res['data']), true); goto iL1Qd; ohsdK: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto X7Jhb; qvIbn: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto AQLKl; AkOp8: $data['billid'] = $feebillid; goto MFodO; Jqm6k: if (empty($this->syscfg['tplid1'])) { goto mdq3K; } goto paPWj; AmP2d: $park = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'], ":parkid" => $tag['parkid'])); goto VyMfu; Ui7UC: $data['uid'] = $tag['payuser']; goto Y9qZU; HzwID: $sql = 'select * from ' . tablename('rhinfo_zycj_platform_credit') . ' where weid=:weid'; goto x3DwU; J4_g0: goto wOMbV; goto fYfIv; v50h5: $iscreditpay = 1; goto m1ZF8; GxbRg: $url = $this->createMobileUrl('business', array("op" => "mindex", "id" => $tag['bid'])); goto YoBeZ; xKCOH: $this->send_mysendtplnotice($log['openid'], $this->syscfg['tplid1'], $postdata, $url, $topcolor); goto GztDp; xJeWl: yVvlI: goto wC3kB; wlNCA: GXeSb: goto muR1P; cBjrL: $data_bill['enddate'] = strtotime($enddate); goto DUfJT; ITvdP: mc_notice_recharge($log['openid'], $tag['payuser'], $fee, $url, '谢谢支持，点击查看详情'); goto v2lU3; CRslY: jWx3z: goto FZaMV; RnCmr: $sql = 'select t.* from ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.weid=:weid and t.pid = :pid and t.rid = :rid and c.right12=1 and c.type=4'; goto zzvQT; hGDfR: $region = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto he1yH; AdOvH: $url = $this->my_mobileurl($this->createMobileUrl('home')); goto yXMMm; Pz2tU: if (empty($region['ylbid'])) { goto Ytz2c; } goto Epvc4; wb7cY: if (!$res) { goto Dq7wU; } goto tGCsc; fmsRN: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto Kw42l; X3idj: $set['pc_secret'] = $region['pc_secret']; goto RMLyg; IRi8j: if (!($tag['feetype'] == 16)) { goto p1Eae; } goto mePfG; BCxuL: exit; goto B0pQv; pywZi: $business = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":id" => $tag['bid'])); goto bilmZ; p7DWc: gt_47: goto KxkrC; OWs1N: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto YLrGq; MFodO: $data['ctime'] = TIMESTAMP; goto tc6pF; pRg3m: header('Location:' . $url); goto vOb1q; xNMRe: n35kH: goto wLmwA; IT3uL: $member = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'], ":mobile" => $tag['mobile'])); goto troGt; w62sM: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto LhYpI; Z2R_b: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto lEBHY; EtiHk: $url = $this->my_mobileurl($url); goto IYktf; DMA0W: pdo_update('rhinfo_zyxq_parking', $data_parking, array("id" => $tag['parkingid'], "weid" => $log['uniacid'])); goto jcO7_; OYDvC: myload()->model('member'); goto jfzqc; KNldM: if (!empty($secuser)) { goto GNkwz; } goto BOuMq; xpwsm: mlrYl: goto LoyXF; nsark: $data_parkpay = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "parklotid" => $tag['parkid'], "title" => "出入缴费", "category" => 3, "starttime" => $tag['intime'], "endtime" => TIMESTAMP, "carno" => "无牌车", "fee" => $fee, "mobile" => "", "realname" => "", "payno" => $tag['ordersn'], "status" => 0, "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto YX6m6; VPk_W: mc_notice_credit1($log['openid'], $tag['payuser'], $getcredit, '消费送积分', $url, '谢谢惠顾，点击查看详情'); goto TV_H4; kndo5: $sql = ' select * from ' . tablename('rhinfo_zyxq_member') . ' where weid = :weid and pid = :pid and rid = :rid and mobile=:mobile and category=1 and deleted=0 and status=1'; goto IT3uL; Dg3U5: $mywechat['mch_id'] = $wechat['mchid']; goto gKYv7; YtjxD: k2DsQ: goto nx3Yt; okXM9: if ($res['result'] == 'success') { goto s1X75; } goto mAxWo; cuE7E: if (empty($parklot['pc_plotid'])) { goto qX7jj; } goto ovpJa; PKPF1: $parkshare = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":id" => $tag['shareid'])); goto Z_xoj; nIn0O: $postdata = array("first" => array("value" => $park['title'] . '(' . $park['address'] . ')'), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '停车时间' . $timestr . ',感谢支持')); goto xZ8ai; crJdb: $daterange = date('Y-m', $mindate) . '~' . date('Y-m', $maxdate); goto XKS5c; yaIsD: $content1 .= '周期:' . $daterange . '<BR>'; goto T24df; sYvF_: $sql = 'select * from ' . tablename('rhinfo_zyxq_parkinglot') . ' where weid = :weid and rid=:rid and  id = :parkid '; goto sDvpe; mQunj: $set['yk_appid'] = $this->syscfg['yk_appid']; goto cqaUY; d5IEN: if ($res['ecode'] == 0) { goto XEKKx; } goto sm2yT; KBgC7: if ($this->syscfg['iswepay'] == 1) { goto dX9qa; } goto L1TsB; DnJXF: if (!($business['retcredit'] > 0 && $business['retcredit'] < 100)) { goto FMXXa; } goto ueve4; Hpswk: if (!($iscreditpay == 1)) { goto w74qb; } goto RhBZ9; bZaZS: $senddetail = ''; goto E8uPZ; pYUkN: $sql = 'select * from ' . tablename('rhinfo_zycj_express_store') . ' where weid=:weid and id = :id'; goto IB87w; rLjnJ: $url = $this->my_mobileurl($this->createMobileUrl('express', array("op" => "mindex", "sid" => $tag['sid']))); goto bJ16u; a2RAf: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $log['uniacid'], "id" => $parkpayid)); goto i51sb; ueve4: $retcredit = round($credit * $business['retcredit'] / 100, 2); goto VCw34; k6DDA: wOMbV: goto t2p4r; lVvcj: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_mycar') . ' where weid=:weid and uid=:uid and carno=:carno'; goto BZuFx; YQmpw: exit; goto ZrI8X; tUnpZ: $paytypetxt = $this->paytype; goto zv2ia; BukiO: $charging_log['trade_no'] = $trade_no; goto rd0Xt; MDe3k: goto yVvlI; goto ft21c; KB1NT: $res = etpcar_http_post($set, $params); goto uXSfk; t2p4r: ZewHn: goto ifWRB; Iv502: $res = ylb_http_post($set, $params); goto CIjdw; WIVG0: goto L_lgz; goto TJwha; VHZlY: $mindate = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto BpFvi; OCD3L: $res = deliyun_http_post($set, $params); goto B9ySo; m_sEY: lIUP_: goto va6ag; paOAB: $timestr .= !empty($hours) ? $days . '小时' : ''; goto aYyk8; eoMsk: Qi0xN: goto lMeEP; lqpOE: $log = pdo_fetch($sql, array(":tid" => $params['tid'])); goto Qpip2; BSwUQ: if (empty($this->syscfg['businesstplid'])) { goto ri6rZ; } goto YfUao; tXEgW: $set = array(); goto NDJhE; mgGjd: $feeitemtitle = '车位租赁费'; goto ig2_t; Bva4U: header('Location:' . $url); goto qHJg2; rJ5f_: hupL9: goto cUYyu; XdmQa: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto CDrXx; LvMRS: vQ3Va: goto PxMuB; pmHtF: GNkwz: goto J0Fjv; zTlSD: if (empty($this->syscfg['businesstplid'])) { goto QQwhj; } goto e6I3p; vorwN: $data_parkpay = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "parklotid" => $tag['parkid'], "title" => "办理月卡", "category" => 2, "starttime" => strtotime($tag['startdate']), "endtime" => strtotime($enddate), "carno" => $tag['carno'], "mobile" => $tag['mobile'], "realname" => $tag['realname'], "idcard" => $tag['idcard'], "fee" => $fee, "status" => 1, "payno" => $tag['ordersn'], "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto sfNht; Pj1VB: exit; goto oXB_R; aEGCU: pdo_insert('rhinfo_zycj_express_smslog', $smslog_data); goto xSGEk; bZEfC: $smslog_data = array("weid" => $log['uniacid'], "sid" => $tag['sid'], "compid" => 0, "expid" => 0, "title" => '短信充值' . $tag['smsqty'] . '条', "io" => 1, "mobile" => "", "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto xPsX0; pjxnx: header('Location:' . $url); goto RPPzi; eB1aa: pdo_insert('rhinfo_zyxq_paylog', $data); goto OiFPw; f2Qsd: dX9qa: goto nbaOc; fsL8R: aJYN6: goto qeab_; t2wP6: $addmonths = intval($tag['qty'] / $parklot['rechargmonths']); goto UswgE; UGw5d: $rs = Mx_httpPost($url, $post_data); goto wYv8k; CaYEl: if (empty($this->syscfg['tplid1'])) { goto CBS0s; } goto PE4WW; uzVOq: if (!($params['from'] == 'return')) { goto oCZMM; } goto AdOvH; Dztiv: $set['url'] = 'parking/saveCar/'; goto mXgwU; GAoB0: XAbVE: goto AsLcN; i51sb: RXqyA: goto WW77c; EZNVJ: $row = pdo_fetch($sql, array(":acid" => $wechat['account'])); goto RecuK; mJT3y: $url = $this->my_mobileurl($this->createMobileUrl('express', array("op" => "eindex", "sid" => $tag['sid'], "compid" => $tag['compid']))); goto eLP3Y; Bg_bP: cL1sI: goto OYDvC; qHJg2: exit; goto o7UXY; hUK21: $data_bill['daterange'] = date('Y-m', $data_bill['startdate']) . '~' . date('Y-m', $data_bill['enddate']); goto Sq0ML; dFIqF: $url = $this->createMobileUrl('home'); goto EtiHk; M0u8v: foreach ($feebillids as $value) { goto Z3jh3; xqkwA: goto pKZFk; goto l8eyr; hYHIG: $feebill_data['payfee'] = 0; goto I3ZQW; TDDHF: my_alipay_life($set, $params); goto UsMkr; UsMkr: n2koD: goto jZGFe; KrCHu: $item['latefee'] = $feebill_data['latefee']; goto Tb2RC; NbBns: if ($region['latemethod'] == 1) { goto vpEtp; } goto LF1UY; Tb2RC: oRZvz: goto hHu88; XeXa3: $params = '{
							"community_id":"' . $region['lifepay_rid'] . '",
							 "bill_entry_id_list":[
								"' . $value['id'] . '"
								]
							  }'; goto TDDHF; uBnGS: AintO: goto Zk2wQ; gI58a: if ($creditfee > $item['fee'] + $item['latefee']) { goto LayM1; } goto Fp_bc; t0yEI: $feebill_data['latedays'] = $days; goto WZWOx; vCTNi: $sql = 'select * from ' . tablename('rhinfo_zyxq_feeitem') . ' where id = :id and weid = :weid'; goto lfWWP; Fp_bc: $feebill_data['payfee'] = $item['fee'] + $item['latefee'] - $creditfee; goto Ep5hk; TOr5P: $set['app_auth_token'] = $region['lifepay_token']; goto oWemZ; fhOH3: $set = array(); goto ukc8Z; Un1Yj: if (!($days > $feeitem['latedays'])) { goto oRZvz; } goto NbBns; NI28g: if (!($log['type'] != 'alipaylife' && $item['isalipay'])) { goto n2koD; } goto fhOH3; XE1MW: pdo_update('rhinfo_zyxq_feebill', $feebill_data, array("id" => $value, "weid" => $log['uniacid'])); goto PrEEx; jZGFe: jXOZw: goto vkrW8; tdg3o: Jje_C: goto dw2rx; Z3jh3: $sql = 'select * from ' . tablename('rhinfo_zyxq_feebill') . ' where id = :id and weid = :weid'; goto f_2jA; JgkIb: vpEtp: goto QQWbX; dGGKS: $senddetail .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . ','; goto NI28g; l8eyr: LayM1: goto hYHIG; YLXJ9: goto AintO; goto uED8g; XouX_: $set['prikey'] = $this->syspub['alipay_rsa2']; goto TOr5P; dw2rx: if ($item['enddate'] > $feeitem['latedate']) { goto MQboN; } goto DfJdy; LF1UY: $feebill_data['latefee'] = round($item['fee'] * $feeitem['laterate'] * $days / 1000, 0); goto HCBvp; Ep5hk: $feebill_data['creditfee'] = $creditfee; goto NKCto; hOWVE: $feebill_data = array("status" => 2, "paytype" => $paytype[$log['type']], "printpznum" => $printpznum, "paydate" => TIMESTAMP, "payuid" => $tag['payuser'], "payno" => $params['uniontid']); goto vCTNi; hQWoH: pKZFk: goto msEtY; PrEEx: $printdetail .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . '\\n'; goto KmWjK; YXInb: $feebill_data = array(); goto hOWVE; cTtr9: $days = intval((strtotime(date('Y-m-d')) - $item['enddate']) / 86400); goto uBnGS; EN1VU: goto UIywZ; goto tdg3o; Dt06E: QYn8H: goto gI58a; hHu88: if ($creditfee > 0) { goto QYn8H; } goto kVUhb; ukc8Z: $set['app_id'] = $this->syspub['alipay_appid']; goto XouX_; KmWjK: $printdetail1 .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . '<BR>'; goto dGGKS; hGV3X: iVvVv: goto t0yEI; NKCto: $creditfee = $creditfee - $item['fee'] - $item['latefee']; goto xqkwA; KGI31: goto pEApA; goto Dt06E; uED8g: MQboN: goto cTtr9; HCBvp: goto iVvVv; goto JgkIb; lfWWP: $feeitem = pdo_fetch($sql, array(":id" => $item['itemid'], ":weid" => $log['uniacid'])); goto OWlMc; f_2jA: $item = pdo_fetch($sql, array(":id" => $value, ":weid" => $log['uniacid'])); goto YXInb; C3o_t: $creditfee = 0; goto hQWoH; msEtY: pEApA: goto XE1MW; DfJdy: $days = intval((strtotime(date('Y-m-d')) - $feeitem['latedate']) / 86400); goto YLXJ9; OWlMc: if (!empty($feeitem['latedate'])) { goto Jje_C; } goto xl_72; QQWbX: $feebill_data['latefee'] = round($item['fee'] * $feeitem['laterate'] * ($days - $feeitem['latedays']) / 1000, 0); goto hGV3X; WZWOx: $feebill_data['laterate'] = $feeitem['laterate']; goto KrCHu; Zk2wQ: UIywZ: goto Un1Yj; oWemZ: $set['method'] = 'bill.delete'; goto XeXa3; I3ZQW: $feebill_data['creditfee'] = $creditfee; goto C3o_t; kVUhb: $feebill_data['payfee'] = $item['fee'] + $item['latefee']; goto KGI31; xl_72: $days = intval((strtotime(date('Y-m-d')) - $item['enddate']) / 86400); goto EN1VU; vkrW8: } goto UVd32; EAyZL: WX9Bg: goto I236p; djVzq: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto BSwUQ; Rv7pc: $redpacket = $this->send_redpacket($region['feestrategyid'], $log['openid'], 0); goto JifZl; lbb4z: $this->send_mysendtplnotice($this->syscfg['openid'], $this->syscfg['tplid1'], $postdata, $url, $topcolor); goto RnCmr; E3na_: $content .= '周期:' . $daterange . '\\n'; goto YQeVI; h1zTR: pdo_insert('rhinfo_zyxq_region_smslog', $smslog_data); goto HBbYX; yzb9H: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto pu1KM; IB87w: $business = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":id" => $tag['sid'])); goto HScZ6; bVwCV: if (!$res) { goto WX9Bg; } goto aH9Pp; va6ag: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $log['uniacid'], "id" => $parkpayid)); goto zb6yh; nhXe_: if (!($region['cost'] > 0 && $region['credit'] > 0 && $fee > $region['cost'])) { goto aaHjw; } goto DqL3B; Hs5Jy: $daterange = date('Y-m', $mindate) . '~' . date('Y-m', $maxdate); goto qiOUi; JdQXE: $content1 .= '缴费时间:' . date('Y-m-d h:m') . '<BR>'; goto oi4MI; uUvUo: $post_data['equipCd'] = $charging['devicesn']; goto cGatV; y7Iln: $days = intval($timediff / 86400); goto Tn1qk; E532R: Q1GYr: goto Y63It; hdwD3: $this->mysyslog(0, 'error', '停车缴费', '停车缴费支付失败', '操作失败' . $res['MsgStr'] . $tag['recordid']); goto kC1Xp; Y9qZU: $data['openid'] = $log['openid']; goto fc1jT; lTtuz: pdo_insert('rhinfo_zyxq_car', $car_data); goto wlNCA; bilmZ: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto od65H; uMdVP: $sql = 'select max(enddate) from ' . tablename('rhinfo_zyxq_feebill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto Zh7TE; ooyzC: lWq5t: goto vmo3L; GkfgT: exit; goto QOMQC; jgJa8: K4K8m: goto cuE7E; SbO_c: load()->model('mc'); goto p18LI; aPIsb: if ($res['resultCode'] == '0000') { goto MC_UJ; } goto rXENx; GQln7: $plat_data = array("weid" => $log['uniacid'], "io" => 2, "credit" => $credit, "title" => "充值送积分", "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto Zi0uT; l8PrO: $sql = 'update ' . tablename('rhinfo_zycj_express') . ' set balancestatus = 1, balancetime = ' . TIMESTAMP . ' where  weid = :weid and sid=:sid and id in (' . $tag['billids'] . ')'; goto HrOwV; Qlse6: $set['url'] = 'payOrderBack/'; goto UGxOn; airUP: $sql = 'select max(enddate) from ' . tablename('rhinfo_zyxq_leasebill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto iaTCx; ipTd9: $machlist = ''; goto iUpq8; AFGBl: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto y2ARr; xPsX0: pdo_insert('rhinfo_zycj_express_smslog', $smslog_data); goto WrQor; xqgfz: $content1 .= '房产:' . $house['title'] . '<BR>'; goto qwNhp; ZqcEX: l5gtx: goto Ap02P; Gstm7: hdZJh: goto BCxuL; w9ySL: $daterange = date('Y-m', $maxdate); goto xLn6g; pOH7s: waLdL: goto ITvdP; B9ySo: if ($res['ecode'] == 0) { goto tcH2i; } goto C1r5w; Uqmk_: $data['paytime'] = $params['paytime']; goto BLW02; HAI3l: $data['payno'] = $tag['ordersn']; goto CAOno; CSJ7n: $res = deliyun_http_post($set, $params); goto SbFfA; UQwva: header('Location:' . $url); goto P2r_y; FgUUL: goto jD0FD; goto qWV5C; YWtHV: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_mycar') . ' where weid=:weid and uid=:uid and carno=:carno'; goto fRXPB; mePfG: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto TSNvl; } goto CEkuO; ulf29: $charging_log['trade_no'] = 'ok'; goto AFGBl; uAt0q: $url = $this->my_mobileurl($this->createMobileUrl('service')); goto C5g7u; eE00u: pdo_insert('rhinfo_zycj_platform_credit_log', $plat_data); goto Ec7R1; Qpip2: UR6hl: goto fhCJQ; bFSr4: if ($parklot['pc_type'] == 8) { goto J8qLI; } goto SSUr0; KOus3: yEgk0: goto Zvo_Q; IoG3K: if ($charging['devtype'] == 4) { goto wBeT8; } goto cKRHn; XKS5c: goto SU5Ge; goto khZAt; nOnIU: if ($mindate == $maxdate) { goto REIEi; } goto VyEmn; wPE4y: $sql = 'update ' . tablename('rhinfo_zyxq_property') . ' set onhand = onhand - ' . $task['credit1'] . ', outqty= outqty + ' . $task['credit1'] . ', outtime = ' . TIMESTAMP . ' where  weid = :weid and id=:pid'; goto yHbat; xnuiR: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto jzM3c; PKxBz: HquF3: goto l1nDI; RAaHl: $params = array("plantNum" => $tag['carno'], "money" => $fee, "saleMoney" => 0); goto gjVb3; cqaUY: $set['yk_appkey'] = $this->syscfg['yk_appkey']; goto RKvz8; RMLyg: $set['url'] = 'api/queryCreatMonthCardData.action'; goto GWhps; qrUW3: $pzno = pdo_fetchcolumn($sql, array(":weid" => $mywe['weid'])); goto FijDz; NgYGa: pdo_insert('rhinfo_zyxq_car', $car_data); goto LB5zB; QN3ML: goto BAden; goto dUMM4; Kbq9P: tcH2i: goto jjCqz; hxVSl: KdFgS: goto iWLGn; MLPxM: $timestr = !empty($days) ? $days . '天' : ''; goto zrEFx; mxZ3F: BaF23: goto qHQic; MAzLF: if (!($params['from'] == 'return')) { goto MB12K; } goto mJT3y; z2Xnk: gpopn: goto u_TLX; c9Dkr: FqpA6: goto eO10r; f5meC: if (!($rs[0] == 'SUCCESS')) { goto OUXgy; } goto GbROQ; klzRO: goto w264E; goto gLsCZ; HTBK6: $url = $this->createMobileUrl('home', array("op" => "index")); goto pSwkI; G6Ps0: qX7jj: goto QEejT; cqmaF: $res = $res['data']; goto Xufmp; W9R7U: sotzh: goto J41bf; AtyZ2: $data_bill['price'] = floatval($tag['price']); goto zOjss; uXSfk: $res = $res['ReMsg']; goto LzBUq; bIJsB: IzWpJ: goto Dv9Q1; zXs4I: $credit = 0; goto vtUpW; M3cF6: $url = $this->my_mobileurl($this->createMobileUrl('home')); goto Nifu3; Z36VW: $params = array("token" => $this->syscfg['ylb_token'], "id" => $region['ylbid'], "uid" => 'rhinfo_' . $region['ylbid'], "price" => intval($fee * 100)); goto mN6Gm; GYkaZ: atnrm: goto qAM9V; gjVb3: $res = deliyun_http_post($set, $params); goto d5IEN; SJ7VU: udX9w: goto o94iE; Hm0ir: if ($parklot['pc_type'] == 1) { goto nTVqQ; } goto H89dy; oOTkE: $content1 .= '手机:' . $tag['mobile'] . '<BR>'; goto sgGyB; wzxeG: $sql = 'select * from ' . tablename('rhinfo_zyxq_location') . ' where weid = :weid and rid=:rid and  id = :lid '; goto vo53k; HVVxE: $res = $this->mxdevopen($selfdevice['devicesn']); goto zd4F8; mOA_r: $parklot = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'], ":parkid" => $tag['parkid'])); goto H1PL4; qOLkn: if (!($park['pc_type'] == 3)) { goto SuZGe; } goto KTRcL; N_oa_: vN0AH: goto xK7ZH; UbUbG: if (!($this->syscfg['cost'] > 0 && $this->syscfg['credit'] > 0)) { goto oIlTB; } goto ExSx4; Udf1N: pdo_insert('rhinfo_zycj_business_creditlog', $credit_data); goto o5lSh; ROzgj: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $log['uniacid'], "id" => $parkpayid)); goto uHW7x; wt0Ie: $credit_data = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "io" => 2, "credit" => $feecredit, "title" => "缴费送积分", "openid" => $log['openid'], "status" => 1, "cuid" => 0, "ctime" => TIMESTAMP); goto cRXIu; tvKCJ: $set['url'] = 'BCStandard/open/pubApi/payStatusSa'; goto uFmzH; uaJTX: $timediff = TIMESTAMP - $tag['intime']; goto bdtUq; YLrGq: GXIFS: goto xixRf; X2Ht8: $url = $this->createMobileUrl('home', array("op" => "index")); goto zHRLE; Pefeh: I41eI: goto k1tif; BYhOa: $totalfee = $fee; goto elxtt; jdIHk: $credit = intval($fee * $business['credit'] / $business['cost']); goto ZD5rY; ZYqcI: $charging_log['trade_no'] = $post_data['ordersn']; goto Vp0_s; WW77c: pdo_update('rhinfo_zyxq_parkingiolog', array("status" => 1), array("weid" => $log['uniacid'], "lotid" => $tag['parkid'], "io" => 1, "uid" => $tag['payuser'])); goto J5yRH; sdg34: $url = $this->createMobileUrl('home', array("op" => "index")); goto opDv4; dbzpf: if ($res['ErrNo'] == '0000') { goto zMcYW; } goto hdwD3; EA2fX: if (!($log['type'] == 'alipay')) { goto RWIbe; } goto ri0cA; dDt94: goto Ip87H; goto dXI70; dIuVG: vloRY: goto HyHtt; JSDOF: goto j1ARm; goto Nvuud; Ehytw: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto eQaGm; u_TLX: if (!($tag['feetype'] == 9)) { goto skYzn; } goto ooSp0; DyMoG: $url = $this->createMobileUrl('home'); goto D0ed0; DGbZU: goto nVHX_; goto fEqDV; IVwRt: header('Location:' . $url); goto nxLKa; c7GDZ: $secuser = pdo_fetchall($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto pmHtF; hJNPZ: TVIsC: goto GkfgT; h2vso: $parent = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":taskid" => $task['id'], ":parentid" => $task['parentid'])); goto yq_j3; w9piy: if ($res['ErrNo'] == '0000') { goto dZzkM; } goto xTdOp; BxiO8: $url = $this->createMobileurl('business', array("op" => "index", "id" => $tag['bid'])); goto SzIt_; qmdsZ: pdo_insert('rhinfo_zyxq_paylog', $data); goto fB34R; Y63It: if (!($tag['feetype'] == 21)) { goto YtZX8; } goto gxbie; peqPn: pdo_insert('rhinfo_zyxq_parkpay_log', $data_parkpay); goto WdhQ9; KtHeE: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto jObQb; } goto c9xMy; qeab_: exit; goto TzYo9; wkiPC: $timestr = !empty($days) ? $days . '天' : ''; goto paOAB; D9HJg: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto aw4Qx; am2sS: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto gJyXl; } goto E4D7D; cUYyu: if (!($task['rewardtype'] == 3)) { goto WofNg; } goto DR8Mb; uBh__: $postdata = array("first" => array("value" => "月卡延期异常通知"), "keyword1" => array("value" => $tag['carno'], "color" => $topcolor), "keyword2" => array("value" => date('Y-m-d H:i'), "color" => $textcolor), "keyword3" => array("value" => '操作失败' . $resmsg['ErrMsg'], "color" => $textcolor), "remark" => array("value" => "月卡延期失败，请确认！")); goto CaYEl; c7TNJ: pdo_insert('rhinfo_zyxq_mycar', $data_car); goto s9yw9; elxtt: if (!($this->syscfg['cost'] > 0 && $this->syscfg['credit2'] > 0)) { goto vN0AH; } goto CWF1a; NHhen: Eicx6: goto eQxG6; JwKQt: if (!($params['from'] == 'return')) { goto R6R47; } goto gJPbT; deE1Q: $data_white = array("starttime" => strtotime($tag['startdate']), "endtime" => strtotime($tag['enddate'] . ' 23:59:59'), "mobile" => $tag['mobile'], "realname" => $tag['realname'], "idcard" => $tag['idcard'], "status" => 1, "cuid" => $tag['payuser']); goto V585n; byY6B: e01ET: goto k6DDA; RQQUp: if (!($res['return_code'] == 1 && $res['result_code'] == 1)) { goto PaIAa; } goto ylMdZ; rlYY3: goto KnRBS; goto vfmo_; ZANCL: $sql = 'update ' . tablename('rhinfo_zycj_express_person') . ' set smsqty = smsqty +' . $tag['smsqty'] . ' where weid=:weid and id=:expid'; goto DQCIf; RArrW: $content1 .= '房产:' . $tag['title'] . '<BR>'; goto kr_hR; asWNp: pdo_query($sql, array(":weid" => $log['uniacid'], ":bid" => $tag['businessid'])); goto RBPY6; hawCn: $sql = 'select * from ' . tablename('rhinfo_zyxq_parkinglot') . ' where weid = :weid and rid=:rid and  id = :parkid '; goto mOA_r; iNYWJ: goto MtUMg; goto pQGnB; iL1Qd: if (empty($res)) { goto iX021; } goto tU3oK; aSfjn: $url = $this->createMobileUrl('home', array("op" => "index")); goto nm4z6; PLyHQ: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and pid=:pid and  id = :rid '; goto ct43S; lMeEP: exit; goto wMf1C; P_e82: $creditfee = $tag['creditfee']; goto vFkFx; Ou2sE: header('Location:' . $url); goto Pj1VB; oUpfR: $set['ds_appkey'] = $this->syscfg['ds_appkey']; goto pbr4I; ObZ4e: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto x7Y0w; ET5w3: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto HaNeg; QIAn7: $addmonths = intval($tag['qty'] / $parklot['rechargmonths']); goto pzZvB; ZonDu: $pzno = pdo_fetchcolumn($sql, array(":weid" => $mywe['weid'])); goto kObty; YF31i: if (!($parklot['rechargmonths'] > 0 && $parklot['givemonths'] > 0)) { goto KdFgS; } goto P3aOO; Fq09u: global $_W, $_GPC; goto SbO_c; wYv8k: if (!($rs[0] == 'SUCCESS')) { goto VmdjH; } goto ZYqcI; M2hn3: $hours = intval($timediff % 86400 / 3600); goto rDBvY; u2rib: exit; goto pqiVy; EtfA3: $smslog_data = array("weid" => $log['uniacid'], "sid" => 0, "compid" => 0, "expid" => $tag['expid'], "title" => '短信充值' . $tag['smsqty'] . '条', "io" => 1, "mobile" => "", "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto aEGCU; NIYJ3: goto KB371; goto lEsyL; lcGRV: if (!($total == 0)) { goto sotzh; } goto b6KGf; Gopht: $hours = intval($timediff % 86400 / 3600); goto NkFlD; b29VC: if (!($credit > 0)) { goto waLdL; } goto pQ3x1; pQGnB: TJ7p4: goto yzb9H; iiItR: $hours = intval($timediff % 86400 / 3600); goto ojd3F; YnkFA: $data['feetype'] = $tag['feetype']; goto HAI3l; iaExA: $content1 .= '金额:' . $fee . '元<BR>'; goto yaIsD; HQmwI: foreach ($feebillids as $value) { goto DK_iq; HOncT: $printdetail .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . '\\n'; goto GzWAU; Ii_G3: $senddetail .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . ','; goto CT3H5; a2s6P: pdo_query($sql, array(":weid" => $log['uniacid'], ":billid" => $value)); goto xff1W; DK_iq: $sql = 'update ' . tablename('rhinfo_zyxq_carbill') . ' set status = 2, payfee = ' . $fee . ', paytype = ' . $paytype[$log['type']] . ', paydate = ' . TIMESTAMP . ', payuid =' . $tag['payuser'] . ', printpznum="' . $printpznum . '", payno="' . $params['uniontid'] . '" where  weid = :weid and id=:billid'; goto a2s6P; cH0dK: $set['app_id'] = $this->syspub['alipay_appid']; goto C9drk; P5Cp6: Az09R: goto hCdSm; CT3H5: if (!($log['type'] != 'alipaylife' && $item['isalipay'])) { goto Az09R; } goto riH0Y; xff1W: $sql = 'select * from ' . tablename('rhinfo_zyxq_carbill') . ' where id = :id and weid = :weid'; goto lh7zB; k033n: $set['app_auth_token'] = $region['lifepay_token']; goto JviNQ; C9drk: $set['prikey'] = $this->syspub['alipay_rsa2']; goto k033n; hCdSm: n5YDd: goto ZbgyI; lh7zB: $item = pdo_fetch($sql, array(":id" => $value, ":weid" => $log['uniacid'])); goto HOncT; bdRus: $params = '{
							"community_id":"' . $region['lifepay_rid'] . '",
							 "bill_entry_id_list":[
								"' . $value['id'] . '"
								]
							  }'; goto Oas0t; Oas0t: my_alipay_life($set, $params); goto P5Cp6; JviNQ: $set['method'] = 'bill.delete'; goto bdRus; riH0Y: $set = array(); goto cH0dK; GzWAU: $printdetail1 .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . '<BR>'; goto Ii_G3; ZbgyI: } goto Nnt67; YoBeZ: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto VLiRN; OKUOp: dXxLq: goto J4_g0; lMk_N: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto xNMRe; s8aZY: $url = $this->my_mobileurl($this->createMobileUrl('manage')); goto pRg3m; J77Fh: if ($task['minamount'] > 0 && $task['maxamount'] > 0) { goto zbz2H; } goto ys2rR; jfzqc: $house = get_mobile_house($tag['rid'], $tag['mobile'], 'room'); goto uWFvf; pYdEL: PTVJQ: goto GgLkE; b6KGf: $mycar_data = array("weid" => $log['uniacid'], "uid" => $tag['payuser'], "openid" => $log['openid'], "carno" => $tag['carno'], "ctime" => TIMESTAMP); goto L8oZE; z8uCz: w264E: goto xpwsm; V5WTQ: $region = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto DX4SV; aDkdp: $res = mc_credit_update($tag['payuser'], 'credit1', $feecredit, array(0, '缴费' . $fee . '送' . $feecredit . '积分', "rhinfo_zyxq")); goto pmrXF; kfUR3: v43R3: goto xd33P; cA3oW: if (!($region['feestrategyid'] > 0)) { goto yjgnB; } goto Rv7pc; Q_b2_: if (!$res) { goto xCgv_; } goto JRplP; PE4WW: $url = $this->createMobileUrl('car', array("op" => "remonthcard", "id" => $parkpayid)); goto lFNMj; RecuK: $mywechat['appid'] = $row['key']; goto Dg3U5; l8VTf: goto dXxLq; goto R5EIU; HXVX4: $sql = 'update ' . tablename('rhinfo_zycj_express_store') . ' set smsqty = smsqty +' . $tag['smsqty'] . ' where weid=:weid and id=:sid'; goto j7uIU; ige6Y: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and pid=:pid and  id = :rid '; goto PWSZo; gnQPu: $data['bid'] = $tag['bid']; goto CFWXB; H4LNj: EheNW: goto Sfvpu; V3HU2: if (!($total == 0)) { goto EheNW; } goto nCSuC; Mb4Cw: $mywechat['apiclient_cert'] = $this->syscfg['apiclient_cert']; goto hzL0T; zSSF5: $this->mysyslog(0, 'error', '停车办理月卡', '月卡建立失败' . $tag['carno'], '操作失败' . $resmsg['ErrMsg']); goto dDt94; MeBNU: $postdata = array("first" => array("value" => $business['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => "请查看详情")); goto M7Gvt; l2xXX: $sql = 'select t.*,m.parentid from ' . tablename('rhinfo_zycj_task_member') . ' as m left join ' . tablename('rhinfo_zycj_task') . ' as t on m.taskid=t.id where m.weid=:weid and m.parentid >0 and m.status=0 and t.category=2 and (m.uid=:uid or m.openid=:openid)'; goto OziDg; BLGE9: header('Location:' . $url); goto yClKm; GztDp: mdq3K: goto ynHJc; Ec7R1: $credit_data = array("weid" => $log['uniacid'], "bid" => $tag['bid'], "io" => 1, "credit" => $credit, "title" => "购买积分", "fromopenid" => 0, "toopenid" => 0, "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto Udf1N; vuMjq: $sql = 'select * from ' . tablename('rhinfo_zycj_charging_rule') . ' where weid=:weid and chargid = :chargid and id=:ruleid'; goto E5QGu; GUhr3: if (!($res['code'] == '0')) { goto lRDHG; } goto H2wtj; oLpki: $data_bill['daterange'] = date('Y-m-d', $data_bill['startdate']) . '~' . date('Y-m-d', $data_bill['enddate']); goto FgUUL; VLiRN: $this->send_mysendtplnotice($business['openid'], $this->syscfg['businesstplid'], $postdata, $url, $topcolor); goto LqOm3; XilE3: if (empty($tag['expressid'])) { goto M8AcJ; } goto WOcbm; GtCu8: if (!($parklot['rechargmonths'] > 0 && $parklot['givemonths'] > 0)) { goto gslou; } goto mldI8; a6td7: $params = array("id" => $cardno, "parkId" => $parklot['pc_plotid'], "carNum" => $tag['carno'], "startTime" => $startdate, "endTime" => $enddate, "loginUserName" => $tag['mobile'], "rechangeFee" => $fee * 100); goto UhA8T; cDAIo: $url = $this->createMobileUrl('home', array("op" => "index")); goto UKzY4; dj5YP: Pbv6W: goto dXCUr; DmObd: if (!($fee >= $business['cost'])) { goto CGCwv; } goto jdIHk; QVYAY: goto yVvlI; goto XRWTx; zb6yh: $timediff = TIMESTAMP - $tag['intime']; goto y7Iln; JYGpU: if (!($params['from'] == 'return')) { goto jWx3z; } goto qRWXG; LzBUq: if ($res['ErrNo'] == '0000') { goto lIUP_; } goto v5wjX; Herkk: $set = array(); goto GOEel; uR_vo: $pzno = pdo_fetchcolumn($sql, array(":weid" => $mywe['weid'])); goto cRO1u; JifZl: yjgnB: goto eb9_F; tVVU2: $sql = 'update ' . tablename('rhinfo_zycj_business') . ' set onhand = onhand - ' . $credit . ', outqty= outqty + ' . $credit . ', outtime = ' . TIMESTAMP . ' where  weid = :weid and id=:bid'; goto asWNp; Lgnz4: if (!(!empty($_W['setting']['site']['key']) && $this->syscfg['isworkersound'])) { goto oOb4V; } goto wpnQR; po4hM: $crediturl = $this->createMobileurl('member', array("op" => "credit1")); goto zLYZ1; waqrJ: $url = $this->my_mobileurl($this->createMobileUrl('service')); goto o9Ala; cKRHn: goto yVvlI; goto cD3Iv; xz_0y: $mindate = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto uMdVP; Ahxu0: $params = array(); goto Z9UJI; U2B3K: $res = $this->send_print($tag['pid'], $tag['rid'], 3, urlencode($content), $content1); goto Lgnz4; BEEAk: $mywechat['rootca'] = $this->syscfg['rootca']; goto jdLQi; uWFvf: $daterange = $tag['startdate'] . '~' . $tag['enddate'] . ' 23:59:59'; goto HybXf; DWELB: $content1 .= '缴费金额:' . $fee . '元<BR>'; goto CqB7K; Nqolh: $timestr .= !empty($hours) ? $hours . '小时' : ''; goto aPTRq; jAGBt: $sql = 'select * from ' . tablename('rhinfo_zycj_charging_rule') . ' where weid=:weid and chargid = :chargid and id=:ruleid'; goto GFjxz; oatLz: if ($this->syscfg['isplatformcredit']) { goto oayBo; } goto l_c7a; CiAqg: M8AcJ: goto pYUkN; JTMI1: goto wOMbV; goto GAoB0; uA_vM: if ($region['feebillmonth'] == 2) { goto D4GFz; } goto hUK21; ys2rR: $amount = 0; goto klzRO; Fk_X2: if ($tag['feetype'] == 2) { goto twhMW; } goto TYjAS; e6I3p: $url = $this->createMobileUrl('home', array("op" => "index")); goto K2lcT; FeSoF: $lanelist = $res['LaneList']; goto Vyth3; vOb1q: RzlVP: goto AEWnI; e14ly: $content1 .= '时间:' . date('Y-m-d h:m') . '<BR>'; goto yK57R; c_PL0: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto kdoYt; x3DwU: $platcredit = pdo_fetch($sql, array(":weid" => $log['uniacid'])); goto SCq7D; MKPX3: if (empty($this->syscfg['businesstplid'])) { goto v43R3; } goto auTYs; d1d69: $charging_log = array("weid" => $log['uniacid'], "chargid" => $tag['chargid'], "title" => $charging['title'], "port" => $tag['port'], "openid" => $log['openid'], "out_trade_no" => $params['uniontid'], "fee" => $fee, "hour" => $rule['hour'], "plus" => $tag['plus'], "status" => "1", "uid" => $tag['payuser'], "ctime" => TIMESTAMP); goto lHKnq; HpIeK: if ($mindate == $maxdate) { goto M3pAP; } goto Hs5Jy; jt2yN: $content .= '手机:' . $tag['mobile'] . '\\n'; goto I8H_E; v5cjm: REIEi: goto w9ySL; GS2Qr: pdo_insert('rhinfo_zycj_selfdevice_log', $seldevice_log); goto qPkp2; XAdAM: if (empty($this->syscfg['businesstplid'])) { goto I9z1x; } goto HTBK6; rXENx: $this->mysyslog(0, 'error', '停车办理月卡', '月卡续费失败2' . $tag['carno'], '操作失败' . $res['resultMsg']); goto MAC0T; SPllZ: $startdate = date('Y-m-d', strtotime($res['tpStartTime'])); goto Xz2Us; DN7s1: $url = $this->createMobileUrl('home', array("op" => "index")); goto ssU1n; CIjdw: Ytz2c: goto mxZ3F; T1lfV: $setting = uni_setting($log['uniacid'], array("payment")); goto o_FNm; Vyth3: $parkios = $lanelist['LaneInfo']; goto ipTd9; i9EQI: $this->mysyslog(0, 'error', '停车缴费', '停车缴费支付失败', '操作失败' . $res['msg']); goto h0_Bm; vmo3L: $set = array("url" => "payOrder/", "accessKeyID" => $region['pc_appid'], "accessKeySecret" => $region['pc_secret'], "commKey" => $park['pc_secret']); goto RAaHl; Nifu3: header('Location:' . $url); goto hJNPZ; yhAnH: C1RMk: goto rJ5f_; MXs37: bkqAT: goto u_SYk; auTYs: $url = $this->createMobileUrl('home', array("op" => "index")); goto IWdbB; UMFOt: header('Location:' . $url); goto eoMsk; zmPDI: $data_car = array("weid" => $log['uniacid'], "uid" => $tag['payuser'], "openid" => $log['openid'], "carno" => $tag['carno'], "ctime" => TIMESTAMP); goto uOT4F; WnQPM: if (!($total == 0)) { goto GXeSb; } goto Hnxbq; o1Fna: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto BaF23; } goto zm20D; oWumF: $enddate = $tag['enddate']; goto uOyXe; oTTNF: pdo_insert('rhinfo_zyxq_carbill', $data_bill); goto pJ04U; gXPK6: if (!($tag['feetype'] == 10)) { goto Z189G; } goto WVZIi; E3j1v: $this->mysyslog(0, 'error', '停车办理月卡', '月卡延期失败' . $tag['carno'], '操作失败:未找到月卡信息'); goto yQqj9; mRdTA: if (!($tag['feetype'] == 20)) { goto Q1GYr; } goto jgBQd; PnNsu: bmAa3: goto JwKQt; h4nH6: $feeitemtitle = ''; goto Ib2TX; VS15e: pdo_update('rhinfo_zyxq_parkingiolog', array("status" => 1), array("weid" => $log['uniacid'], "lotid" => $tag['parkid'], "io" => 1, "uid" => $tag['payuser'])); goto bUmyH; WZdWK: $resmsg = $res['ReMsg']; goto qMeGQ; G1WnB: if ($park['pc_type'] == 2) { goto GA0is; } goto tmeeX; MqRpk: $post_data['out_user_id'] = $tag['payuser']; goto ps8Cl; NNEO2: $url = $this->my_mobileurl($this->createMobileUrl('service')); goto pjxnx; tiMnK: mc_notice_credit1($log['openid'], $tag['payuser'], $credit, '消费送积分', $url, '谢谢惠顾，点击查看详情'); goto v6Ktm; fP_5D: skYzn: goto gXPK6; G3Mnx: header('Location:' . $url); goto CRslY; rYb8f: pdo_insert('rhinfo_zyxq_car', $data_car); goto rlYY3; D0ed0: $url = $this->my_mobileurl($url); goto IVwRt; oK6p0: $postdata = array("first" => array("value" => "智能充电通知"), "keyword1" => array("value" => "充电开始", "color" => $topcolor), "keyword2" => array("value" => date('Y-m-d H:i'), "color" => $textcolor), "keyword3" => array("value" => '还剩充电时间' . $post_data['time'] . '分钟', "color" => $textcolor), "remark" => array("value" => "您的爱车已经开始充电，请耐心等待!")); goto Jqm6k; AMZYO: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $region['pid'], ":rid" => $region['id'], ":carno" => strtoupper($_GPC['carno']))); goto WnQPM; OWYtn: CGCwv: goto d0vJw; D1_dT: $postdata = array("first" => array("value" => $business['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => "请查看详情")); goto tXSnK; gOIWJ: goto wOMbV; goto LKbug; zm20D: $printdetail = ''; goto kA6aM; nRgSp: kKSNo: goto vCr2n; pJ04U: $parking_log = array("weid" => $log['uniacid'], "pid" => $parking['pid'], "rid" => $parking['rid'], "lid" => $parking['lid'], "title" => $parking['title'], "ownername" => $tag['realname'], "mobile" => $tag['mobile'], "carno" => strtoupper($tag['carno']), "startdate" => strtotime($tag['startdate']), "enddate" => strtotime($enddate), "remark" => "在线租赁", "cid" => $parking['id'], "cuid" => $tag['payuser'], "price" => $tag['price'], "paymonths" => $addmonths, "ctime" => TIMESTAMP); goto QpXDb; nx3Yt: $feecredit = 0; goto nhXe_; tqGAF: KqJB7: goto XgCN0; upTrw: $res = etpcar_http_post($set, $params); goto h5sYY; DR8Mb: $amount = 0; goto NLwc7; gxbie: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto LSnUK; } goto fzfdX; lFNMj: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto QdqIM; fc1jT: $data['title'] = $tag['title']; goto Au9gh; VF94i: pdo_insert('rhinfo_zycj_region_creditlog', $credit_data); goto Tvbxc; NeZrG: $fee = $log['fee']; goto CKaCk; O7tU5: e7vt8: goto L5FvB; u_SYk: $content .= $paymethod . '<right>' . $property['title'] . '</right>'; goto RYVll; GBDTu: $sql = 'update ' . tablename('rhinfo_zyxq_property') . ' set onhand = onhand + ' . $mycredit . ', inqty= inqty + ' . $mycredit . ', intime = ' . TIMESTAMP . ' where  weid = :weid and id=:pid'; goto kJhlO; zTL2e: $property = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_property') . ' where weid=:weid and id=:pid', array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto Gu2Sq; t_GHZ: $hours = intval($timediff % 86400 / 3600); goto KeFi2; e0Z72: $content .= '缴费时间:' . date('Y-m-d h:m') . '\\n'; goto g0k8d; RrAHJ: $res = etpcar_http_post($set, $params); goto mpJOw; HBbYX: jObQb: goto NCVbe; yYBxk: $maxdate = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto nOnIU; BVe1I: $minutes = intval($timediff % 86400 % 3600 / 60); goto W0iAd; CqB7K: $content1 .= '缴费周期:' . $daterange . '<BR>'; goto JdQXE; tb6gM: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto bQGmP; H89dy: if ($parklot['pc_type'] == 2) { goto Ld1nj; } goto bsfVH; xeNSF: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $log['uniacid'], "id" => $parkpayid)); goto XN35l; ZBfGN: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto DO9KV; } goto eB1aa; ml0ck: $url = $this->createMobileUrl('express', array("op" => "mindex", "sid" => $tag['sid'])); goto Noug0; CUT7N: pdo_insert('rhinfo_zyxq_paylog', $data); goto BxiO8; kObty: $printpznum = createpznum(substr($pzno, strlen($pznopre), 12)); goto jgz4a; YE0Ds: WOGy8: goto JSDOF; T24df: if (empty($house)) { goto QdeTY; } goto xqgfz; yVT5y: if (empty($this->syscfg['businesstplid'])) { goto e01ET; } goto WlMB8; PHpoU: $feebills = pdo_fetchall($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto h4nH6; w5BmV: HW5HT: goto X7v0K; oFDRo: $parklot['pc_type'] = !empty($parklot['pc_type']) ? $parklot['pc_type'] : $region['pc_type']; goto Hm0ir; C2r55: $sql = 'update ' . tablename('rhinfo_zyxq_region') . ' set onhand = onhand - ' . $feecredit . ', outqty= outqty + ' . $feecredit . ', outtime = ' . TIMESTAMP . ' where  weid = :weid and id=:rid'; goto eVQS8; nm4z6: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto OWs1N; ti7QH: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_car') . ' where weid = :weid and pid = :pid and rid = :rid and carno=:carno'; goto t1iqJ; uOT4F: pdo_insert('rhinfo_zyxq_mycar', $data_car); goto MRq0q; VyMfu: $park['pc_type'] = !empty($park['pc_type']) ? $park['pc_type'] : $region['pc_type']; goto Bmvtj; fB34R: $url = $this->createMobileurl('member', array("op" => "credit2")); goto Vwnfk; IWg0M: pdo_insert('rhinfo_zyxq_paylog', $data); goto HXVX4; KxkrC: goto wOMbV; goto aS6sm; QghyR: $postdata = array("first" => array("value" => $region['title'] . $location['title'] . $parking['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '车位租赁有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto Tx5UF; U9m9Y: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto MU61p; FHI9R: if ($total > 0) { goto mGIWr; } goto kndo5; EfAqv: $sql = 'select * from ' . tablename('rhinfo_zyxq_parkinglot') . ' where weid = :weid and rid=:rid and  id = :parkid '; goto AmP2d; YkWBt: O1UDb: goto aSYoO; wFgBA: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_mycar') . ' where weid=:weid and uid=:uid and carno=:carno'; goto vnX8z; ZD5rY: $url = $this->createMobileurl('member', array("op" => "credit1")); goto t349k; MqkBy: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto fun6C; U3AXA: $res = ipms_httpsign_post($set, $params); goto NJgZH; u12vJ: pdo_insert('rhinfo_zyxq_paylog', $data); goto FRBV3; aIJ0S: SU5Ge: goto Ci5T5; sJkYP: $set['url'] = 'parking/carDelay/'; goto nLLgU; qHQic: if (!($params['from'] == 'return')) { goto ED6uN; } goto d4OY2; yXMMm: header('Location:' . $url); goto FhrEy; J5yRH: goto ieAC8; goto Pefeh; DUfJT: if ($addmonths > 1) { goto ZyObk; } goto cJ1C2; YVc5f: $wechat = $setting['payment']['wechat']; goto LcVFI; u7Gxk: Cgh2v: goto u2rib; z3d4Z: $url = $this->my_mobileurl($this->createMobileUrl('service')); goto BLGE9; OiFPw: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and pid=:pid and  id = :rid '; goto hGDfR; oCNk2: $region = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto LxySR; bUmyH: exit; goto bYyhn; sZ6Tj: $data_parking = array("ownername" => $tag['realname'], "mobile" => $tag['mobile'], "carno" => strtoupper($tag['carno']), "startdate" => strtotime($tag['startdate']), "enddate" => strtotime($enddate), "price" => $tag['price'], "paymonths" => $addmonths, "remark" => "", "status" => 1); goto DMA0W; Tn1qk: $hours = intval($timediff % 86400 / 3600); goto xZnTZ; J0Fjv: foreach ($secuser as $secuser_v) { my_send_sound($this->syscfg['workermanurlpost'], 'property_' . $_W['setting']['site']['key'] . $_W['uniacid'] . $secuser_v['id'], '您有新的缴费信息，请注意查收.'); lnXGz: } goto DoBSm; ifWRB: e0XCR: goto mRsXT; W6IDU: if (!($feecredit > 0)) { goto BY1o8; } goto F03_p; szcTk: $timestr .= !empty($hours) ? $days . '小时' : ''; goto kxhtr; Ksp3f: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_mycar') . ' where weid=:weid and uid=:uid and carno=:carno'; goto ZQH66; UNSol: $sql = 'update ' . tablename('rhinfo_zycj_platform_credit') . ' set onhand = onhand - ' . $credit . ', outqty = outqty + ' . $credit . ', outtime = ' . TIMESTAMP . ' where weid=:weid '; goto MB6Kj; qPkp2: id4D6: goto yzaSB; QOMQC: MOa45: goto Ya2QD; brtYg: $postdata = array("first" => array("value" => "月卡延期异常通知"), "keyword1" => array("value" => $tag['carno'], "color" => $topcolor), "keyword2" => array("value" => date('Y-m-d H:i'), "color" => $textcolor), "keyword3" => array("value" => '操作失败' . $resmsg['ErrMsg'], "color" => $textcolor), "remark" => array("value" => "月卡延期失败，请确认！")); goto g3j3o; ZBrx7: $region = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid', array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto uhmtA; GpVvU: $rule = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":chargid" => $tag['chargid'], ":ruleid" => $tag['ruleid'])); goto d1d69; G_QKS: goto oshND; goto m_sEY; pbr4I: $post_data = array(); goto uUvUo; IK8zY: mKqoV: goto Tbujp; UGEz0: pdo_update('rhinfo_zyxq_car_feeorder', array("status" => 1, "paytime" => TIMESTAMP), array("weid" => $log['uniacid'], "id" => $tag['feeorderid'])); goto kKKb0; SYrta: J1cQk: goto sZ6Tj; QFjK5: oshND: goto VS15e; Xt6xP: $data_bill['cuid'] = $tag['payuser']; goto VkOjN; ucOKo: $params = array("CarNo" => $tag['carno'], "UserName" => $tag['realname'], "OperType" => "Add", "Fee" => $fee * 100, "StartTime" => date('YmdHis', strtotime($tag['startdate'])), "EndTime" => date('YmdHis', strtotime($enddate)), "CarType" => "月卡A", "CardStatus" => 0, "Balance" => 0, "MachList" => $machlist, "SetNo" => "000"); goto upTrw; eO10r: $amount = intval($task['amount']); goto ZvHfa; SMIE6: Ez340: goto ubF2K; Xl7l2: $postdata = array("first" => array("value" => $park['title'] . '(' . $park['address'] . ')'), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '停车时间' . $timestr . ',感谢支持')); goto l2nlX; p2dVG: $postdata = array("first" => array("value" => $park['title'] . '(' . $park['address'] . ')'), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '停车时间' . $timestr . ',感谢支持')); goto z1oi4; ACFJ7: foreach ($feebillids as $value) { goto BuN2w; KA5CU: $sql = 'select * from ' . tablename('rhinfo_zyxq_leasebill') . ' where id = :id and weid = :weid'; goto RctqO; Leu5i: $senddetail .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . ','; goto IAHXB; BuN2w: $sql = 'update ' . tablename('rhinfo_zyxq_leasebill') . ' set status = 2, payfee =  ' . $fee . ', paytype = ' . $paytype[$log['type']] . ', paydate = ' . TIMESTAMP . ', payuid =' . $tag['payuser'] . ', printpznum = "' . $printpznum . '", payno="' . $params['uniontid'] . '" where  weid = :weid and id=:billid'; goto SQ6cC; j_YwW: $printdetail1 .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . '<BR>'; goto Leu5i; RctqO: $item = pdo_fetch($sql, array(":id" => $value, ":weid" => $log['uniacid'])); goto JAlNU; JAlNU: $printdetail .= $item['daterange'] . $item['title'] . ':' . $item['fee'] . '\\n'; goto j_YwW; IAHXB: VWHxD: goto M0k8z; SQ6cC: pdo_query($sql, array(":weid" => $log['uniacid'], ":billid" => $value)); goto KA5CU; M0k8z: } goto C104M; pSwkI: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto cNOM_; oi4MI: $content1 .= '缴费人:' . $tag['payuser'] . '<BR>'; goto ZmHdA; BfWfD: $enddate = $tag['enddate'] . ' 23:59:59'; goto YF31i; U4_bf: exit; goto OK3rD; PJe4O: if (!($tag['qty'] >= $location['finmonths'])) { goto FvJ5S; } goto arJC6; LoyXF: $params = array("send_name" => empty($task['from']) ? $_W['account']['name'] : $task['from'], "openid" => $parent['openid'], "total_amount" => $amount, "total_num" => 1, "wishing" => empty($task['wishing']) ? '恭喜发财' : $task['wishing'], "act_name" => $parent['title'], "remark" => $task['title'], "siteip" => $_SERVER['SERVER_ADDR']); goto W1E2r; CKaCk: $feebillid = @base64_decode($tag['billid']); goto wMTPk; tDSbF: $set = array("url" => "parking/findCarList/", "accessKeyID" => $region['pc_appid'], "accessKeySecret" => $region['pc_secret'], "commKey" => $parklot['pc_secret']); goto lhdw9; DX4SV: $sql = 'select * from ' . tablename('rhinfo_zyxq_parking') . ' where weid = :weid and rid=:rid and  id = :parkingid '; goto HI6r6; TDXPN: $credit_data = array("weid" => $log['uniacid'], "bid" => $tag['businessid'], "io" => 2, "credit" => $credit, "title" => "消费送积分", "openid" => $log['openid'], "cuid" => 0, "ctime" => TIMESTAMP); goto aqYrJ; Uxtsg: $params = array("OrderNo" => $tag['recordid'], "PayStatus" => "OK", "Channel" => $params['type'] == 'wechat' ? 'weixin' : $params['type'], "PayType" => $params['payfrom'] == 'obeyscan' ? 'obeyscan' : 'hostscan', "PayNo" => $params['uniontid'], "OutTradeNo" => $params['tid']); goto RrAHJ; oXB_R: goto tjX4_; goto j0rwp; vjlrg: goto mlrYl; goto c9Dkr; wpnQR: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid=:weid and pid=:pid and rid=:rid and uid =0'; goto O1_Dd; P2r_y: R6R47: goto gNnEn; dUwbY: pdo_insert('rhinfo_zyxq_paylog', $data); goto Fk_X2; WFfrn: $log = pdo_fetch($sql, array(":uniontid" => $params['uniontid'])); goto e8XMM; kmCqO: if ($park['pc_type'] == 8) { goto oo7jJ; } goto gOIWJ; Y8ZBe: lQgI2: goto tUvRv; LB5zB: b1piV: goto WeskT; myzJy: $content .= '房产:' . $house['title'] . '\\n'; goto lvwgj; WL8p7: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_mycar') . ' where weid=:weid and uid=:uid and carno=:carno'; goto JrUL4; So8Yz: hyfcE: goto INHzU; jcO7_: $member_data = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "bid" => $parking['lid'], "tid" => 0, "category" => 3, "isowner" => 1, "otype" => 0, "hid" => $parking['id'], "uid" => $tag['payuser'], "openid" => $tag['openid'], "realname" => $tag['realname'], "mobile" => $tag['mobile'], "address" => $region['title'] . $location['title'] . '-' . $parking['title'], "carno" => $tag['carno'], "status" => 0, "ctime" => TIMESTAMP); goto c1OS9; CewNw: if (!($task['rewardtype'] == 2)) { goto hupL9; } goto NKL6X; o0YQz: $parkpayid = pdo_insertid(); goto sYvF_; sCyFR: a7dKf: goto tAG61; a3M4l: $machlist = substr($machlist, 0, -1); goto wFgBA; tqPhf: $cardno = $res['id']; goto SPllZ; N8MEg: $this->mysyslog(0, 'error', '停车缴费', '停车缴费支付失败', '操作失败' . $res['resultMsg'] . $tag['recordid']); goto k0zqh; IOhgj: $creditset['paycredit'] = $region['paycredit']; goto s9w4u; BZuFx: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":carno" => $tag['carno'])); goto Cip4p; wmiIz: $url = $this->createMobileUrl('home', array("op" => "index")); goto O6CsF; GgLkE: goto NC3R1; goto qWHoV; VDrBl: $sql = 'update ' . tablename('rhinfo_zycj_business') . ' set onhand = onhand + ' . $credit . ', inqty = inqty + ' . $credit . ', intime = ' . TIMESTAMP . ' where weid=:weid and id=:bid'; goto BVef2; tU3oK: $res = $res['datas'][0]; goto NY41l; TV_H4: HM8N1: goto FK9bc; jo7Hc: if (!($tag['expid'] > 0)) { goto fO1iO; } goto ZANCL; Hed9S: pdo_query($sql, array(":weid" => $log['uniacid'])); goto GQln7; jzb66: RXF1B: goto Pldg0; aS6sm: EN51l: goto tXEgW; js_o6: HPYVf: goto djVzq; h2wJu: if (!($params['from'] == 'return')) { goto ZjFIW; } goto z3d4Z; upHEp: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto giQY6; pqiVy: p1Eae: goto oSnw3; pu1KM: if (empty($this->syscfg['businesstplid'])) { goto n35kH; } goto wmiIz; qRpBR: $parklot = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'], ":parkid" => $tag['parkid'])); goto w9hgr; mbk5Y: $url = $this->my_mobileurl($this->createMobileUrl('service')); goto rIbjd; HY3r5: $data_bill['startdate'] = strtotime($tag['startdate']); goto cBjrL; LkubJ: fQjCu: goto h2wJu; ocnr2: nTVqQ: goto GBQF1; YipEy: if (!($res['code'] == 0)) { goto RXqyA; } goto a2RAf; eggoP: $res = deliyun_http_post($set, $params); goto L8RI7; f0dYH: goto tjX4_; goto URRZ_; GFjxz: $rule = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":chargid" => $tag['chargid'], ":ruleid" => $tag['ruleid'])); goto MSpyQ; NJgZH: if ($res['resultCode'] == '0000') { goto RnM5s; } goto pXE0R; eLP3Y: header('Location:' . $url); goto byYDf; TJwha: ZyObk: goto a4PeR; Gu2Sq: $region = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid', array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto MdBdl; iaTCx: $maxdate = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto HpIeK; g3j3o: if (empty($this->syscfg['tplid1'])) { goto D2bV_; } goto QC3Vr; BnVMx: $url = !empty($region['paysuccessurl']) ? $region['paysuccessurl'] : $url; goto MDoBM; TYjAS: if ($tag['feetype'] == 11) { goto Zd5Z1; } goto LQvK7; uNGto: if (!$res) { goto GXUhz; } goto tVVU2; UhA8T: $res = ipms_httpsign_post($set, $params); goto aPIsb; nZu4S: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto xnuiR; GdthV: if (!($params['from'] == 'return')) { goto Cgh2v; } goto b3h1D; RiOPz: header('Location:' . $url); goto fsL8R; C82Aw: $set['url'] = '/service/charge/startCharge.do'; goto mQunj; Iww7n: $content = '<FB><center>缴费通知单</center></FB>\\n'; goto lqE6Z; I8H_E: $content .= '类别:办理月卡\\n'; goto t9Tqu; LE_7O: $sql = 'update ' . tablename('rhinfo_zyxq_region') . ' set onhand = onhand - ' . $task['credit1'] . ', outqty= outqty + ' . $task['credit1'] . ', outtime = ' . TIMESTAMP . ' where  weid = :weid and id=:rid'; goto Qx6Nt; ovMP3: $credit = intval($fee * $this->syscfg['credit'] / $this->syscfg['cost']); goto qMKRI; oSnw3: if (!($tag['feetype'] == 17)) { goto LMkUf; } goto layTv; cJ1C2: $data_bill['daterange'] = date('Y-m', $data['enddate']); goto WIVG0; mlcln: LMkUf: goto XkrLV; O1_Dd: $secuser = pdo_fetchall($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto KNldM; qWV5C: D4GFz: goto sP6kN; PgGJB: Ld1nj: goto L4mZt; aODPu: $data['remark'] = empty($tag['expressid']) ? '快递译站' : '快递单id=' . $tag['expressid']; goto XilE3; DKGqu: goto l5gtx; goto ufjwM; ML5Xd: if ($log['type'] == 'alipay') { goto sj4jZ; } goto DyMoG; MDoBM: goto jTYaw; goto bIJsB; o596n: $params = array("token" => $this->syscfg['ylb_token'], "id" => $business['ylbid'], "uid" => 'rhinfo_' . $business['ylbid'], "price" => intval($fee * 100)); goto ck_J3; iQFi5: if (!($tag['feetype'] == 15)) { goto HygQS; } goto lD2Tr; FXt3I: $sql = 'update ' . tablename('rhinfo_zyxq_region') . ' set smsqty = smsqty +' . $tag['smsqty'] . ' where weid=:weid and id=:rid'; goto N9hEV; MEUX9: $region = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid', array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto cA3oW; YX6m6: pdo_insert('rhinfo_zyxq_parkpay_log', $data_parkpay); goto o0YQz; xd33P: JU38G: goto IS1it; qRWXG: $url = $this->my_mobileurl($this->createMobileUrl('home', array("op" => "index"))); goto G3Mnx; XN35l: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto zTlSD; R5EIU: XEKKx: goto ts0nH; NoZwy: $sql = 'select * from ' . tablename('rhinfo_zycj_charging') . ' where weid=:weid and id=:id'; goto BIv3T; iMvHy: $mycar_data = array("weid" => $log['uniacid'], "uid" => $tag['payuser'], "openid" => $log['openid'], "carno" => $tag['carno'], "ctime" => TIMESTAMP); goto nqdSq; HyHtt: if (empty($business['ylbid'])) { goto mKqoV; } goto ZzqNW; gNnEn: exit; goto zThRd; nxLKa: exit; goto f0dYH; o_FNm: if (!is_array($setting['payment'])) { goto Bp4o8; } goto YVc5f; KpRtJ: foreach ($teams as $team) { $this->send_mysendtplnotice($team['openid'], $this->syscfg['tplid1'], $postdata, $url, $topcolor); iqU9c: } goto dj5YP; fFsId: $sql = 'select * from ' . tablename('rhinfo_zycj_charging_rule') . ' where weid=:weid and chargid = :chargid and id=:ruleid'; goto GpVvU; c5eGx: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto MeBNU; Rpnbe: $enddate = date('Y-m-d', strtotime('+' . $addmonths . ' month', strtotime($enddate))); goto OLLDE; zhhKf: $timestr .= !empty($minutes) ? $days . '分钟' : ''; goto tRil0; bdtUq: $days = intval($timediff / 86400); goto iiItR; tJ8IA: if (!($region['onhand'] >= $feecredit)) { goto o1Rbj; } goto c4zIK; v2lU3: txnw5: goto X57Rp; tc6pF: $data['tid'] = $params['uniontid']; goto YnkFA; Lk5oL: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto eFWYc; HAgXv: CBS0s: goto mTByg; zHRLE: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto Lk5oL; sDvpe: $park = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'], ":parkid" => $tag['parkid'])); goto NaXfv; WrQor: M11D0: goto m1h2N; V4QTn: $content .= '车主:' . $tag['realname'] . '\\n'; goto MZOwm; Tx5UF: if (empty($this->syscfg['businesstplid'])) { goto udX9w; } goto AsehD; Gul4R: MC_UJ: goto Bc_uP; ZKw9p: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto OUbzY; fLuyg: goto PTVJQ; goto avCgu; gLsCZ: zbz2H: goto cntYR; YV6tE: if (empty($region['ylbid'])) { goto cL1sI; } goto Herkk; PSHXb: $credit_data = array("weid" => $log['uniacid'], "pid" => $room['pid'], "rid" => $room['rid'], "io" => 2, "credit" => $task['credit1'], "title" => "邀请到店消费,完成任务赠送积分", "openid" => $parent['openid'], "uid" => $parent['uid'], "status" => 1, "cuid" => 0, "ctime" => TIMESTAMP); goto VF94i; PrVpR: $post_data['port'] = $tag['port']; goto CkEe4; bYyhn: SuZGe: goto iXxDi; C1r5w: $this->mysyslog(0, 'error', '停车办理月卡', '月卡建立失败' . $tag['carno'], '操作失败' . $res['msg']); goto aq3O0; Riq3F: $url = 'mx10/Api.php'; goto i5NLN; iI0EZ: $timestr = !empty($days) ? $days . '天' : ''; goto R5k_f; VyEmn: $daterange = date('Y-m', $mindate) . '~' . date('Y-m', $maxdate); goto Ys9LC; LxySR: $park['pc_type'] = !empty($park['pc_type']) ? $park['pc_type'] : $region['pc_type']; goto qOLkn; bJ16u: header('Location:' . $url); goto bT4I3; RvG0i: $enddate = date('Y-m-d', strtotime('+' . $addmonths . ' month', strtotime($enddate))); goto cXLux; qMKRI: if (!$this->syscfg['isplatformcredit']) { goto O1UDb; } goto Vi7sy; DRDK7: $content1 .= $parklot['title'] . '<BR>'; goto Cv3_m; tR1MJ: mc_notice_credit1($log['openid'], $tag['payuser'], -$mycredit, '用积分抵扣费用', $url, '谢谢支持，点击查看详情'); goto EAyZL; fTzW4: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto TEG_I; muR1P: $set['url'] = 'app/UpMonCar.aspx'; goto ucOKo; W0iAd: $timestr = !empty($days) ? $days . '天' : ''; goto szcTk; b8ar5: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto hyfcE; } goto POg0h; lEBHY: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto QghyR; dUMM4: IdRlt: goto yne4w; TlYVN: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto MqkBy; Qy7ke: goto ecM0R; goto Fx5Bm; KWMeB: $content1 = '<CB>缴费通知单</CB><BR>'; goto DRDK7; yDjhN: if (!$res) { goto C1RMk; } goto M6_D0; eQRCw: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto upHEp; Pldg0: goto KB371; goto jgJa8; jiykw: $timestr = !empty($days) ? $days . '天' : ''; goto CpqNw; f0gxD: $res = etpcar_http_post($set, $params); goto WZdWK; NKL6X: $res = mc_credit_update($parent['uid'], 'credit2', $task['credit2'], array(0, '邀请到店消费,完成任务赠送' . $task['credit2'] . '元', "rhinfo_zyxq")); goto yDjhN; gJOEr: LSnUK: goto uzVOq; kG_nP: $params = array("token" => $this->syscfg['ylb_token'], "id" => $region['ylbid'], "uid" => 'rhinfo_' . $region['ylbid'], "price" => intval($fee * 100)); goto Iv502; SiIS4: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto KqJB7; } goto c2Fqj; Xz2Us: $set['url'] = 'third_api/monthCardAppAction_updateMonthCard.action'; goto a6td7; od65H: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto D1_dT; KTRcL: $set = array("url" => "app/UpPayNotify.aspx", "parkno" => $park['pc_plotid'], "secret" => $park['pc_secret']); goto WfFn4; N9hEV: pdo_query($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto i7lLe; hudII: pdo_query($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto I07qQ; m1ZF8: $creditset['paycost'] = $region['paycost']; goto IOhgj; paPWj: $url = $this->createMobileUrl('charging', array("op" => "my")); goto sHvDv; iK0rs: pdo_insert('rhinfo_zyxq_paylog', $data); goto eXxdi; bdC2b: if (empty($this->syscfg['businesstplid'])) { goto Albxh; } goto cDAIo; zOjss: $data_bill['fee'] = $fee; goto HY3r5; sFKrb: $url = $this->my_mobileurl($this->createMobileUrl('home', array("op" => "index", "rid" => $tag['rid']))); goto s_M8O; i7L9s: header('Location:' . $url); goto u7Gxk; hBrUr: pdo_insert('rhinfo_zyxq_paylog', $data); goto l8PrO; ZmHdA: if (!($region['isprintfeedetail'] == 1)) { goto bkqAT; } goto sNnod; X4cb3: w5sMs: goto J77Fh; jPK1u: exit; goto mlcln; NnJet: exit; goto KVNXL; eqHVY: $timestr .= !empty($minutes) ? $days . '分钟' : ''; goto nIn0O; yQqj9: goto Z7vHQ; goto CfkFl; R6lH4: $enddate = date('Y-m-d', strtotime('+' . $addmonths . ' month', strtotime($enddate))); goto wRkve; o5lSh: n18tL: goto s0vdE; qBJ4G: ecM0R: goto O66cs; KPGEW: WofNg: goto b1E4D; G8RD3: $teams = pdo_fetchall($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto Pe8z1; YYIgy: tjX4_: goto SF1Oy; OziDg: $task = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":openid" => $log['openid'])); goto MxkoT; dMYoV: $data_bill = array("weid" => $log['uniacid'], "pid" => $parking['pid'], "rid" => $parking['rid'], "lid" => $parking['lid'], "cid" => $parking['id'], "title" => $parking['title'], "status" => 0, "remark" => ""); goto AtyZ2; Fx5Bm: oayBo: goto tJ8IA; RPPzi: A7jtl: goto gKFA3; gKYv7: $mywechat['signkey'] = $wechat['apikey']; goto Mb4Cw; C5g7u: header('Location:' . $url); goto nnUcE; NkFlD: $minutes = intval($timediff % 86400 % 3600 / 60); goto MLPxM; cFYye: $url = $this->createMobileurl('member', array("op" => "credit1")); goto Ehytw; iWLGn: $data_parkpay = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "parklotid" => $tag['parkid'], "title" => "办理月卡", "category" => 2, "starttime" => strtotime($tag['startdate']), "endtime" => strtotime($tag['enddate'] . ' 23:59:59'), "carno" => $tag['carno'], "mobile" => $tag['mobile'], "realname" => $tag['realname'], "idcard" => $tag['idcard'], "fee" => $fee, "payno" => $log['tid'], "status" => 0, "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto k35Mt; Pw1WS: Nvb_Z: goto KmQ3d; Ya2QD: if (!($tag['feetype'] == 5)) { goto RtO8x; } goto vZRI9; Ib2TX: foreach ($feebills as &$v) { $feeitemtitle .= $v['title']; n7g_U: } goto YtjxD; QNK3o: $postdata = array("first" => array("value" => $park['title'] . '(' . $park['address'] . ')'), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '停车时间' . $timestr . ',感谢支持')); goto MKPX3; mN6Gm: $res = ylb_http_post($set, $params); goto Bg_bP; s9yw9: XAPA2: goto ED5i3; Xh5yr: JDsbc: goto dIuVG; lUUVS: goto Ez340; goto js_o6; YQeVI: if (empty($house)) { goto vEcVf; } goto myzJy; troGt: $data_car = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "title" => $tag['carno'], "ownername" => $tag['realname'], "mobile" => $tag['mobile'], "carno" => $tag['carno'], "remark" => "", "uid" => $tag['payuser'], "openid" => $tag['openid'], "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto rYb8f; CAOno: $data['fee'] = $fee; goto NAvpG; s0vdE: oIlTB: goto PnNsu; wLmwA: MtUMg: goto CtCtu; Au9gh: $data['paytype'] = $paytypetxt[$paytype[$log['type']]]; goto AkOp8; ps8Cl: $post_data['pay_fee'] = intval($fee * 100); goto F5yMA; HJ1pB: FMXXa: goto pNL3n; kr_hR: $content1 .= '缴费类别:' . $feeitemtitle . '<BR>'; goto DWELB; VoD70: $url = $this->createMobileUrl('home', array("op" => "index")); goto nZu4S; Lo11L: if (!($log['type'] == 'wechat')) { goto zm7vI; } goto DbgrL; VkOjN: $data_bill['ctime'] = TIMESTAMP; goto oTTNF; OUbzY: wig4n: goto YE0Ds; GbROQ: $charging_log['trade_no'] = 'ok'; goto SOOxZ; QUQVa: cdR0K: goto kYoJx; MSpyQ: $set = array(); goto dS7pt; m1h2N: if (!($params['from'] == 'return')) { goto njJ3u; } goto rLjnJ; YYmsB: $postdata = array("first" => array("value" => $park['title'] . '(' . $park['address'] . ')'), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '停车时间' . $timestr . ',感谢支持')); goto yVT5y; Pl_R3: jTYaw: goto Ou2sE; nNUx2: $printpznum = $pznopre . $printpznum; goto HQmwI; gWVVu: $mindate = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto airUP; h5sYY: $res = $res['ReMsg']; goto w9piy; iNj0Z: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto JU38G; } goto TgFjD; VMdkB: pdo_insert('rhinfo_zyxq_mycar', $data_car); goto QUQVa; erSFp: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto ohsdK; wv8La: $set = array(); goto C82Aw; ct43S: $region = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto hawCn; o7MNC: $content .= $region['title'] . '\\n'; goto KWMeB; sOJCA: $sql = 'select max(printpznum) from' . tablename('rhinfo_zyxq_leasebill') . ' where weid = :weid and printpznum like \'' . $pznopre . '%\''; goto qrUW3; CEkuO: pdo_insert('rhinfo_zyxq_paylog', $data); goto PLyHQ; KeFi2: $minutes = intval($timediff % 86400 % 3600 / 60); goto x3QXH; ku4sc: $set['pc_appid'] = $region['pc_appid']; goto X3idj; AQLKl: Albxh: goto O7tU5; ZqMK5: jD0FD: goto l7gYd; Zvo_Q: $res = $res['data']; goto WL8p7; XkrLV: if (!($tag['feetype'] == 18)) { goto HxVbb; } goto iNj0Z; ezM1K: $set['pc_secret'] = $region['pc_secret']; goto DcVqV; oDiuM: $timestr .= !empty($minutes) ? $days . '分钟' : ''; goto YYmsB; qAM9V: $data_white = array("weid" => $log['uniacid'], "parklotid" => $tag['parkid'], "starttime" => strtotime($tag['startdate']), "endtime" => strtotime($tag['enddate'] . ' 23:59:59'), "carno" => $tag['carno'], "mobile" => $tag['mobile'], "realname" => $tag['realname'], "idcard" => $tag['idcard'], "status" => 1, "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto nlJWU; yne4w: $sql = 'update ' . tablename('rhinfo_zycj_platform_credit') . ' set onhand = onhand - ' . $credit . ', outqty = outqty + ' . $credit . ', outtime = ' . TIMESTAMP . ' where weid=:weid '; goto Hed9S; t03Cf: QN5fP: goto ROzgj; ExSx4: $credit = intval($fee * $this->syscfg['credit'] / $this->syscfg['cost']); goto HzwID; p18LI: $paytype = array("wechat" => "1", "alipay" => "2", "alipaylife" => "4"); goto tUnpZ; kdoYt: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto nsark; Epvc4: $set = array(); goto JshQv; TgFjD: pdo_insert('rhinfo_zyxq_paylog', $data); goto c_PL0; subZz: BAden: goto YkWBt; mfFWk: $sql = 'update ' . tablename('rhinfo_zycj_business') . ' set onhand = onhand - ' . $credit . ', outqty= outqty + ' . $credit . ', outtime = ' . TIMESTAMP . ' where  weid = :weid and id=:bid'; goto nLEDQ; kYoJx: $timediff = TIMESTAMP - $tag['intime']; goto FT_08; sm2yT: $this->mysyslog(0, 'error', '停车缴费', '停车缴费支付失败', '操作失败' . $res['msg']); goto l8VTf; C104M: ViQhB: goto kwEqH; k0zqh: goto QvzSP; goto t03Cf; zzvQT: $teams = pdo_fetchall($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto KpRtJ; KIaQK: $pznopre = 'CAR'; goto UUVel; Kw42l: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto SJ7VU; GA4pD: $lock_paylog = array("weid" => $log['uniacid'], "shareid" => $tag['shareid'], "parklockid" => $parkshare['parklockid'], "title" => $parkshare['title'], "openid" => $log['openid'], "out_trade_no" => $params['uniontid'], "fee" => $fee, "status" => 1, "uid" => $tag['payuser'], "starttime" => $parkshare['starttime'], "endtime" => $parkshare['endtime'], "ctime" => TIMESTAMP); goto jwV2u; aPTRq: $timestr .= !empty($minutes) ? $minutes . '分钟' : ''; goto QNK3o; POg0h: pdo_insert('rhinfo_zyxq_paylog', $data); goto XAnWL; kwEqH: $sql = 'select min(enddate) from ' . tablename('rhinfo_zyxq_leasebill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto gWVVu; FgLh9: if (!($total == 0)) { goto b1piV; } goto tGfky; AU2bP: mhABu: goto LkubJ; Cv3_m: $content1 .= '车主:' . $tag['realname'] . '<BR>'; goto xo4GU; i5NLN: $post_data = array("action" => "sendFs24", "token" => $this->syscfg['mx_appkey'], "appid" => $this->syscfg['mx_appid'], "device_code" => $charging['devicesn'], "port" => sprintf('%02d', $tag['port']), "ctype" => 1, "fee" => $fee, "ordersn" => date('mdHis') . random(1, 1)); goto UGw5d; SUsQY: mc_notice_credit1($log['openid'], $tag['payuser'], $credit, '充值送积分', $url, '谢谢支持，点击查看详情'); goto pOH7s; OLLDE: lZxQ3: goto hxVSl; ZrI8X: HygQS: goto IRi8j; KVNXL: Z189G: goto p7AF3; VuEcc: $set = array(); goto ku4sc; L1TsB: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_wepay_log') . ' WHERE `uniontid`=:uniontid'; goto WFfrn; vFkFx: if (!($creditfee > 0)) { goto HhvDz; } goto QOekm; lD2Tr: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto e0XCR; } goto iYNno; Cip4p: if (!($total == 0)) { goto a7dKf; } goto iMvHy; oJaCf: if (!($total == 0)) { goto cdR0K; } goto QCD0M; VCw34: $credit_log_data = array("weid" => $log['uniacid'], "io" => 4, "credit" => $retcredit, "title" => $_GPC['title'], "uid" => $tag['payuser'], "openid" => $log['openid'], "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto IhxEj; N3Hdd: pdo_query($sql, array(":weid" => $log['uniacid'], ":compid" => $tag['compid'])); goto LNB7s; zd4F8: $seldevice_log = array("weid" => $log['uniacid'], "selfid" => $tag['selfid'], "title" => $selfdevice['title'], "openid" => $log['openid'], "out_trade_no" => $params['uniontid'], "fee" => $fee, "status" => 0, "uid" => $tag['payuser'], "ctime" => TIMESTAMP); goto GUhr3; vo53k: $location = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'], ":lid" => $parking['lid'])); goto oWumF; hc0VP: $sql = 'select max(printpznum) from' . tablename('rhinfo_zyxq_feebill') . ' where weid = :weid and printpznum like \'' . $pznopre . '%\''; goto ZonDu; GBQF1: goto KB371; goto PgGJB; nnUcE: YWLPo: goto YmMmY; iFoUQ: mc_notice_credit1($log['openid'], $tag['payuser'], $feecredit, '缴费' . $fee . '送' . $feecredit . '积分', $crediturl, '谢谢支持，点击查看详情'); goto Y8ZBe; GpsTH: $content1 = '<CB>缴费通知单</CB><BR>'; goto RArrW; QdqIM: $this->send_mysendtplnotice($this->syscfg['openid'], $this->syscfg['tplid1'], $postdata, $url, $topcolor); goto gBXbW; uhmtA: $pznopre = !empty($region['pznopre']) ? $region['pznopre'] : 'FEE'; goto hc0VP; kUh0q: S7Ax0: goto Pv9vL; pXE0R: $this->mysyslog(0, 'error', '停车办理月卡', '月卡建立失败' . $tag['carno'], '操作失败' . $res['resultMsg']); goto uQveV; E8uPZ: $feebillids = explode(',', $feebillid); goto dUwbY; NCVbe: if (!($params['from'] == 'return')) { goto RzlVP; } goto s8aZY; a2GqD: goto yVvlI; goto lw2Tw; s_M8O: header('Location:' . $url); goto RfBXJ; vmFIM: $credit = 0; goto QN3ML; mXgwU: $params = array("plantNum" => $tag['carno'], "beginDate" => $tag['startdate'], "endDate" => $enddate, "carTypeId" => 2, "money" => $fee, "pname" => $tag['realname'], "mobile" => $tag['mobile']); goto OCD3L; dXI70: mRPJW: goto FeSoF; DoBSm: fLatT: goto hwAHe; aRUna: $post_data['device_code'] = $charging['devicesn']; goto k3fv9; hV5pm: goto wOMbV; goto SMbZI; c1OS9: pdo_insert('rhinfo_zyxq_member', $member_data); goto dMYoV; UVd32: s08tq: goto AGna0; pAw2O: RpNpz: goto HAgXv; v2jWX: pdo_insert('rhinfo_zycj_region_creditlog', $credit_data); goto Tszwx; ZXFtg: zMcYW: goto Ksp3f; P3aOO: if (!($tag['qty'] >= $parklot['rechargmonths'])) { goto lZxQ3; } goto t2wP6; SF1Oy: ED6uN: goto dNib_; RKvz8: $post_data = array(); goto aRUna; d7aWL: pdo_insert('rhinfo_zyxq_paylog', $data); goto NoZwy; DKi8g: $url = $this->createMobileUrl('home', array("op" => "index")); goto fTzW4; b3h1D: $url = $this->my_mobileurl($this->createMobileUrl('service')); goto i7L9s; wsSQe: $content .= '缴费金额:' . $fee . '元\\n'; goto cR5eC; J41bf: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_car') . ' where weid=:weid and pid=:pid and rid=:rid and carno=:carno and deleted=0'; goto AMZYO; LRFHi: KnRBS: goto Z2R_b; tebs5: if (!(count($task_members) >= $task['persons'])) { goto ZyT1z; } goto sMKz8; ZvHfa: goto mlrYl; goto X4cb3; AsehD: $url = $this->createMobileUrl('home', array("op" => "index")); goto fmsRN; D0VO1: $sql = 'update ' . tablename('rhinfo_zycj_express_company') . ' set smsqty = smsqty +' . $tag['smsqty'] . ' where weid=:weid and id=:compid'; goto N3Hdd; TzYo9: RtO8x: goto qihc7; gWrVL: if (!($params['from'] == 'return')) { goto dV4MF; } goto DQVX_; DqL3B: $feecredit = intval($fee * $region['credit'] / $region['cost']); goto RFDnw; BpFvi: $sql = 'select max(enddate) from ' . tablename('rhinfo_zyxq_carbill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto yYBxk; EGkFE: $content .= '时间:' . date('Y-m-d h:m') . '\\n'; goto o7MNC; yq_j3: if (empty($parent)) { goto JDsbc; } goto EK8km; jdLQi: $res = my_wechat_paymoney($params, $mywechat); goto Kiqwc; Fk8fA: if ($platcredit['onhand'] >= $credit) { goto IdRlt; } goto vmFIM; xtY4C: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto bmAa3; } goto CUT7N; LhYpI: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto L0hup; layTv: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto C6HtG; } goto hBrUr; MZOwm: $content .= '车牌:' . $tag['carno'] . '\\n'; goto jt2yN; Bab0B: $res = mc_credit_update($tag['payuser'], 'credit1', $credit, array(0, "消费送积分", "rhinfo_zyxq")); goto uNGto; nLLgU: $params = array("plantNum" => $tag['carno'], "beginDate" => $res['beginDate'], "endDate" => $enddate, "payMode" => 1, "chargeMoney" => $fee); goto yfn9E; mpJOw: $res = $res['ReMsg']; goto dbzpf; UUVel: $sql = 'select max(printpznum) from' . tablename('rhinfo_zyxq_carbill') . ' where weid = :weid and printpznum like \'' . $pznopre . '%\''; goto uR_vo; tUvRv: o1Rbj: goto qBJ4G; j7uIU: pdo_query($sql, array(":weid" => $log['uniacid'], ":sid" => $tag['sid'])); goto bZEfC; XnHfU: if (!($tag['feetype'] == 8)) { goto gpopn; } goto am2sS; jzM3c: GcVzp: goto DU7gX; SMbZI: GA0is: goto XvDDV; RFDnw: aaHjw: goto W6IDU; KRIpU: $url = 'paycloud2/Api.php'; goto DSOkI; mldI8: if (!($tag['qty'] >= $parklot['rechargmonths'])) { goto jHJCc; } goto QIAn7; MB6Kj: pdo_query($sql, array(":weid" => $log['uniacid'])); goto CqOJy; xK7ZH: $res = mc_credit_update($tag['payuser'], 'credit2', $totalfee, array(0, "账户充值", "rhinfo_zyxq")); goto zXs4I; pzZvB: $addmonths = $addmonths * $parklot['givemonths']; goto RvG0i; g0k8d: $content .= '缴费人:' . $tag['payuser'] . '\\n'; goto GpsTH; N3PHu: $res = ipms_http_post($set, $params); goto okXM9; gJPbT: $url = $this->my_mobileurl($this->createMobileurl('business', array("op" => "index", "id" => $tag['bid']))); goto UQwva; cw3_U: $url = $this->my_mobileurl($this->createMobileUrl('express', array("op" => "eindex"))); goto UMFOt; PF90l: $res = bluecar_http_post($set, $params); goto Avmf9; TEG_I: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto Pw1WS; qmKhh: $platcredit = pdo_fetch($sql, array(":weid" => $log['uniacid'])); goto Fk8fA; eQxG6: $credit = intval($fee * $business['credit'] / $business['cost']); goto DnJXF; bsfVH: if ($parklot['pc_type'] == 3) { goto K4K8m; } goto hAbTz; HrOwV: pdo_query($sql, array(":weid" => $log['uniacid'], ":sid" => $tag['sid'])); goto bEczU; QaCUL: $rs = Mx_httpPost($url, $post_data); goto f5meC; FT_08: $days = intval($timediff / 86400); goto Gopht; sTXi0: HhvDz: goto M0u8v; Avmf9: goto wOMbV; goto ooyzC; NNnnQ: TSNvl: goto GdthV; lw2Tw: wBeT8: goto Riq3F; QC3Vr: $url = $this->createMobileUrl('car', array("op" => "remonthcard", "id" => $parkpayid)); goto CwNlP; k35Mt: pdo_insert('rhinfo_zyxq_parkpay_log', $data_parkpay); goto pFqoQ; sfNht: pdo_insert('rhinfo_zyxq_parkpay_log', $data_parkpay); goto sOr8B; PQtPJ: $region = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_region') . ' where weid=:weid and id=:rid', array(":weid" => $log['uniacid'], ":rid" => $tag['rid'])); goto KIaQK; DQCIf: pdo_query($sql, array(":weid" => $log['uniacid'], ":expid" => $tag['expid'])); goto EtfA3; sHvDv: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto xKCOH; XvDDV: $set = array(); goto OnIkI; l1nDI: if (!($tag['feetype'] == 7)) { goto Op7r6; } goto xtY4C; i7lLe: $smslog_data = array("weid" => $log['uniacid'], "rid" => $tag['rid'], "title" => '短信充值' . $tag['smsqty'] . '条', "io" => 1, "mobile" => "", "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto h1zTR; jwV2u: pdo_insert('rhinfo_zyxq_parkshare_paylog', $lock_paylog); goto gJOEr; aSK6T: $paymethod1 = '支付方式:微信<BR>'; goto WD1KP; x7Y0w: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto xfKcC; Pv9vL: if (!($tag['feetype'] == 14)) { goto qTpm8; } goto SiIS4; QCD0M: $data_car = array("weid" => $log['uniacid'], "uid" => $tag['payuser'], "openid" => $log['openid'], "carno" => $tag['carno'], "ctime" => TIMESTAMP); goto VMdkB; CFWXB: $data['sid'] = $tag['sid']; goto Uqmk_; L0hup: $data_parkpay = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "parklotid" => $tag['parkid'], "title" => "临时缴费", "category" => 1, "starttime" => $tag['intime'], "endtime" => TIMESTAMP, "carno" => $tag['carno'], "fee" => $fee, "mobile" => $tag['mobile'], "realname" => $tag['realname'], "payno" => $log['tid'], "status" => 1, "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto peqPn; sMKz8: if (!($task['rewardtype'] == 1)) { goto QgrtD; } goto po4hM; E5QGu: $rule = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":chargid" => $tag['chargid'], ":ruleid" => $tag['ruleid'])); goto wv8La; GQZCL: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $region['pid'], ":rid" => $region['id'], ":carno" => strtoupper($_GPC['carno']))); goto FgLh9; lqE6Z: $content .= '房产:' . $tag['title'] . '\\n'; goto mOsug; ubF2K: j1ARm: goto dwSkL; QOekm: $iscreditpay = 0; goto V0pLq; WfFn4: $params = array("OrderNo" => $tag['recordid'], "PayStatus" => "OK", "PayType" => "WeiXin", "PayNo" => $params['uniontid'], "OutTradeNo" => $params['tid']); goto KB1NT; q7G32: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto M11D0; } goto IWg0M; yK57R: $content1 .= $region['title'] . '<BR>'; goto x33Nv; WX78G: if ($res['result'] == 'success') { goto QN5fP; } goto N8MEg; oex1W: goto vQ3Va; goto GYkaZ; xfKcC: if (empty($this->syscfg['businesstplid'])) { goto Cmcix; } goto X2Ht8; CjXAD: if (!($params['from'] == 'return')) { goto hdZJh; } goto mbk5Y; FhrEy: oCZMM: goto Ti2Bq; IS1it: if (!($params['from'] == 'return')) { goto V4YpQ; } goto sFKrb; LusDl: QgrtD: goto CewNw; bQGmP: QQwhj: goto pYdEL; p7AF3: if (!($tag['feetype'] == 12)) { goto HW5HT; } goto b8ar5; Hnxbq: $car_data = array("weid" => $log['uniacid'], "pid" => $region['pid'], "rid" => $region['id'], "carno" => $tag['carno'], "title" => $tag['carno'], "ownername" => $tag['realname'], "mobile" => $tag['mobile'], "uid" => $tag['uid'], "openid" => $log['openid'], "cuid" => $tag['uid'], "ctime" => TIMESTAMP); goto lTtuz; Pe8z1: foreach ($teams as $team) { $this->send_mysendtplnotice($team['openid'], $this->syscfg['tplid1'], $postdata, $url, $topcolor); FfNQq: } goto pAw2O; cRO1u: $printpznum = createpznum(substr($pzno, strlen($pznopre), 12)); goto nNUx2; QGU2G: I9z1x: goto azCpN; B0pQv: vfP01: goto mRdTA; yac4D: pdo_query($sql, array(":weid" => $log['uniacid'], ":ioid" => $tag['recordid'])); goto YWtHV; XPTn_: $sql = 'update ' . tablename('rhinfo_zyxq_region') . ' set onhand = onhand + ' . $mycredit . ', inqty= inqty + ' . $mycredit . ', intime = ' . TIMESTAMP . ' where  weid = :weid and id=:rid'; goto hudII; sP6kN: $data_bill['daterange'] = date('Y-m-d', $data_bill['startdate']) . '~' . date('Y-m-d', $data_bill['enddate']); goto ZqMK5; Vwnfk: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto BYhOa; Z_xoj: $res = pdo_update('rhinfo_zyxq_parklock_share', array("status" => 1, "toopenid" => $log['openid'], "touid" => $tag['payuser']), array("weid" => $log['uniacid'], "id" => $tag['shareid'])); goto GA4pD; R5k_f: $timestr .= !empty($hours) ? $days . '小时' : ''; goto eqHVY; UWVug: Z7vHQ: goto bunaJ; XqqOF: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":carno" => $tag['carno'])); goto OK2Ay; Itwcz: $timediff = TIMESTAMP - $tag['intime']; goto TANEJ; LpO68: $data['rid'] = $tag['rid']; goto gnQPu; BIv3T: $charging = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":id" => $tag['chargid'])); goto fFsId; CpqNw: $timestr .= !empty($hours) ? $days . '小时' : ''; goto zhhKf; Zeyd9: pdo_insert('rhinfo_zyxq_mycar', $data_car); goto H4LNj; XpuWa: $set['url'] = 'third_api/monthCardAppAction_create.action'; goto GEozl; ck_J3: $res = ylb_http_post($set, $params); goto IK8zY; SSUr0: goto KB371; goto ocnr2; Bc_uP: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto XdmQa; DnKHX: $this->send_mysendtplnotice($business['openid'], $this->syscfg['businesstplid'], $postdata, $url, $topcolor); goto AU2bP; Tvbxc: $res = mc_credit_update($parent['uid'], 'credit1', $task['credit1'], array(0, '邀请到店消费,完成任务赠送' . $task['credit1'] . '积分', "rhinfo_zyxq")); goto wb7cY; O14Up: YtZX8: goto o1Fna; QpXDb: pdo_insert('rhinfo_zyxq_parkinglog', $parking_log); goto ti7QH; x3QXH: $timestr = !empty($days) ? $days . '天' : ''; goto Nqolh; Fb_9U: $crediturl = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($crediturl, 1, strlen($crediturl)); goto oatLz; o7UXY: dV4MF: goto h1ENS; TANEJ: $days = intval($timediff / 86400); goto t_GHZ; wDOBq: $sql = 'select * from ' . tablename('rhinfo_zyxq_parklock_share') . ' where weid=:weid and id=:id'; goto PKPF1; vfmo_: mGIWr: goto LRFHi; v6Ktm: GXUhz: goto OWYtn; xixRf: NC3R1: goto b47Lq; GEozl: $params = array("parkId" => $parklot['pc_plotid'], "carNum" => $tag['carno'], "startTime" => $tag['startdate'], "endTime" => $enddate, "userPhone" => $tag['mobile'], "userName" => $tag['realname'], "loginUserName" => $tag['mobile'], "rechangeFee" => $fee * 100); goto U3AXA; cD3Iv: DBjhi: goto KRIpU; h0_Bm: goto CmGZ3; goto KOus3; Vp0_s: VmdjH: goto xJeWl; bunaJ: goto C_1Sb; goto LaWGl; H2wtj: $seldevice_log['status'] = 1; goto XcIAl; p7jcm: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto bdC2b; Bo9kL: $daterange = date('Y-m', $maxdate); goto aIJ0S; rOOGS: $data_car = array("weid" => $log['uniacid'], "uid" => $tag['payuser'], "openid" => $log['openid'], "carno" => $tag['carno'], "ctime" => TIMESTAMP); goto c7TNJ; cR5eC: $content .= '缴费周期:' . $daterange . '\\n'; goto e0Z72; FK9bc: eXQJ1: goto wdoPS; EnkJ9: $task_members = pdo_fetchall($sql, array(":weid" => $log['uniacid'], ":parentid" => $task['parentid'])); goto tebs5; dS7pt: $set['url'] = 'net.equip.charge.slow.run'; goto G4vhK; O6CsF: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto lMk_N; c2Fqj: pdo_insert('rhinfo_zyxq_paylog', $data); goto FTa1Q; kxhtr: $timestr .= !empty($minutes) ? $days . '分钟' : ''; goto Xl7l2; MMc6I: $resmsg = $res['ReMsg']; goto nnTy9; OnIkI: $set['pc_appid'] = $region['pc_appid']; goto ezM1K; MdBdl: $pznopre = 'LEA'; goto sOJCA; W_W1x: tP8K9: goto a3M4l; sNnod: $content .= $printdetail; goto cs1vg; arJC6: $addmonths = intval($tag['qty'] / $location['finmonths']); goto Q8d5Z; BVef2: pdo_query($sql, array(":weid" => $log['uniacid'], ":bid" => $tag['bid'])); goto UNSol; bT4I3: njJ3u: goto MZeS7; URRZ_: FdX6D: goto MEUX9; uFmzH: $params = array("recordId " => $tag['recordid'], "carNum" => $tag['carno']); goto PF90l; zrEFx: $timestr .= !empty($hours) ? $days . '小时' : ''; goto oDiuM; M7Gvt: if (empty($this->syscfg['businesstplid'])) { goto mhABu; } goto ml0ck; IWdbB: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto YplbG; CwNlP: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto lbb4z; AQVN8: Zd5Z1: goto zTL2e; d2_rD: $post_data['port'] = $tag['port']; goto xsEC3; sgGyB: $content1 .= '类别:办理月卡<BR>'; goto iaExA; Ap02P: $this->send_mycustextmsg($property['title'], '尊敬的' . $tag['title'] . '业主及住户，您的缴费我们已收到(' . $daterange . $feeitemtitle . ':' . $fee . '元)，感谢您的支持！', $log['openid']); goto Lo11L; Zh7TE: $maxdate = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto GsCSS; L8RI7: if (!($res['ecode'] == 0)) { goto knW0X; } goto cqmaF; H1PL4: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto o10od; vnX8z: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":carno" => $tag['carno'])); goto lcGRV; mOsug: $content .= '缴费类别:' . $feeitemtitle . '\\n'; goto wsSQe; t1iqJ: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'], ":carno" => $tag['carno'])); goto FHI9R; JrUL4: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":carno" => $tag['carno'])); goto nuUwY; JRplP: mc_notice_credit1($log['openid'], $tag['payuser'], $feecredit, '缴费' . $fee . '送' . $feecredit . '积分', $crediturl, '谢谢支持，点击查看详情'); goto nWa10; cntYR: $amount = mt_rand($task['minamount'], $task['maxamount']); goto z8uCz; CtCtu: KB371: goto YV6tE; o94iE: m1uny: goto S_Eqg; lHKnq: if ($charging['devtype'] == 1) { goto DBjhi; } goto Qbd4i; v5wjX: $this->mysyslog(0, 'error', '停车缴费', '停车缴费支付失败', '操作失败' . $res['MsgStr'] . $tag['recordid']); goto G_QKS; HUTKb: wP7d3: goto qAWfR; yKwEj: xxjWT: goto oLpki; cRXIu: pdo_insert('rhinfo_zycj_region_creditlog', $credit_data); goto aDkdp; t349k: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto Bab0B; UswgE: $addmonths = $addmonths * $parklot['givemonths']; goto Rpnbe; HybXf: $content = '<FB><center>缴费通知单</center></FB>\\n'; goto UTS30; ri0cA: $paymethod = '支付方式:支付宝\\n'; goto qd59B; Tszwx: QNdpd: goto tR1MJ; nqdSq: pdo_insert('rhinfo_zyxq_mycar', $mycar_data); goto sCyFR; LaWGl: iX021: goto XpuWa; YccGQ: DO9KV: goto CjXAD; d0vJw: goto eXQJ1; goto NHhen; xZnTZ: $minutes = intval($timediff % 86400 % 3600 / 60); goto wkiPC; K2lcT: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto tb6gM; hAbTz: if ($parklot['pc_type'] == 4) { goto wP7d3; } goto Q2gRq; MU61p: if (empty($this->syscfg['businesstplid'])) { goto GXIFS; } goto aSfjn; qihc7: if (!($tag['feetype'] == 6)) { goto HquF3; } goto KtHeE; e8XMM: goto UR6hl; goto f2Qsd; PFUTc: $daterange = date('Y-m', $maxdate); goto EL4yW; Qbd4i: if ($charging['devtype'] == 2) { goto InYTM; } goto aBowN; Dv9Q1: $url = $this->my_mobileurl($redpacket['url']); goto Pl_R3; ryL41: if (!$res) { goto HM8N1; } goto mfFWk; Qx6Nt: pdo_query($sql, array(":weid" => $log['uniacid'], ":rid" => $room['rid'])); goto PSHXb; c4zIK: $sql = 'update ' . tablename('rhinfo_zyxq_property') . ' set onhand = onhand - ' . $feecredit . ', outqty= outqty + ' . $feecredit . ', outtime = ' . TIMESTAMP . ' where  weid = :weid and id=:pid'; goto e1DTD; jjCqz: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto eQRCw; IhxEj: pdo_insert('rhinfo_zycj_platform_credit_log', $credit_log_data); goto R6ea8; cXLux: jHJCc: goto yLY92; nCSuC: $data_car = array("weid" => $log['uniacid'], "uid" => $tag['payuser'], "openid" => $log['openid'], "carno" => $tag['carno'], "ctime" => TIMESTAMP); goto Zeyd9; aq3O0: goto WOGy8; goto Kbq9P; qAWfR: goto KB371; goto N9JZy; ED5i3: $timediff = TIMESTAMP - $tag['intime']; goto GnuEf; eb9_F: if (!empty($redpacket['url'])) { goto IzWpJ; } goto sF1cs; WlMB8: $url = $this->createMobileUrl('home', array("op" => "index")); goto hqUuI; fYfIv: oo7jJ: goto UGEz0; nuUwY: if (!($total == 0)) { goto XAPA2; } goto rOOGS; e1DTD: pdo_query($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto C2r55; ZQH66: $total = pdo_fetchcolumn($sql, array(":weid" => $log['uniacid'], ":uid" => $tag['payuser'], ":carno" => $tag['carno'])); goto V3HU2; hqUuI: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto K63I6; F5yMA: $post_data['charge_time'] = $rule['hour'] * 60; goto PrVpR; xLn6g: GBTLU: goto mgGjd; pFqoQ: $parkpayid = pdo_insertid(); goto oFDRo; FRBV3: $sql = 'select * from ' . tablename('rhinfo_zycj_selfwashcar') . ' where weid=:weid and id=:id'; goto S44N_; pmrXF: if (!$res) { goto lQgI2; } goto iFoUQ; k1tif: $sql = 'select * from ' . tablename('rhinfo_zyxq_region') . ' where weid = :weid and id=:rid '; goto oCNk2; tXSnK: if (empty($this->syscfg['businesstplid'])) { goto AsU04; } goto GxbRg; fun6C: TlezI: goto p7DWc; ooSp0: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto H2lIV; } goto qmdsZ; m_ZgL: if ($res['ecode'] == 0) { goto HPYVf; } goto kC1Nu; qMeGQ: if ($resmsg['ErrNo'] == '0000') { goto LSh30; } goto uBh__; AEWnI: exit; goto PKxBz; X7Jhb: ri6rZ: goto SMIE6; DcVqV: $set['url'] = 'api/prepayByThirdWay.action'; goto OlsJ2; N9JZy: T7Y09: goto tDSbF; tGfky: $car_data = array("weid" => $log['uniacid'], "pid" => $region['pid'], "rid" => $region['id'], "carno" => $tag['carno'], "title" => $tag['carno'], "ownername" => $tag['realname'], "mobile" => $tag['mobile'], "uid" => $tag['uid'], "openid" => $log['openid'], "cuid" => $tag['uid'], "ctime" => TIMESTAMP); goto NgYGa; aqYrJ: pdo_insert('rhinfo_zycj_business_creditlog', $credit_data); goto VPk_W; G4vhK: $set['ds_appid'] = $this->syscfg['ds_appid']; goto oUpfR; Q2Ijt: $res = ipms_httpsign_post($set, $params); goto WX78G; CkEe4: $res = ykdev_http_post($set, $post_data); goto RQQUp; WdhQ9: $parkpayid = pdo_insertid(); goto VOrnc; L8oZE: pdo_insert('rhinfo_zyxq_mycar', $mycar_data); goto W9R7U; hwAHe: oOb4V: goto Pz2tU; L4mZt: if (empty($parklot['pc_plotid'])) { goto RXF1B; } goto VuEcc; lpdm_: goto owMy2; goto OGn0r; TLunx: nVHX_: goto tqGAF; he1yH: $sql = 'select * from ' . tablename('rhinfo_zyxq_parkinglot') . ' where weid = :weid and rid=:rid and  id = :parkid '; goto qRpBR; Bmvtj: if ($park['pc_type'] == 1) { goto PvLFx; } goto G1WnB; LtyEx: if (!empty($whitelist)) { goto atnrm; } goto deE1Q; mTByg: $this->mysyslog(0, 'error', '停车办理月卡', '月卡延期失败' . $tag['carno'], '操作失败' . $resmsg['ErrMsg']); goto fLuyg; l0P1p: if (!($tag['feetype'] == 4)) { goto MOa45; } goto Lnx0Y; LcVFI: $sql = 'SELECT `key`,`secret` FROM ' . tablename('account_wechats') . ' WHERE `acid`=:acid'; goto EZNVJ; VyBpN: pdo_update('rhinfo_zyxq_parkpay_log', array("status" => 1), array("weid" => $log['uniacid'], "id" => $parkpayid)); goto U9m9Y; bEczU: C6HtG: goto MAzLF; CDrXx: $postdata = array("first" => array("value" => $parklot['title']), "keyword1" => array("value" => $fee, "color" => $topcolor), "keyword2" => array("value" => $log['tid'], "color" => $textcolor), "remark" => array("value" => '月卡有效期' . $tag['startdate'] . '~' . $enddate . ',感谢支持')); goto EHYFk; TDjdg: $set['url'] = 'add.php'; goto o596n; aH9Pp: if (!$this->syscfg['isplatformcredit']) { goto QNdpd; } goto GBDTu; YplbG: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto kfUR3; d2TSk: Dq7wU: goto LusDl; zLYZ1: $crediturl = $this->my_mobileurl($crediturl); goto wPE4y; Q2gRq: if ($parklot['pc_type'] == 5) { goto T7Y09; } goto bFSr4; yLY92: gslou: goto vorwN; GsCSS: if ($mindate == $maxdate) { goto SdruF; } goto crJdb; WOcbm: pdo_update('rhinfo_zycj_express', array("paystatus" => 1), array("weid" => $log['uniacid'], "sid" => $tag['sid'], "id" => $tag['expressid'])); goto CiAqg; ynHJc: cHrlR: goto a2GqD; cs1vg: $content1 .= $printdetail1; goto MXs37; I07qQ: $credit_data = array("weid" => $log['uniacid'], "pid" => $tag['pid'], "rid" => $tag['rid'], "io" => 1, "credit" => $mycredit, "title" => "用积分抵扣费用", "openid" => $log['openid'], "status" => 1, "cuid" => 0, "ctime" => TIMESTAMP); goto v2jWX; iYNno: pdo_insert('rhinfo_zyxq_paylog', $data); goto w62sM; OlsJ2: $params = array("recordId" => $tag['recordid']); goto Q2Ijt; UGxOn: $params = array("plantNum" => $tag['carno'], "orderNo" => $res['orderNo'], "realMoney" => $fee, "payTime" => time(), "reduceCost" => 0); goto CSJ7n; PWSZo: $region = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":pid" => $tag['pid'], ":rid" => $tag['rid'])); goto EfAqv; kC1Nu: $this->mysyslog(0, 'error', '停车办理月卡', '月卡延期失败' . $tag['carno'], '操作失败' . $res['msg']); goto lUUVS; xTdOp: $params = array("CarNo" => $tag['carno'], "UserName" => $tag['realname'], "OperType" => "Delay", "Fee" => $fee * 100, "StartTime" => date('YmdHis', strtotime($tag['startdate'])), "EndTime" => date('YmdHis', strtotime($enddate)), "CarType" => "月卡A", "CardStatus" => 0, "Balance" => 0, "MachList" => $machlist, "SetNo" => "000"); goto f0gxD; E4D7D: pdo_insert('rhinfo_zyxq_paylog', $data); goto LKQWv; NY41l: if (!empty($res)) { goto Zefk8; } goto E3j1v; Lnx0Y: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto id4D6; } goto u12vJ; JshQv: $set['url'] = 'add.php'; goto kG_nP; Ti2Bq: exit; goto O14Up; BOuMq: $sql = 'select * from ' . tablename('rhinfo_zyxq_secuser') . ' where weid=:weid and pid=:pid and uid=0'; goto c7GDZ; OGn0r: s1X75: goto lVvcj; FTa1Q: if ($tag['compid'] > 0) { goto MoN8i; } goto jo7Hc; CfkFl: Zefk8: goto tqPhf; NLwc7: if ($task['redcate'] == 1) { goto FqpA6; } goto R1H4B; yzaSB: if (!($params['from'] == 'return')) { goto TVIsC; } goto M3cF6; MxkoT: if (empty($task)) { goto vloRY; } goto GSXQP; aBowN: if ($charging['devtype'] == 3) { goto ekJ6d; } goto IoG3K; V585n: $res = pdo_update('rhinfo_zyxq_car_whitelist', $data_white, array("weid" => $log['uniacid'], "id" => $whitelist['id'])); goto oex1W; Q8d5Z: $addmonths = $addmonths * $parklot['givemonths']; goto R6lH4; WShvn: owMy2: goto jzb66; tAG61: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_car') . ' where weid=:weid and pid=:pid and rid=:rid and carno=:carno and deleted=0'; goto GQZCL; uOyXe: if (!($location['finmonths'] > 0 && $location['givemonths'] > 0)) { goto J1cQk; } goto PJe4O; Tbujp: gJyXl: goto JYGpU; nLEDQ: pdo_query($sql, array(":weid" => $log['uniacid'], ":bid" => $tag['businessid'])); goto TDXPN; GnuEf: $days = intval($timediff / 86400); goto AntZp; UTS30: $content .= $parklot['title'] . '\\n'; goto V4QTn; yHbat: pdo_query($sql, array(":weid" => $log['uniacid'], ":pid" => $room['pid'])); goto LE_7O; xo4GU: $content1 .= '车牌:' . $tag['carno'] . '<BR>'; goto oOTkE; eQaGm: $res = mc_credit_update($tag['payuser'], 'credit1', -$mycredit, array(0, "用积分抵扣费用", "rhinfo_zyxq")); goto bVwCV; Ci5T5: $sql = 'select distinct title from ' . tablename('rhinfo_zyxq_feebill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto PHpoU; RfBXJ: V4YpQ: goto U4_bf; DbgrL: $paymethod = '支付方式:微信\\n'; goto aSK6T; YVRID: if ($park['pc_type'] == 4) { goto EN51l; } goto vq9RA; c9xMy: pdo_insert('rhinfo_zyxq_paylog', $data); goto FXt3I; KmQ3d: CmGZ3: goto OKUOp; wMf1C: qTpm8: goto iQFi5; X57Rp: H2lIV: goto gWrVL; ts0nH: $res = $res['data']; goto Qlse6; CqOJy: $plat_data = array("weid" => $log['uniacid'], "io" => 2, "credit" => $credit, "title" => "销售积分", "cuid" => $tag['payuser'], "ctime" => TIMESTAMP); goto eE00u; XcIAl: lRDHG: goto GS2Qr; W1E2r: load()->model('payment'); goto T1lfV; Sq0ML: goto jD0FD; goto yKwEj; xm0ju: pdo_insert('rhinfo_zycj_business_creditlog', $credit_data); goto tiMnK; GSXQP: $sql = 'select * from ' . tablename('rhinfo_zycj_task_member') . ' where weid=:weid and taskid=:taskid and id=:parentid'; goto h2vso; iUpq8: foreach ($parkios as $vio) { $machlist .= $vio['MachNo'] . '_'; wBLqo: } goto W_W1x; nlJWU: $res = pdo_insert('rhinfo_zyxq_car_whitelist', $data_white); goto LvMRS; XAnWL: pdo_update('rhinfo_zyxq_property', array("startdate" => date(), "enddate" => strtotime('+1 year')), array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto So8Yz; zv2ia: $this->syscfg = pdo_get('rhinfo_zyxq_sysset', array("weid" => $params['uniacid'])); goto KBgC7; avCgu: LSh30: goto xeNSF; iXxDi: ieAC8: goto Itwcz; I236p: w74qb: goto sTXi0; lvwgj: vEcVf: goto EGkFE; XTs8T: $inout = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":id" => $tag['ioid'])); goto axbft; XXl5y: $whitelist = pdo_get('rhinfo_zyxq_car_whitelist', array("weid" => $log['uniacid'], "parklotid" => $tag['parkid'], "carno" => $tag['carno'])); goto LtyEx; LqOm3: AsU04: goto PQcbz; S44N_: $selfdevice = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":id" => $tag['selfid'])); goto HVVxE; QEejT: goto KB371; goto HUTKb; mAxWo: $this->mysyslog(0, 'error', '停车办理月卡', '月卡建立异常' . $tag['carno'], '操作失败' . $res['resultMsg']); goto lpdm_; kA6aM: $printdetail1 = ''; goto bZaZS; FZaMV: exit; goto z2Xnk; a4PeR: if ($region['feebillmonth'] == 1) { goto xxjWT; } goto uA_vM; AntZp: $hours = intval($timediff % 86400 / 3600); goto BVe1I; uQveV: goto e7vt8; goto LVs3d; uEXMp: $feeitemtitle = '租赁相关费用'; goto ZqcEX; wdoPS: U9Z7V: goto l2xXX; l7gYd: L_lgz: goto Xt6xP; Kiqwc: Bp4o8: goto KPGEW; lEsyL: J8qLI: goto XXl5y; fhCJQ: $tag = unserialize($log['tag']); goto NeZrG; AGna0: $sql = 'select min(enddate) from ' . tablename('rhinfo_zyxq_feebill') . ' where weid=:weid and pid=:pid and rid=:rid and id in(' . $feebillid . ')'; goto xz_0y; NDJhE: $set['pc_secret'] = $region['pc_secret']; goto tvKCJ; VOrnc: if (empty($tag['recordid'])) { goto ZewHn; } goto ige6Y; M6_D0: mc_notice_credit1($parent['openid'], $parent['uid'], $task['credit2'], '邀请到店消费,完成任务赠送' . $task['credit2'] . '元', $crediturl, '谢谢支持，点击查看详情'); goto yhAnH; WVZIi: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto fQjCu; } goto q2ZC7; h1ENS: exit; goto fP_5D; RYVll: $content1 .= $paymethod1 . '<RIGHT>' . $property['title'] . '</RIGHT>'; goto U2B3K; khZAt: SdruF: goto Bo9kL; Vi7sy: $sql = 'select * from ' . tablename('rhinfo_zycj_platform_credit') . ' where weid=:weid'; goto qmKhh; ZzqNW: $set = array(); goto TDjdg; GOEel: $set['url'] = 'add.php'; goto Z36VW; l_c7a: $res = mc_credit_update($tag['payuser'], 'credit1', $feecredit, array(0, '缴费' . $fee . '送' . $feecredit . '积分', "rhinfo_zyxq")); goto Q_b2_; dwSkL: knW0X: goto NIYJ3; fzfdX: pdo_insert('rhinfo_zyxq_paylog', $data); goto wDOBq; mRsXT: if (!($params['from'] == 'return')) { goto AAeVH; } goto waqrJ; wRkve: FvJ5S: goto SYrta; nbaOc: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_wepay_log') . ' WHERE `tid`=:tid'; goto lqpOE; opDv4: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto ET5w3; Z9UJI: $res = etpcar_http_post($set, $params); goto MMc6I; vCr2n: if (!($params['from'] == 'return')) { goto aJYN6; } goto FT6qh; qiOUi: goto WLwdV; goto CtpQ4; zThRd: Op7r6: goto XnHfU; lhdw9: $params = array("plantNum" => $tag['carno'], "cardTypeId" => 2, "page" => 1, "size" => 1); goto eggoP; l2nlX: if (empty($this->syscfg['businesstplid'])) { goto Nvb_Z; } goto DKi8g; K63I6: $this->send_mysendtplnotice($log['openid'], $this->syscfg['businesstplid'], $postdata, '', $topcolor); goto byY6B; SzIt_: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto UbUbG; SOOxZ: OUXgy: goto QVYAY; OK3rD: HxVbb: goto J9uez; L5FvB: C_1Sb: goto WShvn; X7v0K: if (!($tag['feetype'] == 13)) { goto S7Ax0; } goto q7G32; Xufmp: if (!empty($res)) { goto T7grg; } goto Dztiv; SCq7D: if (!($platcredit['onhand'] >= $credit)) { goto n18tL; } goto VDrBl; ylMdZ: $trade_no = $res['trade_no']; goto BukiO; s9w4u: uTguN: goto Hpswk; aYyk8: $timestr .= !empty($minutes) ? $days . '分钟' : ''; goto p2dVG; azCpN: QvzSP: goto JTMI1; YmMmY: exit; goto w5BmV; HI6r6: $parking = pdo_fetch($sql, array(":weid" => $log['uniacid'], ":rid" => $tag['rid'], ":parkingid" => $tag['parkingid'])); goto wzxeG; eS8KC: $url = $this->createMobileUrl('home', array("op" => "index")); goto TlYVN; LKQWv: $sql = 'select * from ' . tablename('rhinfo_zycj_business') . ' where weid=:weid and id = :id'; goto pywZi; vq9RA: if ($park['pc_type'] == 5) { goto lWq5t; } goto kmCqO; EK8km: $sql = 'select * from ' . tablename('rhinfo_zycj_task_member') . ' where weid=:weid and parentid=:parentid and status=0 '; goto EnkJ9; rd0Xt: PaIAa: goto MDe3k; FijDz: $printpznum = createpznum(substr($pzno, strlen($pznopre), 12)); goto xX_cY; sF1cs: $url = $this->my_mobileurl($this->createMobileUrl('home', array("op" => "index"))); goto BnVMx; OK2Ay: if (!($total == 0)) { goto HEy8h; } goto zmPDI; V0pLq: $creditset = array(); goto oyAe0; qITnC: if ($business['creditrule'] == 1) { goto Eicx6; } goto DmObd; ML9_B: $days = intval($timediff / 86400); goto M2hn3; qIdKb: pdo_insert('rhinfo_zycj_express_smslog', $smslog_data); goto TLunx; Nnt67: U2Epy: goto Xvrye; ufjwM: twhMW: goto iXx0y; iXx0y: $property = pdo_fetch('select * from ' . tablename('rhinfo_zyxq_property') . ' where weid=:weid and id=:pid', array(":weid" => $log['uniacid'], ":pid" => $tag['pid'])); goto PQtPJ; tGCsc: mc_notice_credit1($parent['openid'], $parent['uid'], $task['credit1'], '邀请到店消费,完成任务赠送' . $task['credit1'] . '积分', $crediturl, '谢谢支持，点击查看详情'); goto d2TSk; wC3kB: pdo_insert('rhinfo_zycj_charging_log', $charging_log); goto nRgSp; SbFfA: if ($res['ecode'] == 0) { goto yEgk0; } goto i9EQI; CtpQ4: M3pAP: goto PFUTc; jgBQd: if (!($params['result'] == 'success' && $params['from'] == 'notify')) { goto m1uny; } goto iK0rs; w9hgr: $enddate = $tag['enddate']; goto GtCu8; FT6qh: $url = $this->my_mobileurl($this->createMobileUrl('home')); goto RiOPz; kC1Xp: goto gt_47; goto ZXFtg; qwNhp: QdeTY: goto e14ly; ovpJa: $set = array("url" => "app/getLaneList.aspx", "parkno" => $parklot['pc_plotid'], "secret" => $parklot['pc_secret']); goto Ahxu0; u1PyK: if (!($res['code'] == 1)) { goto cHrlR; } goto ulf29; dXCUr: D2bV_: goto zSSF5; b47Lq: Ip87H: goto G6Ps0; gKFA3: exit; goto E532R; qWHoV: dZzkM: goto VyBpN; AsLcN: $set = array("url" => "app/UpPayNotify.aspx", "parkno" => $park['pc_plotid'], "secret" => $park['pc_secret']); goto Uxtsg; xX_cY: $printpznum = $pznopre . $printpznum; goto ACFJ7; S_Eqg: if (!($params['from'] == 'return')) { goto A7jtl; } goto NNEO2; kKKb0: $sql = 'update ' . tablename('rhinfo_zyxq_car_iolog') . ' set payfee = payfee + ' . $fee . ',payuid=' . $tag['payuser'] . ',payopenid=' . $log['openid'] . ' where  weid = :weid and id=:ioid '; goto yac4D; o9Ala: header('Location:' . $url); goto ikEjx; sOr8B: $topcolor = empty($this->syscfg['topcolor']) ? '#FF683F' : $this->syscfg['topcolor']; goto ObZ4e; uHW7x: $sql = 'select count(*) from ' . tablename('rhinfo_zyxq_mycar') . ' where weid=:weid and uid=:uid and carno=:carno'; goto XqqOF; Ys9LC: goto GBTLU; goto v5cjm; ssU1n: $url = str_replace('addons/rhinfo_zyxq/', '', $this->syscfg['siteurl']) . 'app' . substr($url, 1, strlen($url)); goto ZKw9p; XgCN0: if (!($params['from'] == 'return')) { goto Qi0xN; } goto cw3_U; z1oi4: if (empty($this->syscfg['businesstplid'])) { goto mFwvi; } goto sdg34; O66cs: BY1o8: goto DKGqu; gBXbW: $sql = 'select t.* from ' . tablename('rhinfo_zyxq_team') . ' as t left join ' . tablename('rhinfo_zyxq_category') . ' as c on t.cid=c.id where t.weid=:weid and t.pid = :pid and t.rid = :rid and c.right12=1 and c.type=4'; goto G8RD3; rIbjd: header('Location:' . $url); goto Gstm7; NAvpG: $data['pid'] = $tag['pid']; goto LpO68; y2ARr: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto oK6p0; rDBvY: $minutes = intval($timediff % 86400 % 3600 / 60); goto iI0EZ; Sfvpu: $timediff = TIMESTAMP - $tag['intime']; goto ML9_B; o10od: $textcolor = empty($this->syscfg['textcolor']) ? '#000' : $this->syscfg['textcolor']; goto BfWfD; MZeS7: exit; goto kUh0q; pNL3n: $url = $this->createMobileurl('member', array("op" => "credit1")); goto D9HJg; LVs3d: RnM5s: goto p7jcm; cGatV: $post_data['time'] = $rule['hour'] * 60; goto d2_rD; cwNp8: if (!$res) { goto txnw5; } goto b29VC; IYktf: message('请返回微信查看付款结果.', $url, 'success'); goto YYIgy; WD1KP: zm7vI: goto EA2fX; F03_p: $crediturl = $this->createMobileurl('member', array("op" => "credit1")); goto Fb_9U; dNib_: } public function my_platform_pay($payparams) { goto SGS1x; T1qJK: $wOpt['package'] = $res['apiPackage']; goto Kgf3M; pT7GB: $payno = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'])); goto mE36T; PL7vV: cQvqL: goto myJrk; N4Pm5: goto Kax1N; goto dyVQ8; xR9Ng: if (empty($payparams['expid'])) { goto DL9Zb; } goto WuNEc; t05Lu: oqurS: goto bf2na; spU5P: if (!is_error($res)) { goto jspNc; } goto de3B_; mPd8H: $wechat['trade_type'] = 'MWEB'; goto cQF0H; Z6Htd: goto i91rd; goto fe1ef; cQF0H: $wechat['openid'] = ''; goto xb4Uw; A4rLT: if ($this->syscfg['iswap'] && $this->rhinfo_wap) { goto V0rQb; } goto Govtn; ojMxa: goto Kax1N; goto rcIGL; uBIX2: $wechat['mchid'] = $this->syscfg['servicemerchid']; goto K67Tk; LLVsO: bFhOx: goto xR9Ng; tJsgu: lRdvu: goto Y0_Yb; LIp78: $myps['ordersn'] = $payno; goto S4W3c; xb4Uw: if ($this->syscfg['iswxpay'] == 1) { goto GJlbD; } goto aeiIz; UBeDx: if (empty($payparams['iswxapp'])) { goto b46aW; } goto JcjcL; YSLDX: NlC74: goto vXpL7; XqgZv: $myps['yearprice'] = $payparams['yearprice']; goto c7m3n; K6TCY: $wechat['appid'] = $this->syscfg['serviceappid']; goto ludLS; TGA6h: goto JaXll; goto b0cYP; sms7K: $payno = $paynopre . $payno; goto Jz5qo; M5aa3: if (empty($this->syscfg['serviceappid'])) { goto ul3Tp; } goto ou1BS; HxVsp: $wechat['appid'] = $row['key']; goto n1HJO; ac5Gj: $wechat['sub_mch_id'] = trim($this->syscfg['submerchid']); goto CTvDH; I2H8L: pLZre: goto WH89M; mKnsC: return array("errno" => 1, "message" => "支付失败", "result" => ""); goto StyVZ; OqefX: $wechat['appid'] = $this->syscfg['appid']; goto kfaNQ; YFt6H: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto u05Ef; eg3oF: if (empty($payparams['shareid'])) { goto Mo30W; } goto XDFGA; ZU0E2: $myps['module'] = 'rhinfo_zyxq'; goto LIp78; u05Ef: Kax1N: goto yNH6m; mWrJd: yrBz6: goto mmMNd; a8nAA: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto jlwC5; ludLS: $wechat['secret'] = $this->syscfg['serviceappsecret']; goto oxLw9; f7QFD: cWnUm: goto LYlwj; XNu0v: V1CxE: goto iUKvN; wus3P: $myps['bid'] = $payparams['bid']; goto t05Lu; fpjNh: $sql = 'select max(payno) from' . tablename('rhinfo_zyxq_paylog') . ' where weid = :weid and payno like \'' . $paynopre . '%\''; goto pT7GB; fe1ef: XJyxH: goto LQZJf; ZzQCW: if (empty($payparams['smsqty'])) { goto SmAAk; } goto T0QZs; oVUrJ: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto XNu0v; b0cYP: K1OKl: goto y4QaE; hJaV3: unset($wechat['sub_mch_id']); goto N4Pm5; hSQ48: pdo_insert('rhinfo_zyxq_wepay_log', $log); goto hMOQc; Eg74x: $bank_wechat['startrm'] = $this->syscfg['startrm']; goto WPSMo; de3B_: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto zjw0g; StyVZ: xPZeL: goto s_9De; WH89M: $wOpt['mweb_url'] = $MWEB_URL; goto CPQnU; tu437: goto i91rd; goto VF5ZI; eQht_: $bank_wechat['appid'] = $wechat['appid']; goto Fiy5W; awkSP: if (empty($payparams['pid'])) { goto E84z2; } goto O6tQc; sepQn: SmAAk: goto oawPr; rcIGL: akjWL: goto M5aa3; k5V6I: $myps['rid'] = $payparams['rid']; goto dS2C1; VVhsZ: $wOpt['timeStamp'] = $res['apiTimestamp']; goto bGlYO; kxkwr: i91rd: goto NiQVj; LB5yX: b46aW: goto DPDW2; qH0L5: $fee = $payparams['money']; goto fFs3Q; fFs3Q: $params = array("tid" => $payno . random(8, 1), "ordersn" => $payno, "uniontid" => $uniontid, "title" => $payparams['title'], "fee" => $fee, "user" => $_W['member']['uid']); goto tDbn6; oxLw9: ul3Tp: goto NOSIM; T0QZs: $myps['smsqty'] = $payparams['smsqty']; goto sepQn; S5Cfn: Kbvwo: goto uJ0yT; WQ6Ok: goto JaXll; goto muIxc; LYlwj: $wechat = $setting['payment']['wechat']; goto b_0IZ; K67Tk: JaXll: goto S5Cfn; DlIou: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto aJcnk; A0l1_: if ($this->syscfg['iswxpay'] == 3) { goto cQvqL; } goto uTIeH; LQZJf: $wOpt['PrepayId'] = $res['PrepayId']; goto yId_7; Govtn: if ($this->syscfg['iswxpay'] == 1) { goto a1hXO; } goto Lq4uZ; s7dTz: $uniontid = date('YmdHis') . $moduleid . random(8, 1); goto qH0L5; Fiy5W: $bank_wechat['ymfurl'] = $this->syscfg['iswxpay'] == 3 ? $this->syscfg['ymfurl'] : 'https://pay.swiftpass.cn/pay/gateway'; goto txV6g; uJ0yT: $wOpt = my_wechat_build($params, $wechat); goto azKUf; oawPr: if (empty($payparams['yearprice'])) { goto MKJXy; } goto XqgZv; b_0IZ: $wechat['account'] = !empty($wechat['account']) ? $wechat['account'] : $_W['uniacid']; goto JBTAk; A3YyW: goto Kax1N; goto tJsgu; T7Nzc: return array("errno" => 0, "message" => "success", "result" => array("wechat" => array("iswepay" => 1, "params" => base64_encode(json_encode($params))))); goto mWrJd; vXpL7: if (empty($payparams['compid'])) { goto bFhOx; } goto du2_z; y4QaE: if (empty($this->syscfg['serviceappid'])) { goto W2hp5; } goto Q7Tbz; cRjj6: WA0H8: goto PUgio; Tyv3d: $bank_wechat['openid'] = $_W['openid']; goto eQht_; FuYRa: $row = pdo_fetch($sql, array(":acid" => $wechat['account'])); goto HxVsp; LR7IQ: $wOpt['returl'] = $payparams['returl']; goto DlIou; PUgio: if (!($this->syscfg['iswap'] && $this->rhinfo_wap && !empty($wOpt['mweb_url']))) { goto J_GcA; } goto KaGc_; du2_z: $myps['compid'] = $payparams['compid']; goto LLVsO; qJNKY: E84z2: goto NnJGT; gJeOS: $wechat['mchid'] = $this->syscfg['merchid']; goto VB6zc; ubj7A: J_GcA: goto LR7IQ; lzZCl: $wOpt = array(); goto A0l1_; HBCdI: if (!($wOpt['message'] == 'invalid out_trade_no' || $wOpt['message'] == 'OUT_TRADE_NO_USED')) { goto xPZeL; } goto mKnsC; eC6hL: $myps['feetype'] = $payparams['feetype']; goto gQNLg; bGlYO: $wOpt['nonceStr'] = $res['apiNoncestr']; goto T1qJK; Mqd2x: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto tu437; XDFGA: $myps['shareid'] = $payparams['shareid']; goto BqnHK; mZSwU: DL9Zb: goto eg3oF; tDbn6: $myps = array(); goto ZU0E2; iUKvN: $paynopre = !empty($this->syscfg['paynopre']) ? $this->syscfg['paynopre'] : 'Pay'; goto fpjNh; gs4Zz: $bank_wechat['successurl'] = $payparams['returl']; goto oNRck; JcjcL: $myps['iswxapp'] = $payparams['iswxapp']; goto LB5yX; NOSIM: $wechat['sub_mch_id'] = trim($this->syscfg['submerchid']); goto uHr_1; s_9De: return array("errno" => 1, "message" => '支付失败' . $wOpt['errno'] . ':' . $wOpt['message'], "result" => ""); goto cRjj6; aqxj_: V0rQb: goto mPd8H; jLU_r: $wOpt['ymfurl'] = $res['url']; goto Mqd2x; Q7Tbz: $wechat['sub_appid'] = $wechat['appid']; goto VInRw; qx3Nn: if ($this->syscfg['iswxpay'] == 3 || $this->syscfg['iswxpay'] == 4 || $this->syscfg['iswxpay'] == 5) { goto lRdvu; } goto hJaV3; WuNEc: $myps['expid'] = $payparams['expid']; goto mZSwU; u016g: $wechat['mchid'] = $this->syscfg['merchid']; goto mKHha; c7m3n: MKJXy: goto xUGos; BqnHK: Mo30W: goto UBeDx; azKUf: if (!is_error($wOpt)) { goto WA0H8; } goto HBCdI; mKHha: $wechat['signkey'] = $this->syscfg['merchsecret']; goto ojMxa; Lq4uZ: if ($this->syscfg['iswxpay'] == 2) { goto akjWL; } goto qx3Nn; dyVQ8: a1hXO: goto OqefX; VF5ZI: z1_EK: goto n8eTI; muIxc: GJlbD: goto IF2Up; y5bjW: $wechat['secret'] = $this->syscfg['serviceappsecret']; goto JqhoU; FMDUq: $res = my_bankPay($mypay_params, $bank_wechat, $this->syscfg['iswxpay']); goto spU5P; FKInk: if (!(!is_array($setting['payment']) && empty($this->syscfg['iswxpay']))) { goto V1CxE; } goto oVUrJ; WPSMo: $bank_wechat['starkey'] = $this->syscfg['starkey']; goto FMDUq; n8eTI: $wOpt = json_decode($res['pay_info'], true); goto Z6Htd; Avhqz: $wechat['mchid'] = $this->syscfg['servicemerchid']; goto A3YyW; zjw0g: jspNc: goto lzZCl; n1HJO: $wechat['secret'] = $row['secret']; goto Y1h48; oNRck: $bank_wechat['starorg'] = $this->syscfg['starorg']; goto Zw2q9; aeiIz: if ($this->syscfg['iswxpay'] == 2) { goto K1OKl; } goto WQ6Ok; okHKh: $wechat['secret'] = $this->syscfg['secret']; goto gJeOS; LOF76: if ($this->syscfg['iswxpay'] == 5) { goto XJyxH; } goto ceG_y; hMOQc: if (!($this->syscfg['iswepay'] == 1)) { goto yrBz6; } goto sCn2J; IF2Up: $wechat['appid'] = $this->syscfg['appid']; goto okHKh; sJb2B: $MWEB_URL .= '&redirect_url=' . urlencode($url); goto I2H8L; SGS1x: global $_W, $_GPC; goto Wb52x; uTIeH: if ($this->syscfg['iswxpay'] == 4) { goto z1_EK; } goto LOF76; zVqPR: goto i91rd; goto PL7vV; DPDW2: $log = array("uniacid" => $_W['uniacid'], "acid" => $_W['acid'], "uniontid" => $uniontid, "type" => "wechat", "openid" => $_W['openid'], "module" => "rhinfo_zyxq", "tid" => $params['tid'], "fee" => $params['fee'], "card_fee" => $params['fee'], "status" => 0, "is_usecard" => "0", "card_id" => 0, "uid" => $_W['member']['uid'], "pid" => $myps['pid'], "rid" => $myps['rid'], "feetype" => $myps['feetype'], "tag" => serialize($myps), "paytime" => TIMESTAMP); goto hSQ48; sqoJV: $bank_wechat['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto gs4Zz; uNn_E: $wechat['notify_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/wechat/notify.php'; goto MgOJw; NiQVj: $wOpt['returl'] = $payparams['returl']; goto YFt6H; DoCRd: $myps['payuser'] = $_W['member']['uid']; goto eC6hL; CTvDH: $wechat['signkey'] = $this->syscfg['servicemerchsecret']; goto uBIX2; pqsin: $wOpt['paySign'] = $res['apiPaysign']; goto kxkwr; Y0_Yb: $bank_wechat = array(); goto a8nAA; JBTAk: $sql = 'SELECT `key`,`secret` FROM ' . tablename('account_wechats') . ' WHERE `acid`=:acid'; goto FuYRa; Jz5qo: $moduleid = pdo_fetchcolumn('SELECT mid FROM ' . tablename('modules') . ' WHERE name = :name', array(":name" => "rhinfo_zyxq")); goto fmLb6; VInRw: $wechat['appid'] = $this->syscfg['serviceappid']; goto y5bjW; yId_7: $wOpt['appId'] = $res['apiAppid']; goto VVhsZ; VB6zc: $wechat['signkey'] = $this->syscfg['merchsecret']; goto TGA6h; ZkVD1: return array("errno" => 0, "message" => "success", "result" => array("wechat" => base64_encode(json_encode($params)))); goto f7QFD; KaGc_: $MWEB_URL = $wOpt['mweb_url']; goto PoL2A; mmMNd: if (!$payparams['iswxapp']) { goto cWnUm; } goto ZkVD1; ceG_y: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto zVqPR; sCn2J: $params['merchid'] = $this->syscfg['ymfmerchid']; goto T7Nzc; xUGos: if (empty($payparams['bid'])) { goto oqurS; } goto wus3P; NnJGT: if (empty($payparams['rid'])) { goto rE0Y1; } goto k5V6I; gQNLg: $myps['openid'] = $_W['openid']; goto awkSP; Kgf3M: $wOpt['signType'] = $res['apiSigntype']; goto pqsin; D3WO4: $setting = uni_setting($_W['uniacid'], array("payment")); goto FKInk; MgOJw: $wechat['trade_type'] = 'JSAPI'; goto TwQ7A; CPQnU: $wOpt['iswap'] = 1; goto ubj7A; ou1BS: $wechat['sub_appid'] = $wechat['appid']; goto K6TCY; JqhoU: W2hp5: goto ac5Gj; uHr_1: $wechat['signkey'] = $this->syscfg['servicemerchsecret']; goto Avhqz; O6tQc: $myps['pid'] = $payparams['pid']; goto qJNKY; jlwC5: $bank_wechat['bankmerchid'] = $this->syscfg['iswxpay'] == 3 ? $this->syscfg['ymfmerchid'] : $this->syscfg['rsdmerchid']; goto Tyv3d; yNH6m: goto Kbvwo; goto aqxj_; txV6g: $bank_wechat['bankkey'] = strpos($this->syscfg['rsdmerchsecret'], base64_encode('rhinfo')) !== false ? $this->syscfg['rsdmerchsecret'] : md5('rhinfo'); goto sqoJV; bf2na: if (empty($payparams['sid'])) { goto NlC74; } goto ZBqPp; kfaNQ: $wechat['secret'] = $this->syscfg['secret']; goto u016g; Y1h48: $wechat['openid'] = $_W['openid']; goto uNn_E; mE36T: $payno = createnum(substr($payno, strlen($paynopre), 14)); goto sms7K; S4W3c: $myps['title'] = $payparams['title']; goto DoCRd; TwQ7A: $wechat['sub_mch_id'] = ''; goto A4rLT; ZBqPp: $myps['sid'] = $payparams['sid']; goto YSLDX; fmLb6: $moduleid = empty($moduleid) ? '000000' : sprintf('%06d', $moduleid); goto s7dTz; dS2C1: rE0Y1: goto ZzQCW; myJrk: $wOpt['isymf'] = 1; goto jLU_r; Wb52x: load()->model('payment'); goto D3WO4; PoL2A: if (empty($payparams['returl'])) { goto pLZre; } goto sJb2B; Zw2q9: $bank_wechat['starmerchid'] = $this->syscfg['starmerchid']; goto Eg74x; aJcnk: } public function my_single_pay($payparams) { goto ReZRA; IScpI: if (!is_error($res)) { goto CAJJO; } goto c3aM0; L8s7w: $bank_wechat['starorg'] = $property['starorg']; goto aVaQg; xhCpN: AGkh8: goto AwMAC; Ei0zk: if ($this->syscfg['iswxpay'] == 5) { goto iyXir; } goto Ag3ut; CSyTY: $myps['qty'] = $payparams['qty']; goto wNIMf; LXk_v: $bank_wechat['bankkey'] = strpos($this->syscfg['rsdmerchsecret'], base64_encode('rhinfo')) !== false ? $this->syscfg['rsdmerchsecret'] : md5('rhinfo'); goto ez8HP; VZhq8: if (!($this->syscfg['iswap'] && $this->rhinfo_wap)) { goto jWKwJ; } goto fydPS; WFtEm: p0uKF: goto anrkF; hsK_h: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $payparams['rid'])); goto ICVCE; qmlFV: vxGcO: goto Mn1z8; puzxm: $bank_wechat['ymfurl'] = $property['paytype'] == 3 ? $property['ymfurl'] : 'https://pay.swiftpass.cn/pay/gateway'; goto RqHCR; laeTB: b85JU: goto AIqFr; ZM5Ry: if (empty($payparams['port'])) { goto fBSQk; } goto ut9of; o6ajA: goto akAsr; goto CKCm0; FwGVF: if (empty($payparams['iswxapp'])) { goto b85JU; } goto DER60; wUDtb: if (empty($payparams['startdate'])) { goto vQQS0; } goto qwciK; WRSsx: $wechat['openid'] = ''; goto gm7ow; BhKbQ: if (!($this->syscfg['iswepay'] == 1)) { goto L_0Dy; } goto Wl88X; MOgvW: goto dVuek; goto RRoou; sDwxV: OqDSN: goto d1q1M; edwRe: $wechat['appid'] = $row['key']; goto wjADE; CS54N: iyXir: goto mx9Qm; JYgNv: goto dVuek; goto Tm0TM; jMTxw: pv9VX: goto DzTpO; VPJa1: if (empty($payparams['enddate'])) { goto A5A5o; } goto DH6rq; nETmI: $bank_wechat['successurl'] = $payparams['returl']; goto vKAJr; kXD0v: $wechat['signkey'] = $this->syscfg['merchsecret']; goto MVlY9; fl7VK: $bank_wechat['bankmerchid'] = $this->syscfg['iswxpay'] == 3 ? $this->syscfg['ymfmerchid'] : $this->syscfg['rsdmerchid']; goto wOeKk; kW8AG: $wechat['signkey'] = $this->syscfg['servicemerchsecret']; goto XJHEn; Mn1z8: $wechat['sub_mch_id'] = trim($this->syscfg['submerchid']); goto kW8AG; Epfi4: $wechat['sub_appid'] = $wechat['appid']; goto O9mxs; Uf4dt: $myps['mobile'] = $payparams['mobile']; goto sKhq0; WlsEs: if (empty($payparams['pid'])) { goto GPVVL; } goto JycjV; PQ0_v: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto UhAIu; h1wnN: $wechat['sub_mch_id'] = trim($property['submerchid']); goto Nsq0s; Rsmtr: $wOpt['paySign'] = $res['apiPaysign']; goto QrT7J; f9Orz: gmB2f: goto ZM5Ry; t8PRn: $bank_wechat = array(); goto SXbPE; qvg_v: $bank_wechat['bankmerchid'] = $region['paytype'] == 3 ? $region['bankmerchid'] : $region['rsdbankmerchid']; goto BCdgL; ucztr: D9mnR: goto GiVlz; VEMSv: $wechat['secret'] = $this->syscfg['secret']; goto wleBj; XKIYM: $wOpt['returl'] = $payparams['returl']; goto AEGff; JycjV: $myps['pid'] = $payparams['pid']; goto ddShN; TH91C: if ($this->syscfg['iswxpay'] == 3) { goto DtV1R; } goto BOMaX; ICVCE: goto hVeXc; goto mqrVv; mZl_Q: if ($region['ispay'] == 1 && ($region['paytype'] == 3 || $region['paytype'] == 4 || $region['paytype'] == 5)) { goto fkbfX; } goto N7zhT; zPiC8: $bank_wechat['appid'] = $wechat['appid']; goto puzxm; Ci5Vl: $bank_wechat['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto MP8Rg; N7zhT: if ($property['ispay'] == 1 && $property['paytype'] == 2 && !empty($property['submerchid'])) { goto I_m2d; } goto q3Gqs; Wl88X: if ($region['ispay'] == 1) { goto p0uKF; } goto O3GOs; Y3LIL: $myps['feetype'] = $payparams['feetype']; goto PJZB9; MoZib: G3SeA: goto R5fe_; lu7Mm: YAzu8: goto DgcRB; ru5ij: $wechat['appid'] = $sysconfig['serviceappid']; goto KHNnG; oIAQA: $wechat['trade_type'] = 'JSAPI'; goto D6v1A; TY7gV: if (empty($payparams['rid'])) { goto tvG9z; } goto REZMB; ReZRA: global $_W, $_GPC; goto WCshO; c3aM0: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto Rg33v; Hta1k: if (empty($payparams['expressid'])) { goto emjy6; } goto IsOTU; hGXSn: goto MlesW; goto pJZFf; d2Yvg: $wechat['sub_mch_id'] = trim($region['submerchid']); goto Lul63; q1oVF: $payno = $paynopre . $payno; goto hkWG9; dhPxu: $bank_wechat['appid'] = $wechat['appid']; goto un2m7; wlvyd: if (empty($url)) { goto D9mnR; } goto l0is2; wolCC: $row = pdo_fetch($sql, array(":acid" => $wechat['account'])); goto edwRe; r5Kv4: $wOpt['appId'] = $res['apiAppid']; goto RULdq; fBNlV: b8HsC: goto U1Apb; R5fe_: if (!($this->syscfg['iswap'] && $this->rhinfo_wap && !empty($wOpt['mweb_url']))) { goto OqDSN; } goto uQqHA; WSAoy: if (empty($payparams['carno'])) { goto AfZ0U; } goto vBsxv; DS_Nf: if ($property['paytype'] == 4) { goto Sbn7w; } goto YU6Kw; E9S_j: $wOpt['PrepayId'] = $res['PrepayId']; goto h0DmE; BZlI0: $myps['idcard'] = $payparams['idcard']; goto qaXQF; XfSsR: BEOGo: goto t8PRn; ct4Vp: $myps['chargid'] = $payparams['chargid']; goto h9DF5; O3GOs: $params['merchid'] = $this->syscfg['ymfmerchid']; goto PswjS; ez8HP: $bank_wechat['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto nETmI; r212X: z0GBg: goto yEGEf; Tm0TM: fgGsO: goto OyL9W; IDBRb: BWbLD: goto WSAoy; c0WkR: $myps['ioid'] = $payparams['ioid']; goto xhCpN; xUHhs: $myps['recordid'] = $payparams['recordid']; goto kb4bR; U1wLm: $bank_wechat['openid'] = $_W['openid']; goto zPiC8; UhAIu: VDMUT: goto hSpWu; S2dTE: hlBSe: goto b4i3L; CKCm0: iqhjt: goto E9S_j; UBHJO: $myps['bid'] = $payparams['bid']; goto iyqCq; lhmc6: if (!is_error($res)) { goto UeJiX; } goto Q1Ut3; hkWG9: $moduleid = pdo_fetchcolumn('SELECT mid FROM ' . tablename('modules') . ' WHERE name = :name', array(":name" => "rhinfo_zyxq")); goto vxmrQ; GO4Ev: $sql = 'select max(payno) from' . tablename('rhinfo_zyxq_paylog') . ' where weid = :weid and payno like \'' . $paynopre . '%\''; goto IAJ0z; dhWg2: $uniontid = date('YmdHis') . $moduleid . random(8, 1); goto Kgu3L; isKn8: $sql = 'SELECT `key`,`secret` FROM ' . tablename('account_wechats') . ' WHERE `acid`=:acid'; goto wolCC; UoI33: $bank_wechat['starmerchid'] = $region['starmerchid']; goto D_r0c; jJDVb: if (empty($payparams['qty'])) { goto fWqmx; } goto CSyTY; PJZB9: $myps['openid'] = $_W['openid']; goto WlsEs; thnon: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto EPZRM; vBsxv: $myps['carno'] = $payparams['carno']; goto sEJZz; Pfw7P: fTiUf: goto h1wnN; RULdq: $wOpt['timeStamp'] = $res['apiTimestamp']; goto d_wht; wleBj: $wechat['mchid'] = $this->syscfg['merchid']; goto kXD0v; qaXQF: V1kGJ: goto iIj6t; ySvRy: if ($region['paytype'] == 3) { goto JZAdq; } goto lh8Mf; wtOae: $wOpt['ymfurl'] = $res['url']; goto ystXe; k7PfC: mYy_q: goto DcP8I; jQw9R: goto hVeXc; goto WVkW2; LQ5Ao: UeJiX: goto lpOVs; Yc60_: $myps['sid'] = $payparams['sid']; goto BlkVt; rMjOh: $myps['selfid'] = $payparams['selfid']; goto zF4gm; U1Apb: Mkl6M: goto Rm5OH; n7ly0: $wechat['secret'] = $this->syscfg['wxappsecret']; goto QTrrE; KVwPO: $wOpt['package'] = $res['apipackage']; goto soKF4; ZQD4z: if ($this->syscfg['iswap'] && $this->rhinfo_wap) { goto rQaJx; } goto ECv3h; lh8Mf: if ($region['paytype'] == 4) { goto fgGsO; } goto J9DXY; wjADE: $wechat['secret'] = $row['secret']; goto PrUMU; y3XNU: $payno = createnum(substr($payno, strlen($paynopre), 14)); goto q1oVF; IsOTU: $myps['expressid'] = $payparams['expressid']; goto iduLv; cMWn_: if (!is_error($wOpt)) { goto G3SeA; } goto q76hK; FgVtO: $res = my_bankPay($mypay_params, $bank_wechat, $region['paytype']); goto IScpI; Ibr2F: if (empty($payparams['selfid'])) { goto OdJqi; } goto rMjOh; Gzvf3: C87DJ: goto gzwsk; ezIVY: fBSQk: goto KXFp5; nGva_: I_m2d: goto PvvSx; KC5MD: goto RKLn_; goto XfSsR; jPe1k: $myps['parkingid'] = $payparams['parkingid']; goto r212X; XftHv: if (empty($payparams['parkid'])) { goto W4lKJ; } goto gBj6O; Ry57U: $wOpt['ymfurl'] = $res['url']; goto thnon; ystXe: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto bAei_; xKYlS: $wOpt['signType'] = $res['apisignType']; goto V2Zlc; AwMAC: if (empty($payparams['recordid'])) { goto B_bHz; } goto xUHhs; MGZ9O: if (empty($payparams['chargid'])) { goto yU69J; } goto ct4Vp; zQwHe: $res = my_bankPay($mypay_params, $bank_wechat, $property['paytype']); goto v6Gog; Km4Q9: $MWEB_URL = $wOpt['mweb_url']; goto wlvyd; bAei_: goto MlesW; goto myZk0; XTir1: $wechat['appid'] = $this->syscfg['serviceappid']; goto XG8e7; iVA1h: return array("errno" => 0, "message" => "success", "result" => array("wechat" => array("iswepay" => 1, "params" => base64_encode(json_encode($params))))); goto YQ6po; iduLv: emjy6: goto XftHv; SCzT0: $bank_wechat['startrm'] = $property['startrm']; goto MYUm0; zsJWk: $wechat['notify_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/wechat/notify.php'; goto oIAQA; OU0Xa: if (empty($payparams['ruleid'])) { goto gmB2f; } goto esZg2; Nhb1b: FaCL8: goto HypZ1; uzH5k: $setting = uni_setting($_W['uniacid'], array("payment")); goto Fjw0a; rwYSI: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto qvg_v; Fni91: $wOpt['PrepayId'] = $res['PrepayId']; goto r5Kv4; l0is2: $MWEB_URL .= '&redirect_url=' . urlencode($url); goto ucztr; YQ6po: L_0Dy: goto A3QcN; Y98MJ: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto CXILM; QrT7J: dVuek: goto XKIYM; p60iW: goto FyWzz; goto tWOjQ; I0jel: $wechat['mchid'] = $sysconfig['servicemerchid']; goto KC5MD; uoOA2: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto JYgNv; C7r9a: $wechat['signkey'] = $this->syscfg['wxmerchsecret']; goto YC5p1; KXFp5: if (empty($payparams['plus'])) { goto P235O; } goto tFi20; sGe7L: unset($wechat['sub_mch_id']); goto tX065; DgcRB: if (empty($payparams['idcard'])) { goto V1kGJ; } goto BZlI0; iIj6t: if (empty($payparams['compid'])) { goto C87DJ; } goto ob0H3; O9mxs: $wechat['appid'] = $sysconfig['serviceappid']; goto Aj2iQ; Wa07A: tvG9z: goto KaqiI; tOkj7: if (!empty($payparams['sid'])) { goto jzZQe; } goto n1y96; ECv3h: if ($this->syscfg['iswxpay'] == 1) { goto FaCL8; } goto X2CI3; qu37q: pdo_insert('rhinfo_zyxq_wepay_log', $log); goto tOkj7; Bt2jA: $wechat['sub_mch_id'] = ''; goto fBNlV; pBDk8: $bank_wechat['starmerchid'] = $this->syscfg['starmerchid']; goto PzvRy; q76hK: if (!($wOpt['message'] == 'invalid out_trade_no' || $wOpt['message'] == 'OUT_TRADE_NO_USED')) { goto mYy_q; } goto j_X7G; kcfFf: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_property') . ' WHERE weid=:weid and id=:pid'; goto GUwh1; D4CC9: $wechat['sub_appid'] = $wechat['appid']; goto ru5ij; YC5p1: $wechat['apikey'] = $this->syscfg['wxmerchsecret']; goto Bt2jA; otZuv: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto RFMeJ; HypZ1: $wechat['appid'] = $this->syscfg['appid']; goto VEMSv; bpBxs: $wOpt = array(); goto ySvRy; MP8Rg: $bank_wechat['successurl'] = !empty($property['paysuccessurl']) ? $property['paysuccessurl'] : $payparams['returl']; goto L8s7w; jvSnw: jyle2: goto jJDVb; Gdd51: $bank_wechat = array(); goto rwYSI; Nsq0s: $wechat['signkey'] = $sysconfig['merchsecret']; goto I0jel; X2CI3: if ($this->syscfg['iswxpay'] == 2) { goto hlBSe; } goto NMVT0; vK9v3: rQaJx: goto z7pRP; tXqbm: $myps = array(); goto zcuZj; TJkEb: $wOpt['isymf'] = 1; goto ieAW5; DER60: $myps['iswxapp'] = $payparams['iswxapp']; goto laeTB; VOTVm: akAsr: goto Y98MJ; ddShN: GPVVL: goto TY7gV; PrUMU: $wechat['openid'] = $_W['openid']; goto zsJWk; RkONq: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto rO_g0; gBj6O: $myps['parkid'] = $payparams['parkid']; goto d9G0d; a8jFE: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto mWwl4; ZAL4Z: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto fl7VK; QlIfc: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":bid" => $payparams['bid'])); goto Ipymm; cAlxI: $wOpt['package'] = $res['apipackage']; goto xKYlS; tsgb1: $wOpt['nonceStr'] = $res['apinonceStr']; goto KVwPO; zcuZj: $myps['module'] = 'rhinfo_zyxq'; goto kYaQF; XG8e7: $wechat['secret'] = $this->syscfg['serviceappsecret']; goto qmlFV; LfnpF: Exoaj: goto iVA1h; i_mX9: MlesW: goto otZuv; z7pRP: if (empty($this->syscfg['wxappid'])) { goto b8HsC; } goto Lr1hX; Q0TC7: $sql = 'SELECT * FROM ' . tablename('rhinfo_zycj_business') . ' WHERE weid=:weid and id=:bid'; goto QlIfc; omxTI: $bank_wechat['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto mrFAr; ut9of: $myps['port'] = $payparams['port']; goto ezIVY; YOc0y: $wOpt['paySign'] = $res['apiPaysign']; goto i_mX9; h9DF5: yU69J: goto OU0Xa; AEGff: return array("errno" => 0, "message" => "success", "result" => array("wechat" => $wOpt)); goto eVttK; tX065: goto FyWzz; goto Nhb1b; fdewX: Sbn7w: goto Insbt; RFMeJ: FyWzz: goto ah9V3; ah9V3: goto Mkl6M; goto vK9v3; sKhq0: ibSJ6: goto Nqqxb; QoE2r: $bank_wechat['starorg'] = $region['starorg']; goto UoI33; eVttK: goto RKLn_; goto nGva_; W6mN9: Msojp: goto FwGVF; NMVT0: if ($this->syscfg['iswxpay'] == 3 || $this->syscfg['iswxpay'] == 4 || $this->syscfg['iswxpay'] == 5) { goto ph8LD; } goto sGe7L; Rg33v: CAJJO: goto bpBxs; Q9D3G: A5A5o: goto nlZdI; KaqiI: if (empty($payparams['bid'])) { goto y6dXH; } goto UBHJO; gzwsk: if (empty($payparams['parkingid'])) { goto z0GBg; } goto jPe1k; WCshO: load()->model('payment'); goto uzH5k; XI8Wh: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $payparams['sid'])); goto jQw9R; uQqHA: $url = $this->my_mobileurl($this->createMobileUrl('member', array("op" => "index"))); goto Km4Q9; d1q1M: $wOpt['returl'] = $payparams['returl']; goto a8jFE; Rm5OH: goto RKLn_; goto jMTxw; DzTpO: if (empty($sysconfig['serviceappid'])) { goto vZULk; } goto Epfi4; PzvRy: $bank_wechat['startrm'] = $this->syscfg['startrm']; goto wzdaR; SblOt: $wOpt['timeStamp'] = $res['apitimeStamp']; goto tsgb1; XJHEn: $wechat['mchid'] = $sysconfig['servicemerchid']; goto p60iW; Ag3ut: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto hGXSn; CfV84: $bank_wechat = array(); goto ZAL4Z; A3QcN: if (!$payparams['iswxapp']) { goto cnHK4; } goto wAofM; tWOjQ: ph8LD: goto CfV84; YU6Kw: if ($property['paytype'] == 5) { goto iqhjt; } goto RkONq; pJZFf: DtV1R: goto BXZfb; REZMB: $myps['rid'] = $payparams['rid']; goto Wa07A; lGfMD: goto RKLn_; goto c1jcN; BlkVt: R6Qln: goto Hta1k; h0DmE: $wOpt['appId'] = $res['apiappId']; goto f_4VF; wAjdV: if (empty($payparams['sid'])) { goto R6Qln; } goto Yc60_; AUDH2: $wechat['sub_appid'] = $wechat['appid']; goto XTir1; ma1hz: $bank_wechat['appid'] = $wechat['appid']; goto CaPUr; FEC0O: $wechat['account'] = !empty($wechat['account']) ? $wechat['account'] : $_W['uniacid']; goto isKn8; JPomA: $params = array("tid" => $payno . random(8, 1), "ordersn" => $payno, "uniontid" => $uniontid, "title" => $payparams['title'], "fee" => $fee, "user" => $_W['member']['uid']); goto tXqbm; ddPnS: $bank_wechat['bankkey'] = strpos($region['bankkey'], base64_encode('rhinfo')) !== false ? $region['bankkey'] : md5('rhinfo'); goto omxTI; aVaQg: $bank_wechat['starmerchid'] = $property['starmerchid']; goto SCzT0; tR4m5: if ($region['ispay'] == 1 && $region['paytype'] == 2 && !empty($region['submerchid'])) { goto pv9VX; } goto mZl_Q; ob0H3: $myps['compid'] = $payparams['compid']; goto Gzvf3; mx9Qm: $wOpt['PrepayId'] = $res['PrepayId']; goto pn9yL; j_X7G: return array("errno" => 1, "message" => '支付失败' . $wOpt['message'], "result" => ""); goto k7PfC; K3Ys7: $wOpt['signType'] = $res['apiSigntype']; goto Rsmtr; Y5Fof: JZAdq: goto TJkEb; t1lit: $wechat = $setting['payment']['wechat']; goto FEC0O; q3Gqs: if ($property['ispay'] == 1 && ($property['paytype'] == 3 || $property['paytype'] == 4 || $property['paytype'] == 5)) { goto BEOGo; } goto ZQD4z; KV96m: $myps['intime'] = $payparams['intime']; goto IDBRb; QTrrE: $wechat['mchid'] = $this->syscfg['wxmerchid']; goto C7r9a; Kgu3L: $fee = $payparams['money']; goto JPomA; mu6xD: $wOpt = json_decode($res['pay_info'], true); goto E8F3p; WVkW2: BHkhu: goto Q0TC7; iyqCq: y6dXH: goto wAjdV; anrkF: $params['merchid'] = $region['bankmerchid']; goto LfnpF; tD2_h: $sysconfig = $this->module['config']; goto P3Tpt; qwciK: $myps['startdate'] = $payparams['startdate']; goto N3HKX; yEGEf: if (empty($payparams['billids'])) { goto Msojp; } goto dvZ0m; upetp: $bank_wechat['bankmerchid'] = $property['paytype'] == 3 ? $property['bankmerchid'] : $property['rsdbankmerchid']; goto U1wLm; Ipymm: hVeXc: goto BhKbQ; b4i3L: if (empty($this->syscfg['serviceappid'])) { goto vxGcO; } goto AUDH2; qXgwf: P235O: goto Ibr2F; yKWcz: cnHK4: goto t1lit; Lul63: $wechat['signkey'] = $sysconfig['merchsecret']; goto UY8ZG; yFf6T: if ($region['paytype'] == 3) { goto ADw0t; } goto DS_Nf; X1O_V: $bank_wechat['starkey'] = $region['starkey']; goto FgVtO; wzdaR: $bank_wechat['starkey'] = $this->syscfg['starkey']; goto YiNpR; RqHCR: $bank_wechat['bankkey'] = strpos($property['bankkey'], base64_encode('rhinfo')) !== false ? $property['bankkey'] : md5('rhinfo'); goto Ci5Vl; uZPkE: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto DbabA; vKLYA: $wOpt['package'] = $res['apiPackage']; goto K3Ys7; Aj2iQ: $wechat['secret'] = $sysconfig['serviceappsecret']; goto UOk0A; Insbt: $wOpt = json_decode($res['pay_info'], true); goto o6ajA; n1y96: if (!empty($payparams['bid'])) { goto BHkhu; } goto kcfFf; A6GCF: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto zHOKT; un2m7: $bank_wechat['ymfurl'] = $region['paytype'] == 3 ? $region['ymfurl'] : 'https://pay.swiftpass.cn/pay/gateway'; goto ddPnS; ETMyf: $myps['realname'] = $payparams['realname']; goto jvSnw; J9DXY: if ($region['paytype'] == 5) { goto AhMOD; } goto A6GCF; E8F3p: goto MlesW; goto CS54N; P3Tpt: $paynopre = !empty($this->syscfg['paynopre']) ? $this->syscfg['paynopre'] : 'Pay'; goto GO4Ev; CXILM: RKLn_: goto a28vq; kvr5z: ADw0t: goto EIh1e; DH6rq: $myps['enddate'] = $payparams['enddate']; goto Q9D3G; EPZRM: goto akAsr; goto fdewX; f_4VF: $wOpt['timeStamp'] = $res['apitimeStamp']; goto fs48p; mqrVv: jzZQe: goto NoawS; fs48p: $wOpt['nonceStr'] = $res['apinonceStr']; goto cAlxI; uhoNR: $myps['payuser'] = $_W['member']['uid']; goto Y3LIL; Lr1hX: $wechat['appid'] = $this->syscfg['wxappid']; goto n7ly0; FRKhN: $myps['parkingid'] = $payparams['parkingid']; goto lu7Mm; AIqFr: $log = array("uniacid" => $_W['uniacid'], "acid" => $_W['acid'], "uniontid" => $uniontid, "type" => "wechat", "openid" => $_W['openid'], "module" => "rhinfo_zyxq", "tid" => $params['tid'], "fee" => $params['fee'], "card_fee" => $params['fee'], "status" => 0, "is_usecard" => "0", "card_id" => 0, "uid" => $_W['member']['uid'], "pid" => $myps['pid'], "rid" => $myps['rid'], "feetype" => $myps['feetype'], "tag" => serialize($myps), "paytime" => TIMESTAMP); goto qu37q; D6v1A: $wechat['sub_mch_id'] = ''; goto VZhq8; rO_g0: goto akAsr; goto kvr5z; f_w1t: if (empty($payparams['intime'])) { goto BWbLD; } goto KV96m; mrFAr: $bank_wechat['successurl'] = !empty($region['paysuccessurl']) ? $region['paysuccessurl'] : $payparams['returl']; goto QoE2r; Zus4e: $myps['title'] = $payparams['title']; goto uhoNR; V2Zlc: $wOpt['paySign'] = $res['apiPaysign']; goto VOTVm; lpOVs: $wOpt = array(); goto TH91C; PvvSx: if (empty($sysconfig['serviceappid'])) { goto fTiUf; } goto D4CC9; nlZdI: if (empty($payparams['mobile'])) { goto ibSJ6; } goto Uf4dt; NoawS: $sql = 'SELECT * FROM ' . tablename('rhinfo_zycj_express_store') . ' WHERE weid=:weid and id=:sid'; goto XI8Wh; GiVlz: $wOpt['mweb_url'] = $MWEB_URL; goto Z0nlv; MYUm0: $bank_wechat['starkey'] = $property['starkey']; goto zQwHe; v6Gog: if (!is_error($res)) { goto VDMUT; } goto PQ0_v; BXZfb: $wOpt['isymf'] = 1; goto wtOae; SXbPE: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto upetp; d_wht: $wOpt['nonceStr'] = $res['apiNoncestr']; goto vKLYA; kYaQF: $myps['ordersn'] = $payno; goto Zus4e; soKF4: $wOpt['signType'] = $res['apisignType']; goto YOc0y; DcP8I: return array("errno" => 1, "message" => '支付失败:' . $wOpt['errno'] . ':' . $wOpt['message'], "result" => ""); goto MoZib; dvZ0m: $myps['billids'] = $payparams['billids']; goto W6mN9; c1jcN: fkbfX: goto Gdd51; GUwh1: $property = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":pid" => $payparams['pid'])); goto vmCLG; esZg2: $myps['ruleid'] = $payparams['ruleid']; goto f9Orz; RRoou: AhMOD: goto Fni91; zHOKT: goto dVuek; goto Y5Fof; zF4gm: OdJqi: goto Fv0VO; PswjS: goto Exoaj; goto WFtEm; vmCLG: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_region') . ' WHERE weid=:weid and id=:rid'; goto hsK_h; Nqqxb: if (empty($payparams['realname'])) { goto jyle2; } goto ETMyf; hSpWu: $wOpt = array(); goto yFf6T; UY8ZG: $wechat['mchid'] = $sysconfig['servicemerchid']; goto lGfMD; wAofM: return array("errno" => 0, "message" => "success", "result" => array("wechat" => base64_encode(json_encode($params)))); goto yKWcz; Fv0VO: if (empty($payparams['parkingid'])) { goto YAzu8; } goto FRKhN; fydPS: $wechat['trade_type'] = 'MWEB'; goto WRSsx; a28vq: $wOpt = my_wechat_build($params, $wechat); goto cMWn_; tFi20: $myps['plus'] = $payparams['plus']; goto qXgwf; Fjw0a: if (!(!is_array($setting['payment']) && empty($this->syscfg['iswxpay']))) { goto H7Vrh; } goto uZPkE; d9G0d: W4lKJ: goto e3nXi; BCdgL: $bank_wechat['openid'] = $_W['openid']; goto dhPxu; Q1Ut3: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto LQ5Ao; DbabA: H7Vrh: goto tD2_h; CaPUr: $bank_wechat['ymfurl'] = $this->syscfg['iswxpay'] == 3 ? $this->syscfg['ymfurl'] : 'https://pay.swiftpass.cn/pay/gateway'; goto LXk_v; kb4bR: B_bHz: goto f_w1t; ieAW5: $wOpt['ymfurl'] = $res['url']; goto uoOA2; Z0nlv: $wOpt['iswap'] = 1; goto sDwxV; vKAJr: $bank_wechat['starorg'] = $this->syscfg['starorg']; goto pBDk8; OyL9W: $wOpt = json_decode($res['pay_info'], true); goto MOgvW; sEJZz: AfZ0U: goto wUDtb; YiNpR: $res = my_bankPay($mypay_params, $bank_wechat, $this->syscfg['iswxpay']); goto lhmc6; wNIMf: fWqmx: goto MGZ9O; KHNnG: $wechat['secret'] = $sysconfig['serviceappsecret']; goto Pfw7P; vxmrQ: $moduleid = empty($moduleid) ? '000000' : sprintf('%06d', $moduleid); goto dhWg2; UOk0A: vZULk: goto d2Yvg; EIh1e: $wOpt['isymf'] = 1; goto Ry57U; e3nXi: if (empty($payparams['ioid'])) { goto AGkh8; } goto c0WkR; wOeKk: $bank_wechat['openid'] = $_W['openid']; goto ma1hz; myZk0: BJ83r: goto mu6xD; BOMaX: if ($this->syscfg['iswxpay'] == 4) { goto BJ83r; } goto Ei0zk; N3HKX: vQQS0: goto VPJa1; pn9yL: $wOpt['appId'] = $res['apiappId']; goto SblOt; D_r0c: $bank_wechat['startrm'] = $region['startrm']; goto X1O_V; MVlY9: goto FyWzz; goto S2dTE; gm7ow: jWKwJ: goto tR4m5; IAJ0z: $payno = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'])); goto y3XNU; mWwl4: } public function my_single_alipay($payparams) { goto BXGDS; lWPp_: if ($property['alipay_type'] == 1) { goto Iedcj; } goto nSYFG; P_Tc5: $alipay['secret'] = $region['alisecret']; goto VW2oi; ikB52: if (empty($payparams['sid'])) { goto YGHNx; } goto u93Dy; q8SDZ: $alipay['payfrom'] = 1; goto hHLrK; NjoC6: return array("errno" => 0, "message" => "success", "result" => array("wechat" => array("iswepay" => 1, "params" => base64_encode(json_encode($params))))); goto opsIo; omro_: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto FJnMU; lZJ12: Dgb93: goto JJU7y; F88Ld: vMZ8Z: goto U1Kja; JJU7y: if (empty($payparams['selfid'])) { goto fBQJe; } goto xiArb; CZfg8: RGpJn: goto n4cbp; r8R9w: if (empty($payparams['expressid'])) { goto yrYHW; } goto rqnV5; Ei68B: $myps['idcard'] = $payparams['idcard']; goto sGKK8; yIoED: $bank_alipay['starorg'] = $region['starorg']; goto Bi6o2; KSK9S: goto d9OdY; goto cKo4r; gksq9: L2KMi: goto Q201r; pGWE1: $bank_alipay['openid'] = $_W['openid_alipay']; goto RrtZj; KMkdx: Q8URu: goto yxD8G; AnT8_: if (empty($payparams['recordid'])) { goto CPNJe; } goto NMoRz; r6iRp: $alipay['secret'] = $this->syscfg['alisecret']; goto Ejw7v; va_Mm: if (!is_error($res)) { goto Ph8vj; } goto HheJU; SxGZu: $alipay['seller_id'] = $property['alipay_seller_id']; goto wKYzn; zgCg2: if (empty($payparams['ruleid'])) { goto HTRXZ; } goto lGEcH; xr0zB: yOvrr: goto ns3fg; oVe4Y: Iedcj: goto WXzTY; jRx3U: if (!($this->syscfg['iswepay'] == 1)) { goto Z0T02; } goto NjoC6; ns3fg: $alipay = $setting['payment']['alipay']; goto qqGSn; bkX2f: if ($this->rhinfo_isalipay) { goto gFITW; } goto uKSlT; urZpg: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto xr0zB; yCi8d: $myps['carno'] = $payparams['carno']; goto gksq9; DZmJa: DtK2y: goto LlW77; GyWhn: $alipay['openid'] = $_W['openid_alipay']; goto o9uMH; tGtkT: if (empty($payparams['rid'])) { goto ECP79; } goto Zf7eP; F_EM2: $myps['billids'] = $payparams['billids']; goto Emm_b; wihiT: $bank_alipay['starkey'] = $region['starkey']; goto MWz1B; lGEcH: $myps['ruleid'] = $payparams['ruleid']; goto pf5oZ; rVPdq: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":bid" => $payparams['bid'])); goto FjzfS; DdZmL: $fee = $payparams['money']; goto TqjQu; xiArb: $myps['selfid'] = $payparams['selfid']; goto Gy5jR; H3uwL: $log = array("uniacid" => $_W['uniacid'], "acid" => $_W['acid'], "uniontid" => $uniontid, "type" => "alipay", "openid" => $_W['openid'], "module" => "rhinfo_zyxq", "tid" => $params['tid'], "fee" => $params['fee'], "card_fee" => $params['fee'], "status" => 0, "is_usecard" => "0", "card_id" => 0, "uid" => $_W['member']['uid'], "pid" => $myps['pid'], "rid" => $myps['rid'], "feetype" => $myps['feetype'], "tag" => serialize($myps), "paytime" => TIMESTAMP); goto JQ0Xj; BiSTe: $bank_alipay = array(); goto BIc0R; ajHvQ: $bank_alipay = array(); goto MTMXH; At3hh: if (empty($payparams['enddate'])) { goto LV2ZR; } goto OABI4; qoX1i: O27qb: goto WZ1E7; yIyw_: $alipay['public_key'] = $property['alipay_rsa2']; goto x4SlX; PvAtL: if (!is_error($res)) { goto O2Bfl; } goto kef07; TqjQu: $params = array("tid" => $payno . random(8, 1), "ordersn" => $payno, "uniontid" => $uniontid, "title" => $payparams['title'], "fee" => $fee, "user" => $_W['member']['uid']); goto J8I8n; P1qlL: $myps['compid'] = $payparams['compid']; goto QRNyI; V2296: $bank_alipay['successurl'] = !empty($region['paysuccessurl']) ? $region['paysuccessurl'] : $payparams['returl']; goto yIoED; ahVYP: $alipay['appid'] = $region['alipay_appid']; goto FNW92; U3asG: $myps['parkid'] = $payparams['parkid']; goto F88Ld; QRNyI: NNS3k: goto u1bqb; t1Dqc: $myps['parkingid'] = $payparams['parkingid']; goto npBHQ; nDiob: $alipay['public_key'] = $this->syscfg['alipay_rsa2']; goto ywlAh; T9wEj: $myps['realname'] = $payparams['realname']; goto KMkdx; bqhE8: $alipay['private_key'] = $region['alipay_private']; goto DWnvh; wqQqH: if (empty($payparams['chargid'])) { goto zNhgL; } goto tWCKM; vw92O: return array("errno" => 0, "message" => "success", "result" => array("alipay" => array("trade_no" => $res['PrepayId'], "returl" => $payparams['returl']))); goto QRZlf; MTMXH: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto xv7au; esFSn: LV2ZR: goto RjdkA; EGaWu: $payno = $paynopre . $payno; goto LFAHF; jSulK: $myps['pid'] = $payparams['pid']; goto l8cq1; Vnt9A: if (empty($payparams['realname'])) { goto Q8URu; } goto T9wEj; Zf7eP: $myps['rid'] = $payparams['rid']; goto ONaBi; lQ1gL: $bank_alipay['startrm'] = $this->syscfg['startrm']; goto laV3W; iE3ye: if (empty($payparams['port'])) { goto TqY6Z; } goto YvQ8u; z8yLW: if (!is_error($res)) { goto tr5Eu; } goto rGga_; LlW77: goto u33b1; goto XkjGM; sGKK8: XuF11: goto bQTQY; vKtZK: $myps['title'] = $payparams['title']; goto oqlrS; Ink7M: $alipay['return_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/alipay/return.php'; goto koDed; fQdRI: $uniontid = date('YmdHis') . $moduleid . random(8, 1); goto DdZmL; jkuez: $myps['openid'] = $_W['openid']; goto XBpCU; xp18Y: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":rid" => $payparams['rid'])); goto phMru; Ejw7v: goto Lyc3Q; goto eA0Ir; hHLrK: if (!empty($alipay['appid'])) { goto RGpJn; } goto WtLh6; HxpwB: $bank_alipay['startrm'] = $region['startrm']; goto wihiT; zec6l: $alipay['partner'] = $property['alipartner']; goto rdlxZ; skR9a: $bank_alipay['starkey'] = $property['starkey']; goto xSPDS; eA0Ir: uRJY3: goto N9Yoz; rA2Qm: goto d9OdY; goto oVe4Y; NMoRz: $myps['recordid'] = $payparams['recordid']; goto s7zrU; Mv3aZ: goto NqoDm; goto J8WPh; pQ0j7: $alipay['partner'] = $this->syscfg['alipartner']; goto r6iRp; e3TKA: $ret = my_alipay_build2($params, $alipay); goto DxH0h; LFAHF: $moduleid = pdo_fetchcolumn('SELECT mid FROM ' . tablename('modules') . ' WHERE name = :name', array(":name" => "rhinfo_zyxq")); goto iZt_5; kef07: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto g9GHY; wKYzn: $alipay['app_auth_token'] = $property['alipay_app_auth_token']; goto F36rZ; z7ZbD: $bank_alipay['starorg'] = $this->syscfg['starorg']; goto dsjUR; EZN3T: $bank_alipay['startrm'] = $property['startrm']; goto skR9a; f8VQN: $myps['bid'] = $payparams['bid']; goto r3kzE; b7W3w: tr5Eu: goto TavXZ; xgjTt: if (empty($payparams['billids'])) { goto vK5KH; } goto F_EM2; nbV_1: u33b1: goto U7f9x; MWz1B: $res = my_bankPay($mypay_params, $bank_alipay, 8); goto va_Mm; Q201r: if (empty($payparams['startdate'])) { goto uR3Fv; } goto cgAgQ; VHfDh: $myps['plus'] = $payparams['plus']; goto lZJ12; ywlAh: $alipay['private_key'] = $this->syscfg['alipay_private']; goto WofQj; gZ4iH: $setting = uni_setting($_W['uniacid'], array("payment")); goto YrLrn; BXGDS: global $_W, $_GPC; goto tOIob; QG9M4: if (!empty($payparams['sid'])) { goto DqEAy; } goto QgB0Y; EpCkv: if ($this->rhinfo_isalipay) { goto OS7Oy; } goto e3TKA; qqGSn: $alipay['notify_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/alipay/notify.php'; goto Ink7M; BIc0R: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto pGWE1; xT6Cx: $myps['mobile'] = $payparams['mobile']; goto v8OS4; YslGW: goto g39xv; goto IuHV2; q6UEX: if (empty($payparams['plus'])) { goto Dgb93; } goto VHfDh; BlmOP: $res = my_bankPay($mypay_params, $bank_alipay, 8); goto PvAtL; IJcIB: if ($this->syscfg['alipay_type'] == 2) { goto c3xC2; } goto jRufj; YVo6e: $myps['ioid'] = $payparams['ioid']; goto nkMO7; fKuqk: $alipay['partner'] = $region['alipartner']; goto P_Tc5; ErT1A: $bank_alipay['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto Tp1lq; Een2I: if (empty($payparams['intime'])) { goto kJkF8; } goto YDPpe; lxchq: if ($property['ispay'] == 1 && $property['isalipay'] == 1) { goto F0Cpq; } goto u2E4y; rd2Vf: $alipay['openid'] = $_W['openid_alipay']; goto Mv3aZ; F36rZ: $alipay['openid'] = $_W['openid_alipay']; goto KSK9S; NCJb3: if ($region['alipay_type'] == 2) { goto e3MaS; } goto h_X3P; HuYTn: YGHNx: goto r8R9w; rGga_: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto b7W3w; gI6_G: if (!is_error($ret)) { goto SqDOP; } goto C8B26; tTt02: FJkxA: goto gI6_G; iqgxq: jjbiK: goto wqQqH; OFmQx: $sql = 'select max(payno) from' . tablename('rhinfo_zyxq_paylog') . ' where weid = :weid and payno like \'' . $paynopre . '%\''; goto ln2Hk; jjZ2k: kPqQK: goto tTt02; j4tTw: if (empty($payparams['bid'])) { goto KcFcm; } goto f8VQN; YvQ8u: $myps['port'] = $payparams['port']; goto qR5Lc; t52Pw: return array("errno" => 0, "message" => "success", "result" => array("alipay" => array("trade_no" => $res['PrepayId'], "returl" => $payparams['returl']))); goto c4YEx; rqnV5: $myps['expressid'] = $payparams['expressid']; goto B5HJ8; WXzTY: $alipay['appid'] = $property['alipay_appid']; goto yIyw_; laV3W: $bank_alipay['starkey'] = $this->syscfg['starkey']; goto BlmOP; Tp1lq: $bank_alipay['successurl'] = $payparams['returl']; goto z7ZbD; u1bqb: if (empty($payparams['parkingid'])) { goto VWLyO; } goto t1Dqc; Ds0mr: goto FJkxA; goto CZfg8; npBHQ: VWLyO: goto xgjTt; uKSlT: if (empty($ret['url'])) { goto DtK2y; } goto W7Dfc; DP7GJ: $alipay['app_auth_token'] = $region['alipay_app_auth_token']; goto rd2Vf; DxH0h: goto kPqQK; goto QRxnQ; C8B26: return array("errno" => 1, "message" => $ret['message'], "result" => ""); goto LH5Dn; tOIob: load()->model('payment'); goto gZ4iH; OABI4: $myps['enddate'] = $payparams['enddate']; goto esFSn; pn9YS: if (empty($payparams['carno'])) { goto L2KMi; } goto yCi8d; QRxnQ: OS7Oy: goto xPu7i; yxD8G: if (empty($payparams['qty'])) { goto jjbiK; } goto hKEP5; ln2Hk: $payno = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'])); goto Nezx5; gGkg6: $bank_alipay['successurl'] = !empty($property['paysuccessurl']) ? $property['paysuccessurl'] : $payparams['returl']; goto rX6u5; XBpCU: if (empty($payparams['pid'])) { goto Z7iW4; } goto jSulK; opsIo: Z0T02: goto QG9M4; xv7au: $bank_alipay['openid'] = $_W['openid_alipay']; goto ErT1A; erjiv: uR3Fv: goto At3hh; r3kzE: KcFcm: goto ikB52; JQ0Xj: pdo_insert('rhinfo_zyxq_wepay_log', $log); goto jRx3U; HheJU: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto iM_Dm; VbnHb: $bank_alipay['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto gGkg6; v8OS4: vPQir: goto Vnt9A; hKEP5: $myps['qty'] = $payparams['qty']; goto iqgxq; nTOOV: $myps['feetype'] = $payparams['feetype']; goto jkuez; u93Dy: $myps['sid'] = $payparams['sid']; goto HuYTn; dsjUR: $bank_alipay['starmerchid'] = $this->syscfg['starmerchid']; goto lQ1gL; u2E4y: if ($this->syscfg['alipay_type'] == 1) { goto uRJY3; } goto IJcIB; K4FQy: $bank_alipay = array(); goto omro_; WFfb1: goto KKHvC; goto u9vS3; rdlxZ: $alipay['secret'] = $property['alisecret']; goto rA2Qm; h_X3P: $alipay['account'] = $region['aliaccount']; goto fKuqk; e2STs: $myps['module'] = 'rhinfo_zyxq'; goto s1nG1; bQTQY: if (empty($payparams['parkingid'])) { goto O27qb; } goto UzkXo; Jkdhc: kJkF8: goto pn9YS; phMru: goto KKHvC; goto pbIp2; DNRns: $alipay['app_auth_token'] = $this->syscfg['alipay_app_auth_token']; goto GyWhn; FJnMU: $bank_alipay['openid'] = $_W['openid_alipay']; goto VbnHb; RrtZj: $bank_alipay['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto V2296; c4YEx: Lyc3Q: goto YslGW; nkMO7: gexwS: goto AnT8_; jkbDR: $region = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":sid" => $payparams['sid'])); goto WFfb1; pf5oZ: HTRXZ: goto iE3ye; YrLrn: if (!(!is_array($setting['payment']) && empty($this->syscfg['isalipay']))) { goto yOvrr; } goto urZpg; WEBoa: d9OdY: goto mszTg; xSPDS: $res = my_bankPay($mypay_params, $bank_alipay, 8); goto z8yLW; U1Kja: if (empty($payparams['ioid'])) { goto gexwS; } goto YVo6e; u2VvI: c3xC2: goto ajHvQ; RjdkA: if (empty($payparams['mobile'])) { goto vPQir; } goto xT6Cx; gDgzl: if (empty($payparams['parkid'])) { goto vMZ8Z; } goto U3asG; Emm_b: vK5KH: goto H3uwL; J8I8n: $myps = array(); goto e2STs; W7Dfc: return array("errno" => 0, "message" => "success", "result" => array("alipay" => base64_encode($ret['url']))); goto DZmJa; s7zrU: CPNJe: goto Een2I; i6hpF: zNhgL: goto zgCg2; N9Yoz: $alipay['appid'] = $this->syscfg['alipay_appid']; goto nDiob; x4SlX: $alipay['private_key'] = $property['alipay_private']; goto SxGZu; g9GHY: O2Bfl: goto t52Pw; IuHV2: F0Cpq: goto lWPp_; XkjGM: gFITW: goto Uids3; B5HJ8: yrYHW: goto gDgzl; s1nG1: $myps['ordersn'] = $payno; goto vKtZK; gQ0ta: $sql = 'SELECT * FROM ' . tablename('rhinfo_zycj_business') . ' WHERE weid=:weid and id=:bid'; goto rVPdq; WZ1E7: if (empty($payparams['compid'])) { goto NNS3k; } goto P1qlL; mszTg: g39xv: goto LCh0f; rX6u5: $bank_alipay['starorg'] = $property['starorg']; goto dYC9J; FjzfS: KKHvC: goto R8yAw; WtLh6: $ret = my_alipay_build($params, $alipay); goto Ds0mr; dYC9J: $bank_alipay['starmerchid'] = $property['starmerchid']; goto EZN3T; iM_Dm: Ph8vj: goto vw92O; pbIp2: DqEAy: goto LVoDR; koDed: $paynopre = !empty($this->syscfg['paynopre']) ? $this->syscfg['paynopre'] : 'Pay'; goto OFmQx; U7f9x: return array("errno" => 1, "message" => "获取支付参数失败", "result" => ""); goto BjrT4; Bi6o2: $bank_alipay['starmerchid'] = $region['starmerchid']; goto HxpwB; J8WPh: e3MaS: goto BiSTe; Uids3: return array("errno" => 0, "message" => "success", "result" => array("alipay" => array("trade_no" => $ret['trade_no'], "returl" => $payparams['returl']))); goto nbV_1; JXdRY: OqDJX: goto q8SDZ; mkoD1: $alipay['account'] = $property['aliaccount']; goto zec6l; l8cq1: Z7iW4: goto tGtkT; R8yAw: if ($region['ispay'] == 1 && $region['isalipay'] == 1) { goto IVNe_; } goto lxchq; u9vS3: H5FWF: goto gQ0ta; QRZlf: NqoDm: goto JXdRY; n4cbp: $alipay['notify_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/aliapp/notify.php'; goto EpCkv; xPu7i: $ret = my_alipay_build2($params, $alipay, 1); goto jjZ2k; nSYFG: if ($property['alipay_type'] == 2) { goto LWmAL; } goto mkoD1; cKo4r: LWmAL: goto K4FQy; oqlrS: $myps['payuser'] = $_W['member']['uid']; goto nTOOV; FNW92: $alipay['public_key'] = $region['alipay_rsa2']; goto bqhE8; YDPpe: $myps['intime'] = $payparams['intime']; goto Jkdhc; qR5Lc: TqY6Z: goto q6UEX; LCh0f: goto OqDJX; goto Lundj; VW2oi: goto NqoDm; goto i95sQ; iZt_5: $moduleid = empty($moduleid) ? '000000' : sprintf('%06d', $moduleid); goto fQdRI; QgB0Y: if (!empty($payparams['bid'])) { goto H5FWF; } goto VXQro; ONaBi: ECP79: goto j4tTw; VXQro: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_property') . ' WHERE weid=:weid and id=:pid'; goto dh5Ib; tWCKM: $myps['chargid'] = $payparams['chargid']; goto i6hpF; WofQj: $alipay['seller_id'] = $this->syscfg['alipay_seller_id']; goto DNRns; LH5Dn: SqDOP: goto bkX2f; LVoDR: $sql = 'SELECT * FROM ' . tablename('rhinfo_zycj_express_store') . ' WHERE weid=:weid and id=:sid'; goto jkbDR; Nezx5: $payno = createnum(substr($payno, strlen($paynopre), 14)); goto EGaWu; jRufj: $alipay['account'] = $this->syscfg['aliaccount']; goto pQ0j7; zg0Ix: if (empty($payparams['idcard'])) { goto XuF11; } goto Ei68B; UzkXo: $myps['parkingid'] = $payparams['parkingid']; goto qoX1i; i95sQ: yj3c8: goto ahVYP; dh5Ib: $property = pdo_fetch($sql, array(":weid" => $_W['uniacid'], ":pid" => $payparams['pid'])); goto ifk8F; DWnvh: $alipay['seller_id'] = $region['alipay_seller_id']; goto DP7GJ; TavXZ: return array("errno" => 0, "message" => "success", "result" => array("alipay" => array("trade_no" => $res['PrepayId'], "returl" => $payparams['returl']))); goto WEBoa; Gy5jR: fBQJe: goto zg0Ix; Lundj: IVNe_: goto Lae_4; o9uMH: goto Lyc3Q; goto u2VvI; cgAgQ: $myps['startdate'] = $payparams['startdate']; goto erjiv; Lae_4: if ($region['alipay_type'] == 1) { goto yj3c8; } goto NCJb3; ifk8F: $sql = 'SELECT * FROM ' . tablename('rhinfo_zyxq_region') . ' WHERE weid=:weid and id=:rid'; goto xp18Y; BjrT4: } public function my_platform_alipay($payparams) { goto hfaFX; BkdCt: return array("errno" => 0, "message" => "success", "result" => array("alipay" => array("trade_no" => $ret['trade_no'], "returl" => $payparams['returl']))); goto KPfj7; TldhY: $moduleid = empty($moduleid) ? '000000' : sprintf('%06d', $moduleid); goto nEwPQ; CnKgW: Xey0i: goto U0LJ1; kZu37: $myps['expid'] = $payparams['expid']; goto lTg8w; kvTG_: $bank_alipay['startrm'] = $this->syscfg['startrm']; goto dgNIM; lShTZ: $setting = uni_setting($_W['uniacid'], array("payment")); goto E8q9K; NwUWx: if (empty($ret['url'])) { goto bf2Yc; } goto z4d6v; pAjHo: vlAGw: goto XMy6c; ToE5Z: $moduleid = pdo_fetchcolumn('SELECT mid FROM ' . tablename('modules') . ' WHERE name = :name', array(":name" => "rhinfo_zyxq")); goto TldhY; ahXqy: $myps['rid'] = $payparams['rid']; goto k2bXb; jZhDO: P7Uar: goto Jbynk; GnV1N: $myps['title'] = $payparams['title']; goto z5XG0; H_vvr: mmWnF: goto vy7y4; i42DF: $params = array("tid" => $payno . random(8, 1), "ordersn" => $payno, "uniontid" => $uniontid, "title" => $payparams['title'], "fee" => $fee, "user" => $_W['member']['uid']); goto cuRLJ; z35Y4: $myps['sid'] = $payparams['sid']; goto uKjKQ; dkcxg: if (!empty($alipay['appid'])) { goto RrGkl; } goto mzV1B; iL_mN: goto dMQSS; goto eslQo; MiBUG: return array("errno" => 1, "message" => "获取支付参数失败", "result" => ""); goto xt29C; kUEFe: if (empty($payparams['smsqty'])) { goto P7Uar; } goto mawGm; VCxPi: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto n7NK9; E8q9K: if (!(!is_array($setting['payment']) && empty($this->syscfg['isalipay']))) { goto FeLOj; } goto VCxPi; nfYXA: if (!is_error($res)) { goto WGcY9; } goto STbID; XMy6c: $log = array("uniacid" => $_W['uniacid'], "acid" => $_W['acid'], "uniontid" => $uniontid, "type" => "alipay", "openid" => $_W['openid'], "module" => "rhinfo_zyxq", "tid" => $params['tid'], "fee" => $params['fee'], "card_fee" => $params['fee'], "status" => 0, "is_usecard" => "0", "card_id" => 0, "uid" => $_W['member']['uid'], "pid" => $myps['pid'], "rid" => $myps['rid'], "feetype" => $myps['feetype'], "tag" => serialize($myps), "paytime" => TIMESTAMP); goto gCkJe; Z5BXZ: RrGkl: goto kknLx; uM_Ga: $bank_alipay['starmerchid'] = $this->syscfg['starmerchid']; goto kvTG_; KJEdE: goto dfPpw; goto uIa7V; KPfj7: dfPpw: goto MiBUG; LtBxN: $payno = pdo_fetchcolumn($sql, array(":weid" => $_W['uniacid'])); goto fXia4; zzLYq: if (empty($payparams['pid'])) { goto AV_yJ; } goto W5fBN; uh98L: $alipay['account'] = $this->syscfg['aliaccount']; goto CRAlo; P5Ta7: goto MiUic; goto ZaLq6; foK5X: IOWow: goto PtjhF; uKjKQ: ZZKnm: goto Jwo5N; IQNYV: $payno = $paynopre . $payno; goto ToE5Z; eyIhF: QWuzj: goto Pbdxe; mawGm: $myps['smsqty'] = $payparams['smsqty']; goto jZhDO; WVJy0: $bank_alipay = array(); goto BzOj5; z4d6v: return array("errno" => 0, "message" => "success", "result" => array("alipay" => base64_encode($ret['url']))); goto cJmr8; CyaL7: $sql = 'select max(payno) from' . tablename('rhinfo_zyxq_paylog') . ' where weid = :weid and payno like \'' . $paynopre . '%\''; goto LtBxN; zs30i: if ($this->syscfg['alipay_type'] == 1) { goto IOWow; } goto gk395; cJmr8: bf2Yc: goto KJEdE; yMGOl: if ($this->rhinfo_isalipay) { goto ax8mx; } goto NwUWx; U0LJ1: if (empty($payparams['bid'])) { goto Qo_Vz; } goto Ie32V; qI241: load()->model('payment'); goto lShTZ; nEwPQ: $uniontid = date('YmdHis') . $moduleid . random(8, 1); goto n6LZI; STbID: return array("errno" => 1, "message" => '支付失败' . $res['message'], "result" => ""); goto J_h4_; nK255: $bank_alipay['starorg'] = $this->syscfg['starorg']; goto uM_Ga; T7DA1: if ($this->rhinfo_isalipay) { goto twjmj; } goto Asn7Y; PtjhF: $alipay['appid'] = $this->syscfg['alipay_appid']; goto ux702; J9xve: $paynopre = !empty($this->syscfg['paynopre']) ? $this->syscfg['paynopre'] : 'Pay'; goto CyaL7; JpkZl: goto MiUic; goto foK5X; oYco6: $myps['module'] = 'rhinfo_zyxq'; goto q1bH1; lh8hv: $myps['feetype'] = $payparams['feetype']; goto nMpbk; hfaFX: global $_W, $_GPC; goto qI241; bkng0: $alipay['app_auth_token'] = $this->syscfg['alipay_app_auth_token']; goto rtfoF; rtfoF: $alipay['openid'] = $_W['openid_alipay']; goto P5Ta7; bLvF9: return array("errno" => 1, "message" => $ret['message'], "result" => ""); goto dXkFq; S1wbZ: if (empty($payparams['shareid'])) { goto vlAGw; } goto o1JEc; ZaLq6: PQ06s: goto WVJy0; ZLgLX: $bank_alipay['notifyurl'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/bankpay/notify.php'; goto iQNDI; iQNDI: $bank_alipay['successurl'] = $payparams['returl']; goto nK255; gk395: if ($this->syscfg['alipay_type'] == 2) { goto PQ06s; } goto uh98L; Ie32V: $myps['bid'] = $payparams['bid']; goto R0ynu; n7NK9: FeLOj: goto shNsQ; cuRLJ: $myps = array(); goto oYco6; zscmf: $alipay['return_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/alipay/return.php'; goto J9xve; nMpbk: $myps['openid'] = $_W['openid']; goto zzLYq; vkPZU: if (!($this->syscfg['iswepay'] == 1)) { goto msVyG; } goto sGRNg; eslQo: twjmj: goto jX0MG; n6LZI: $fee = $payparams['money']; goto i42DF; Kub0s: if (empty($payparams['sid'])) { goto ZZKnm; } goto z35Y4; Zkpzf: $alipay['private_key'] = $this->syscfg['alipay_private']; goto G5CgI; mzV1B: $ret = my_alipay_build($params, $alipay); goto QD_vQ; ux702: $alipay['public_key'] = $this->syscfg['alipay_rsa2']; goto Zkpzf; shNsQ: $alipay = $setting['payment']['alipay']; goto sMAWV; o1JEc: $myps['shareid'] = $payparams['shareid']; goto pAjHo; G5CgI: $alipay['seller_id'] = $this->syscfg['alipay_seller_id']; goto bkng0; Asn7Y: $ret = my_alipay_build2($params, $alipay); goto iL_mN; q1bH1: $myps['ordersn'] = $payno; goto GnV1N; Pbdxe: if (!is_error($ret)) { goto q8rMs; } goto bLvF9; UCtE4: $alipay['payfrom'] = 1; goto dkcxg; BzOj5: $mypay_params = array("tid" => $params['tid'], "fee" => $params['fee'], "user" => $params['user'], "title" => urldecode($params['title']), "uniontid" => $params['uniontid'], "clientip" => $_W['clientip']); goto WofXZ; rdGUg: AV_yJ: goto tZmku; uIa7V: ax8mx: goto BkdCt; EXnSX: msVyG: goto zs30i; dgNIM: $bank_alipay['starkey'] = $this->syscfg['starkey']; goto wy2mk; sGRNg: return array("errno" => 0, "message" => "success", "result" => array("wechat" => array("iswepay" => 1, "params" => base64_encode(json_encode($params))))); goto EXnSX; tZmku: if (empty($payparams['rid'])) { goto QklfU; } goto ahXqy; Jbynk: if (empty($payparams['yearprice'])) { goto Xey0i; } goto AqBXD; fXia4: $payno = createnum(substr($payno, strlen($paynopre), 14)); goto IQNYV; z5XG0: $myps['payuser'] = $_W['member']['uid']; goto lh8hv; viMU4: dMQSS: goto eyIhF; ehBAM: return array("errno" => 0, "message" => "success", "result" => array("alipay" => array("trade_no" => $res['PrepayId'], "returl" => $payparams['returl']))); goto vzUVo; vy7y4: if (empty($payparams['expid'])) { goto Hgwz4; } goto kZu37; QD_vQ: goto QWuzj; goto Z5BXZ; ERQPZ: $alipay['secret'] = $this->syscfg['alisecret']; goto JpkZl; lTg8w: Hgwz4: goto S1wbZ; k2bXb: QklfU: goto kUEFe; J_h4_: WGcY9: goto ehBAM; AqBXD: $myps['yearprice'] = $payparams['yearprice']; goto CnKgW; R0ynu: Qo_Vz: goto Kub0s; gCkJe: pdo_insert('rhinfo_zyxq_wepay_log', $log); goto vkPZU; W5fBN: $myps['pid'] = $payparams['pid']; goto rdGUg; vzUVo: MiUic: goto UCtE4; Jwo5N: if (empty($payparams['compid'])) { goto mmWnF; } goto ja9rO; dXkFq: q8rMs: goto yMGOl; CRAlo: $alipay['partner'] = $this->syscfg['alipartner']; goto ERQPZ; WofXZ: $bank_alipay['openid'] = $_W['openid_alipay']; goto ZLgLX; jX0MG: $ret = my_alipay_build2($params, $alipay, 1); goto viMU4; wy2mk: $res = my_bankPay($mypay_params, $bank_alipay, 8); goto nfYXA; kknLx: $alipay['notify_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/aliapp/notify.php'; goto T7DA1; sMAWV: $alipay['notify_url'] = $this->syscfg['siteurl'] . 'addons/rhinfo_zyxq/payment/alipay/notify.php'; goto zscmf; ja9rO: $myps['compid'] = $payparams['compid']; goto H_vvr; xt29C: } public function my_scancode_pay($params, $property = array(), $region = array()) { goto lyi5H; S8IZC: $config = $this->module['config']; goto fn5Az; UHN33: if (!($paychannel == 'ALIPAY')) { goto zObm9; } goto JoN5D; WXqvX: if (!$res['errno']) { goto NyxrW; } goto MhxXj; rFHYK: $alipay['private_key'] = $property['alipay_private']; goto xLtg9; Yrnr6: if (empty($this->syscfg['appid'])) { goto ia8mh; } goto X1pF0; jRmdp: i2aGW: goto wazoX; JsFFu: $bank_wechat['starmerchid'] = $region['starmerchid']; goto H1THv; sYe9Z: SXQAA: goto SAvj7; lyi5H: global $_W, $_GPC; goto yjGte; GnqCG: return array("errno" => 1, "message" => $res['message'], "result" => ""); goto PLWHc; Pm4_w: if (!empty($config['serviceappid'])) { goto XVppd; } goto JmLyP; M3ut8: $mywechat = array(); goto fjb3H; P9_a1: Kmgf8: goto i8Cgm; MhxXj: return array("errno" => 1, "message" => $res['message'], "result" => ""); goto venqu; uV8pS: if (!is_error($res)) { goto GeUye; } goto Dp0ZR; VFrOU: uExZ0: goto RfSAu; xLtg9: $alipay['seller_id'] = $property['alipay_seller_id']; goto kwYmS; PLWHc: h02AF: goto kj7tU; y4giQ: $alipay['private_key'] = $region['alipay_private']; goto HjtEj; XL9ni: $mywechat['mch_id'] = $wechat['mchid']; goto pASVj; NykDr: $res = my_alipay_micropay_build($params, $alipay); goto YUhFk; sgCWo: $bank_wechat['ymfurl'] = $region['paytype'] == 3 ? $region['ymfurl'] : 'https://pay.swiftpass.cn/pay/gateway'; goto qQdlE; SAvj7: $payfrom = $property['paytype']; goto SPfE0; gR4ud: $bank_wechat['ymfurl'] = $property['paytype'] == 3 ? $property['ymfurl'] : 'https://pay.swiftpass.cn/pay/gateway'; goto XC4LF; xGlzA: $res = $this->repeat_wechat_order_query($params, $mywechat); goto YHuRB; gDHVE: goto SiRdE; goto P9_a1; u7pMX: goto sGOjo; goto a1n6d; vGPw1: Wu6T1: goto b7JHC; sAhZx: $mywechat['apikey'] = $config['merchsecret']; goto kql1h; gwCtz: $alipay['app_auth_token'] = $this->syscfg['alipay_app_auth_token']; goto kD2Fb; Grkm_: $bank_wechat['startrm'] = $property['startrm']; goto qD8hL; t9pPl: ef17f: goto FhfO0; LDsss: $mywechat['apikey'] = $this->syscfg['merchsecret']; goto u7pMX; NyP3O: goto sx9Y3; goto EZkh3; b7JHC: iFo3h: goto xGlzA; YEX9v: jPASM: goto uUm9f; Dri47: vB0q6: goto iQBYM; iUPih: lSCOj: goto pxi1J; Yw13K: $payfrom = $property['paytype']; goto mQdAd; JoN5D: $alipay = array(); goto ibXBD; qOb99: UsSX4: goto Yrnr6; ri6Xu: $mywechat['apikey'] = $config['merchsecret']; goto NyP3O; vFyco: $mywechat['mch_id'] = $config['servicemerchid']; goto NTonQ; cvY7Q: goto IK6Be; goto YEX9v; juTy3: $res = repeat_bank_order_query($params, $bank_wechat, $payfrom); goto vjSXY; z0dS6: $mywechat['appid'] = $this->syscfg['serviceappid']; goto Ju7T_; nFc9b: $setting = uni_setting($_W['uniacid'], array("payment")); goto cPhNt; SPfE0: goto IK6Be; goto IcvMM; UQnnM: if ($region['ispay'] == 1 && ($region['paytype'] == 3 || $region['paytype'] == 4 || $region['paytype'] == 5)) { goto jPASM; } goto etS2j; Pydak: $bank_wechat['bankmerchid'] = $region['paytype'] == 3 ? $region['bankmerchid'] : $region['rsdbankmerchid']; goto sgCWo; Ds0zQ: GeUye: goto zJuwz; LlyBI: $mywechat['sub_appid'] = $mywechat['appid']; goto W_zNt; qD8hL: $bank_wechat['starkey'] = $property['starkey']; goto Yw13K; bUAJy: goto IK6Be; goto dTSRM; qQdlE: $bank_wechat['bankkey'] = strpos($region['bankkey'], base64_encode('rhinfo')) !== false ? $region['bankkey'] : md5('rhinfo'); goto wLH8T; wwFvP: sGOjo: goto S8IZC; crnxB: $alipay['app_auth_token'] = $region['alipay_app_auth_token']; goto Ez0pB; zJuwz: if ($payfrom == 3) { goto vB0q6; } goto X7Bqg; gZo41: $bank_wechat = array(); goto mNt6O; To_2X: if ($this->syscfg['iswxpay'] == 1) { goto UsSX4; } goto kD4G3; EDC7T: goto GF2m5; goto Dri47; venqu: NyxrW: goto t9pPl; bop_B: $payfrom = $region['paytype']; goto cvY7Q; HjtEj: $alipay['seller_id'] = $region['alipay_seller_id']; goto crnxB; XC4LF: $bank_wechat['bankkey'] = strpos($property['bankkey'], base64_encode('rhinfo')) !== false ? $property['bankkey'] : md5('rhinfo'); goto gD8EB; Ez0pB: goto SiRdE; goto iUPih; cwgHs: return array("errno" => 1, "message" => $res['message'], "result" => ""); goto VFrOU; FYFwQ: $mywechat['apikey'] = $this->syscfg['servicemerchsecret']; goto tjQrv; RfSAu: Ak6KD: goto yF0Tm; pxi1J: $alipay['appid'] = $property['alipay_appid']; goto kGHxg; ubfDG: if (empty($region['ispay']) && empty($property['ispay'])) { goto M64C8; } goto gDHVE; jkQ_n: $wechat = $setting['payment']['wechat']; goto vqdca; GQtX4: goto Ak6KD; goto MrwIN; IcvMM: dJu_z: goto gZo41; yjGte: load()->model('payment'); goto Plzuy; cPhNt: goto Z6ewM; goto a65VN; mNt6O: $bank_wechat['bankmerchid'] = $property['paytype'] == 3 ? $property['bankmerchid'] : $property['rsdbankmerchid']; goto gR4ud; SVihx: $mywechat['sub_mch_id'] = trim($property['submerchid']); goto ib2pc; a65VN: UhcVi: goto ojSac; goXRt: HMPq5: goto tf3wQ; chW0t: if ($property['ispay'] == 1 && ($property['paytype'] == 3 || $property['paytype'] == 4 || $property['paytype'] == 5)) { goto dJu_z; } goto bUAJy; tW1ho: $mywechat['sub_mch_id'] = trim($this->syscfg['submerchid']); goto FYFwQ; wazoX: $paychannel = substr($params['auth_code'], 0, 2) == '28' ? 'ALIPAY' : 'WXPAY'; goto UHN33; vqdca: $sql = 'SELECT `key`,`secret` FROM ' . tablename('account_wechats') . ' WHERE `acid`=:acid'; goto o3Ynf; tf3wQ: zObm9: goto jkQ_n; AhQgA: goto sGOjo; goto qOb99; gD8EB: $bank_wechat['starorg'] = $property['starorg']; goto HXHMK; Plzuy: if ($params['cfrom'] == 'carscan') { goto UhcVi; } goto nFc9b; kql1h: goto SXQAA; goto xxJOJ; m5gj7: if ($payfrom == 3 || $payfrom == 4 || $payfrom == 5) { goto mThnv; } goto MicTn; ojSac: $this->syscfg = pdo_get('rhinfo_zyxq_sysset', array("weid" => $params['uniacid'])); goto p2KIL; aysPX: goto GF2m5; goto s8TUE; vjSXY: if (!is_error($res)) { goto uExZ0; } goto cwgHs; HJrw1: goto IK6Be; goto XrWEV; iQBYM: $params['orderno'] = $res['orderNo']; goto aysPX; MqM4I: if (empty($alipay)) { goto HMPq5; } goto NykDr; ib2pc: $mywechat['apikey'] = $config['merchsecret']; goto sYe9Z; MrwIN: mThnv: goto gJkZp; XrWEV: MLcVb: goto fgZTO; xAmVa: KNzbc: goto Ds0zQ; SCKrZ: $alipay['appid'] = $this->syscfg['alipay_appid']; goto gD28u; etS2j: if ($property['ispay'] == 1 && $property['paytype'] == 2 && !empty($property['submerchid'])) { goto MLcVb; } goto chW0t; I47he: return array("errno" => 1, "message" => $res['message'], "result" => ""); goto y1pQQ; JnBxB: $alipay['private_key'] = $this->syscfg['alipay_private']; goto r3WVi; gOwDy: $mywechat['mch_id'] = $config['servicemerchid']; goto diKHZ; scYpp: return array("errno" => 1, "message" => $res['message'], "result" => ""); goto vGPw1; y1pQQ: GRb3g: goto GQtX4; mQdAd: IK6Be: goto m5gj7; xxJOJ: POEkM: goto vFyco; o3Ynf: $row = pdo_fetch($sql, array(":acid" => $wechat['account'])); goto M3ut8; X1pF0: $mywechat['appid'] = $this->syscfg['appid']; goto vhzBy; YUhFk: if (!is_error($res)) { goto ef17f; } goto WXqvX; LjKBQ: return array("errno" => 1, "message" => "支付参数错误", "result" => ""); goto jRmdp; wadfv: if (!is_error($res)) { goto h02AF; } goto GnqCG; gQ21B: sx9Y3: goto bop_B; kwYmS: $alipay['app_auth_token'] = $property['alipay_app_auth_token']; goto HWyrp; HXHMK: $bank_wechat['starmerchid'] = $property['starmerchid']; goto Grkm_; MicTn: $res = my_wechat_micropay_build($params, $mywechat); goto gM0D2; sMTaC: return array("errno" => 1, "message" => $res['message'], "result" => ""); goto xAmVa; p2KIL: $setting = uni_setting($params['uniacid'], array("payment")); goto ygfss; kD4G3: if ($this->syscfg['iswxpay'] == 2) { goto KQeUW; } goto AhQgA; ugS5l: M64C8: goto BcRT5; fgZTO: if (!empty($config['serviceappid'])) { goto POEkM; } goto GT0hQ; uUm9f: $bank_wechat = array(); goto Pydak; vhzBy: ia8mh: goto Q3E30; GT0hQ: $mywechat['mch_id'] = $config['servicemerchid']; goto LlyBI; Dp0ZR: if (!$res['errno']) { goto KNzbc; } goto sMTaC; EZkh3: XVppd: goto gOwDy; s8TUE: nS9Lk: goto INCEB; fn5Az: if ($region['ispay'] == 1 && $region['paytype'] == 2 && !empty($region['submerchid'])) { goto xbWkW; } goto UQnnM; pASVj: $mywechat['apikey'] = $wechat['apikey']; goto To_2X; G5B2V: $mywechat['sub_mch_id'] = trim($region['submerchid']); goto h2eMR; gJkZp: $res = my_bankPayCard($params, $bank_wechat, $payfrom, $paychannel); goto uV8pS; diKHZ: $mywechat['sub_appid'] = $config['serviceappid']; goto G5B2V; kj7tU: return array("errno" => 0, "message" => "success", "result" => ""); goto goXRt; HWyrp: goto SiRdE; goto ugS5l; a1n6d: KQeUW: goto rWCvf; fjb3H: $mywechat['appid'] = $row['key']; goto XL9ni; kD2Fb: nM_BR: goto X50En; SCd_l: if ($property['ispay'] == 1 && $property['alipay_type'] == 1) { goto lSCOj; } goto ubfDG; FhfO0: $res = repeat_alipay_order_query($params, $alipay); goto wadfv; i8Cgm: $alipay['appid'] = $region['alipay_appid']; goto Ujdei; SQkt9: $payfrom = $region['paytype']; goto HJrw1; H1THv: $bank_wechat['startrm'] = $region['startrm']; goto S8mEL; YHuRB: if (!is_error($res)) { goto GRb3g; } goto I47he; X7Bqg: if ($payfrom == 5) { goto nS9Lk; } goto EDC7T; JmLyP: $mywechat['mch_id'] = $config['servicemerchid']; goto kiQqO; tjQrv: $mywechat['mch_id'] = $config['servicemerchid']; goto wwFvP; kGHxg: $alipay['public_key'] = $property['alipay_rsa2']; goto rFHYK; ygfss: Z6ewM: goto LNUMr; gM0D2: if (!is_error($res)) { goto iFo3h; } goto qY1AY; Ju7T_: L3IlS: goto tW1ho; ibXBD: if ($region['ispay'] == 1 && $region['alipay_type'] == 1) { goto Kmgf8; } goto SCd_l; Q3E30: $mywechat['mch_id'] = $this->syscfg['merchid']; goto LDsss; X50En: SiRdE: goto MqM4I; W_zNt: $mywechat['sub_mch_id'] = trim($property['submerchid']); goto sAhZx; h2eMR: $mywechat['apikey'] = $config['merchsecret']; goto gQ21B; dTSRM: xbWkW: goto Pm4_w; wLH8T: $bank_wechat['starorg'] = $region['starorg']; goto JsFFu; EzaLm: $mywechat['sub_mch_id'] = trim($region['submerchid']); goto ri6Xu; rWCvf: if (empty($this->syscfg['serviceappid'])) { goto L3IlS; } goto DI25w; NTonQ: $mywechat['sub_appid'] = $config['serviceappid']; goto SVihx; qY1AY: if (!$res['errno']) { goto Wu6T1; } goto scYpp; DI25w: $mywechat['sub_appid'] = $wechat['appid']; goto z0dS6; r3WVi: $alipay['seller_id'] = $this->syscfg['alipay_seller_id']; goto gwCtz; Ujdei: $alipay['public_key'] = $region['alipay_rsa2']; goto y4giQ; yF0Tm: return array("errno" => 0, "message" => "success", "result" => ""); goto JdjUK; INCEB: $params['orderno'] = $res['logNo']; goto SYOtW; gD28u: $alipay['public_key'] = $this->syscfg['alipay_rsa2']; goto JnBxB; LNUMr: if (!(!is_array($setting['payment']) && empty($this->syscfg['iswxpay']) && empty($this->syscfg['isalipay']))) { goto i2aGW; } goto LjKBQ; kiQqO: $mywechat['sub_appid'] = $mywechat['appid']; goto EzaLm; BcRT5: if (!($this->syscfg['alipay_type'] == 1)) { goto nM_BR; } goto SCKrZ; SYOtW: GF2m5: goto juTy3; S8mEL: $bank_wechat['starkey'] = $region['starkey']; goto SQkt9; JdjUK: } } ?>